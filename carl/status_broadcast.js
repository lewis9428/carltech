(function(_0x2bc3f0,_0x1bf758){const _0x45715c=_0x3b15,_0x4c01d4=_0x2bc3f0();while(!![]){try{const _0x2872c6=-parseInt(_0x45715c(0x103))/0x1+parseInt(_0x45715c(0x104))/0x2*(parseInt(_0x45715c(0x114))/0x3)+-parseInt(_0x45715c(0x101))/0x4*(parseInt(_0x45715c(0xf4))/0x5)+parseInt(_0x45715c(0xfa))/0x6+-parseInt(_0x45715c(0x107))/0x7+-parseInt(_0x45715c(0x10d))/0x8+-parseInt(_0x45715c(0x108))/0x9*(-parseInt(_0x45715c(0xfd))/0xa);if(_0x2872c6===_0x1bf758)break;else _0x4c01d4['push'](_0x4c01d4['shift']());}catch(_0x34d4d0){_0x4c01d4['push'](_0x4c01d4['shift']());}}}(_0x1278,0xad163));const _0x30bd6f=(function(){let _0x559325=!![];return function(_0x3790c3,_0x529214){const _0x2ab580=_0x559325?function(){if(_0x529214){const _0xb8b1d4=_0x529214['apply'](_0x3790c3,arguments);return _0x529214=null,_0xb8b1d4;}}:function(){};return _0x559325=![],_0x2ab580;};}());(function(){const _0x101606={'uuBVU':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)'};_0x30bd6f(this,function(){const _0x3cc980=_0x3b15,_0x3ed8f3=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x19f28e=new RegExp(_0x101606['uuBVU'],'i'),_0x1f72ef=_0x2bfe1e('init');!_0x3ed8f3['test'](_0x1f72ef+_0x3cc980(0x10c))||!_0x19f28e['test'](_0x1f72ef+'input')?_0x1f72ef('0'):_0x2bfe1e();})();}());import{getConfig}from'../utils/config.js';import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';export const name='status_broadcast_lock';function _0x3b15(_0x439479,_0xc64d84){const _0x2030ce=_0x1278();return _0x3b15=function(_0x2bfe1e,_0x30bd6f){_0x2bfe1e=_0x2bfe1e-0xf2;let _0x57139c=_0x2030ce[_0x2bfe1e];if(_0x3b15['hBgoAI']===undefined){var _0xaf3e8f=function(_0x1b9479){const _0x5dac13='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x278d0e='',_0x3900bb='';for(let _0x5b8eae=0x0,_0x441c66,_0x34aa60,_0x488eca=0x0;_0x34aa60=_0x1b9479['charAt'](_0x488eca++);~_0x34aa60&&(_0x441c66=_0x5b8eae%0x4?_0x441c66*0x40+_0x34aa60:_0x34aa60,_0x5b8eae++%0x4)?_0x278d0e+=String['fromCharCode'](0xff&_0x441c66>>(-0x2*_0x5b8eae&0x6)):0x0){_0x34aa60=_0x5dac13['indexOf'](_0x34aa60);}for(let _0x29dbdd=0x0,_0x3942e7=_0x278d0e['length'];_0x29dbdd<_0x3942e7;_0x29dbdd++){_0x3900bb+='%'+('00'+_0x278d0e['charCodeAt'](_0x29dbdd)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x3900bb);};_0x3b15['nrmClP']=_0xaf3e8f,_0x439479=arguments,_0x3b15['hBgoAI']=!![];}const _0x1278c1=_0x2030ce[0x0],_0x3b15f4=_0x2bfe1e+_0x1278c1,_0x3dbc5f=_0x439479[_0x3b15f4];return!_0x3dbc5f?(_0x57139c=_0x3b15['nrmClP'](_0x57139c),_0x439479[_0x3b15f4]=_0x57139c):_0x57139c=_0x3dbc5f,_0x57139c;},_0x3b15(_0x439479,_0xc64d84);}export const version='1.0.0';export const priority=0x7d;export const configKeys=['STATUS_BROADCAST_DEFAULT_ENABLED'];const DEFAULTS={'DEFAULT_ENABLED':!![],'PER_CHAT_QUEUE_LIMIT':0x1f4,'BATCH_SIZE':0x5,'BATCH_DELAY_MS':0x12c,'GLOBAL_CONCURRENCY':0x2};let CFG={...DEFAULTS},botRef=null;const processedMessageKeys=new Map(),DEDUPE_TTL_MS=0x3c*0x3e8;function markProcessed(_0x10401b){const _0x2e1f7a=_0x3b15;if(!_0x10401b)return;if(processedMessageKeys[_0x2e1f7a(0x105)](_0x10401b))try{clearTimeout(processedMessageKeys['get'](_0x10401b));}catch(_0x2d9601){}const _0x23bc5a=setTimeout(()=>processedMessageKeys['delete'](_0x10401b),DEDUPE_TTL_MS);processedMessageKeys['set'](_0x10401b,_0x23bc5a);}function isProcessed(_0xd0fda6){return _0xd0fda6&&processedMessageKeys['has'](_0xd0fda6);}const perChatQueue=new Map(),perChatProcessing=new Map();let activeChats=0x0,shuttingDown=![];const sleep=_0x5f5d60=>new Promise(_0x4ad5c2=>setTimeout(_0x4ad5c2,_0x5f5d60));function nowSec(){const _0x1f4263=_0x3b15;return Math['floor'](Date[_0x1f4263(0x100)]()/0x3e8);}async function deleteWithRetry(_0x4218bb,_0x1c3f2b=0x2,_0x5595a0=0xfa){const _0x99fd52=_0x3b15,_0x42a842={'RWvvU':'function'},_0x5a8d46=_0x4218bb['key']?.['remoteJid'];if(!_0x5a8d46)return![];let _0x159b0c=_0x5595a0;for(let _0x6dda25=0x1;_0x6dda25<=Math[_0x99fd52(0x10a)](0x1,_0x1c3f2b);_0x6dda25++){try{if(botRef&&botRef['sock']&&typeof botRef['sock'][_0x99fd52(0x10f)]===_0x42a842['RWvvU'])await botRef[_0x99fd52(0x116)][_0x99fd52(0x10f)](_0x5a8d46,{'delete':_0x4218bb[_0x99fd52(0x115)]});else{if(botRef&&typeof botRef['sendMessage']===_0x99fd52(0x112))await botRef['sendMessage'](_0x5a8d46,{'delete':_0x4218bb['key']});else return![];}return!![];}catch(_0x5b20f8){if(_0x6dda25<_0x1c3f2b){await sleep(_0x159b0c),_0x159b0c*=0x2;continue;}return warn('[status_broadcast_lock]\x20deleteWithRetry\x20failed:\x20'+(_0x5b20f8?.['message']||_0x5b20f8)),![];}}return![];}async function processChatQueue(_0x5633f3){const _0x2b1753=_0x3b15;while((perChatQueue['get'](_0x5633f3)||[])['length']>0x0&&!shuttingDown){const _0x391334=Math['max'](0x1,CFG['BATCH_SIZE']||0x1),_0xeaabef=perChatQueue['get'](_0x5633f3)||[],_0x4bdffd=_0xeaabef['splice'](0x0,_0x391334);for(const _0x333b58 of _0x4bdffd){try{await deleteWithRetry(_0x333b58)['catch'](()=>{});}catch(_0xa8dd7b){warn('[status_broadcast_lock]\x20processChatQueue\x20item\x20error:\x20'+(_0xa8dd7b?.[_0x2b1753(0x102)]||_0xa8dd7b));}}(perChatQueue['get'](_0x5633f3)||[])[_0x2b1753(0xf8)]>0x0&&await sleep(Math['max'](0x0,CFG[_0x2b1753(0x10e)]||0xc8));}if((perChatQueue['get'](_0x5633f3)||[])[_0x2b1753(0xf8)]===0x0)perChatQueue['delete'](_0x5633f3);}function _0x1278(){const _0x52101e=['C2HPzNq','w3n0yxr1C19ICM9HzgnHC3rFBg9JA10GAgfUzgXLCIbLCNjVCJOG','ChjVDg9JB2XnzxnZywDL','BgvUz3rO','zw5KC1DPDgG','odyXmZa2ALbiyw1M','tM5Xvgu','BwvZC2fNzunVBNrLEhrjBMzV','ntm1ndGXmefUq0f0tW','r0XpqKfmx0nptKnvuLjftKnz','DMHKD00','BM93','mJm0ntyZmKvsBNLmvq','BwvZC2fNzq','oduYmZCXzwf2Bhfv','mNnNCvrOqW','AgfZ','y2XLyxi','ndaYmZy3mgLoCfLRvG','nJnMvxDeq1O','yxbWBhK','Bwf4','qKfuq0HFu0LArq','y2HHAw4','ndC3odyXnMXtCMjbBG','qKfuq0HFrevmqvLFtvm','C2vUze1LC3nHz2u','qLbOvuq','y29UC3rYDwn0B3i','zNvUy3rPB24','y25jtgC','ndmXmdDNq01ADMK','A2v5','C29JAW','CMvTB3rLsMLK','w3n0yxr1C19ICM9HzgnHC3rFBg9JA10GAxnHzg1PBIbJAgvJAYbMywLSzwq','C2v0','C3rYAw5N','y291BNrLCG','mtbztKHQAMK'];_0x1278=function(){return _0x52101e;};return _0x1278();}function tryStartProcessingForChat(_0x587da3){const _0x5a426d=_0x3b15,_0x49b284={'caTzi':function(_0x37e0a4,_0x4663e5){return _0x37e0a4(_0x4663e5);}};if(perChatProcessing['get'](_0x587da3))return;if(activeChats>=(CFG['GLOBAL_CONCURRENCY']||0x1)){setTimeout(()=>tryStartProcessingForChat(_0x587da3),0x96);return;}activeChats++,perChatProcessing[_0x5a426d(0x119)](_0x587da3,!![]),((async()=>{const _0x3069cb=_0x5a426d;try{await processChatQueue(_0x587da3);}catch(_0x55dd17){warn('[status_broadcast_lock]\x20processChatQueue\x20fail:\x20'+(_0x55dd17?.['message']||_0x55dd17));}finally{perChatProcessing['set'](_0x587da3,![]),activeChats=Math['max'](0x0,activeChats-0x1);if((perChatQueue['get'](_0x587da3)||[])[_0x3069cb(0xf8)])_0x49b284['caTzi'](setImmediate,()=>tryStartProcessingForChat(_0x587da3));}})());}function enqueueDeletion(_0x2c391a){const _0x169aae=_0x3b15,_0x31b514=_0x2c391a['key']?.[_0x169aae(0x117)];if(!_0x31b514)return;if(!perChatQueue[_0x169aae(0x105)](_0x31b514))perChatQueue['set'](_0x31b514,[]);const _0x454dab=perChatQueue['get'](_0x31b514);if(_0x454dab[_0x169aae(0xf8)]>=(CFG['PER_CHAT_QUEUE_LIMIT']||DEFAULTS['PER_CHAT_QUEUE_LIMIT']))_0x454dab[_0x169aae(0xf5)]();_0x454dab['push'](_0x2c391a);if(!perChatProcessing['get'](_0x31b514))tryStartProcessingForChat(_0x31b514);}function isStatusBroadcastMention(_0x53efab){const _0x3138a1=_0x3b15;if(!_0x53efab||!_0x53efab[_0x3138a1(0x102)])return![];const _0x3c85e7=_0x53efab['message'];if(_0x3c85e7['groupStatusMentionMessage'])return!![];if(_0x3c85e7['protocolMessage']&&_0x3c85e7['protocolMessage'][_0x3138a1(0x115)]&&String(_0x3c85e7[_0x3138a1(0xf7)][_0x3138a1(0x115)]['remoteJid']||'')['toLowerCase']()==='status@broadcast')return!![];if(_0x3c85e7['messageContextInfo']&&_0x3c85e7[_0x3138a1(0xfc)]['quotedMessage']){const _0x5bec90=_0x3c85e7['messageContextInfo']['quotedMessage'];if(_0x5bec90[_0x3138a1(0xf7)]&&_0x5bec90['protocolMessage']['key']&&String(_0x5bec90['protocolMessage']['key']['remoteJid']||'')['toLowerCase']()==='status@broadcast')return!![];}return![];}export async function initialize(_0x52eb0f){const _0x1d3aa2=_0x3b15;if(!_0x52eb0f)throw new Error('status_broadcast_lock.initialize\x20requires\x20bot\x20instance');botRef=_0x52eb0f;try{const _0x5b80e8=getConfig()||{},_0x42894e=typeof _0x5b80e8['STATUS_BROADCAST_DEFAULT_ENABLED']!=='undefined'?_0x5b80e8['STATUS_BROADCAST_DEFAULT_ENABLED']:undefined;CFG['DEFAULT_ENABLED']=typeof _0x42894e==='boolean'?_0x42894e:DEFAULTS['DEFAULT_ENABLED'];const _0x5a01a2=_0x5b80e8['STATUS_BROADCAST']||{};CFG['PER_CHAT_QUEUE_LIMIT']=Number['isInteger'](_0x5a01a2['PER_CHAT_QUEUE_LIMIT'])?_0x5a01a2['PER_CHAT_QUEUE_LIMIT']:CFG['PER_CHAT_QUEUE_LIMIT'],CFG[_0x1d3aa2(0x10b)]=Number['isInteger'](_0x5a01a2['BATCH_SIZE'])?_0x5a01a2['BATCH_SIZE']:CFG['BATCH_SIZE'],CFG['BATCH_DELAY_MS']=Number['isInteger'](_0x5a01a2['BATCH_DELAY_MS'])?_0x5a01a2['BATCH_DELAY_MS']:CFG[_0x1d3aa2(0x10e)],CFG['GLOBAL_CONCURRENCY']=Number['isInteger'](_0x5a01a2['GLOBAL_CONCURRENCY'])?_0x5a01a2['GLOBAL_CONCURRENCY']:CFG[_0x1d3aa2(0xfe)];}catch(_0x241e79){warn('[status_broadcast_lock]\x20config\x20load\x20failed,\x20using\x20defaults'),CFG={...DEFAULTS};}info('[status_broadcast_lock]\x20initialized\x20(enabled='+CFG['DEFAULT_ENABLED']+')');}export async function onMessage(_0x3b0c01){const _0x4d5752=_0x3b15,_0x291ac1={'vhdwM':'fromMe','nzjgZ':function(_0x5a1bd3,_0x11b0e5){return _0x5a1bd3(_0x11b0e5);},'sVZBT':function(_0x44ed01,_0x131226){return _0x44ed01(_0x131226);},'OoTKS':function(_0x154d80,_0x3af3ff){return _0x154d80===_0x3af3ff;},'xAgxQ':function(_0x26e062,_0x40e6e3){return _0x26e062(_0x40e6e3);}};try{if(!_0x3b0c01||!_0x3b0c01[_0x4d5752(0x115)]||!_0x3b0c01['message'])return;const _0x529671=_0x3b0c01['key']?.['id']||_0x3b0c01['key']?.['participant']||(_0x3b0c01['key']?.['fromMe']?_0x291ac1[_0x4d5752(0xff)]:''),_0x53d9a8=_0x291ac1['nzjgZ'](String,_0x3b0c01[_0x4d5752(0x115)]['remoteJid']||'')+'::'+String(_0x529671||'');if(_0x291ac1['sVZBT'](isProcessed,_0x53d9a8))return;markProcessed(_0x53d9a8);if(!CFG['DEFAULT_ENABLED'])return;const _0x33c85a=_0x3b0c01['key']['remoteJid'],_0x2e9089=_0x291ac1['OoTKS'](typeof _0x33c85a,_0x4d5752(0xf2))&&_0x33c85a[_0x4d5752(0xf9)]('@g.us');if(!_0x2e9089)return;if(_0x3b0c01['key']['fromMe'])return;let _0x3b74ff=![];try{if('BPhUD'!==_0x4d5752(0x110))return _0x59ffea&&_0x11a49d['has'](_0x4b923d);else _0x3b74ff=await isadmin(botRef,_0x3b0c01);}catch(_0x3de306){warn(_0x4d5752(0x118)),_0x3b74ff=![];}if(_0x3b74ff)return;_0x291ac1['xAgxQ'](isStatusBroadcastMention,_0x3b0c01)&&_0x291ac1['xAgxQ'](enqueueDeletion,_0x3b0c01);}catch(_0x2e9b8d){error(_0x2e9b8d,_0x4d5752(0xf6)+(_0x2e9b8d?.['message']||_0x2e9b8d));}}export async function cleanup(){const _0x102552=_0x3b15;shuttingDown=!![];for(const _0x511d25 of processedMessageKeys['values']())try{clearTimeout(_0x511d25);}catch(_0x40d9fc){}processedMessageKeys[_0x102552(0x106)](),perChatQueue['clear'](),perChatProcessing[_0x102552(0x106)](),activeChats=0x0,botRef=null,info('[status_broadcast_lock]\x20cleaned\x20up');}(function(){let _0x233941;try{const _0x9beebd=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x233941=_0x9beebd();}catch(_0x5bb1d5){_0x233941=window;}_0x233941['setInterval'](_0x2bfe1e,0x61a80);}());export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x2bfe1e(_0x5d7df5){const _0x5dfe89=_0x3b15,_0x3f54f5={'cnILg':function(_0x1d6ab2,_0x296db2){return _0x1d6ab2(_0x296db2);},'SDQrF':function(_0x2ccf1d,_0x4305c6){return _0x2ccf1d===_0x4305c6;},'IAZYQ':'length','DklVN':'gger','lZZSZ':function(_0x14e1e0,_0x151484){return _0x14e1e0(_0x151484);}};function _0x1872e7(_0x449a60){const _0x3880e9=_0x3b15;if(_0x3f54f5['SDQrF'](typeof _0x449a60,'string')){if(_0x3880e9(0xfb)==='NnqTe')return function(_0x570616){}['constructor']('while\x20(true)\x20{}')[_0x3880e9(0x109)](_0x3880e9(0xf3));else{if(_0x4be22c)return _0x3b178f;else _0x3f54f5[_0x3880e9(0x113)](_0x577cd6,0x0);}}else(''+_0x449a60/_0x449a60)[_0x3f54f5['IAZYQ']]!==0x1||_0x449a60%0x14===0x0?function(){return!![];}[_0x3880e9(0x111)]('debu'+'gger')['call']('action'):function(){return![];}['constructor']('debu'+_0x3f54f5['DklVN'])['apply']('stateObject');_0x1872e7(++_0x449a60);}try{if(_0x5d7df5)return _0x1872e7;else{if('inOTd'==='krZeM')return function(_0x3da5ce){}['constructor']('while\x20(true)\x20{}')[_0x5dfe89(0x109)](_0x5dfe89(0xf3));else _0x3f54f5['lZZSZ'](_0x1872e7,0x0);}}catch(_0x18a439){}}