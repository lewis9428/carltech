(function(_0x9d4a0a,_0x3d4106){const _0x88bb3d=_0x2457,_0x43607e=_0x9d4a0a();while(!![]){try{const _0x2f4d61=parseInt(_0x88bb3d(0x172))/0x1+parseInt(_0x88bb3d(0x193))/0x2+parseInt(_0x88bb3d(0x190))/0x3*(-parseInt(_0x88bb3d(0x18c))/0x4)+parseInt(_0x88bb3d(0x18f))/0x5*(-parseInt(_0x88bb3d(0x186))/0x6)+-parseInt(_0x88bb3d(0x197))/0x7+-parseInt(_0x88bb3d(0x178))/0x8*(parseInt(_0x88bb3d(0x179))/0x9)+parseInt(_0x88bb3d(0x191))/0xa;if(_0x2f4d61===_0x3d4106)break;else _0x43607e['push'](_0x43607e['shift']());}catch(_0x121d07){_0x43607e['push'](_0x43607e['shift']());}}}(_0x996a,0x82302));const _0x1d4a97=(function(){let _0x7ecec6=!![];return function(_0x57a647,_0x4d3ae2){const _0x383e75=_0x7ecec6?function(){if(_0x4d3ae2){const _0x58bc3b=_0x4d3ae2['apply'](_0x57a647,arguments);return _0x4d3ae2=null,_0x58bc3b;}}:function(){};return _0x7ecec6=![],_0x383e75;};}());(function(){const _0x27bae3=_0x2457,_0x365389={'iDBhD':function(_0x468577,_0x54215f,_0x317d3a){return _0x468577(_0x54215f,_0x317d3a);}};_0x365389[_0x27bae3(0x16d)](_0x1d4a97,this,function(){const _0x52d543=_0x27bae3;if('jzLzi'==='eCHcy')_0x1996b8('0');else{const _0x128305=new RegExp(_0x52d543(0x198)),_0x4aa5e1=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x1c3b02=_0x2cbcd4(_0x52d543(0x17a));!_0x128305[_0x52d543(0x195)](_0x1c3b02+'chain')||!_0x4aa5e1[_0x52d543(0x195)](_0x1c3b02+_0x52d543(0x175))?_0x1c3b02('0'):_0x2cbcd4();}})();}());import{getConfig}from'../utils/config.js';import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';export const name='status_broadcast_lock';export const version='1.0.0';export const priority=0x7d;export const configKeys=['STATUS_BROADCAST_DEFAULT_ENABLED'];const DEFAULTS={'DEFAULT_ENABLED':!![],'PER_CHAT_QUEUE_LIMIT':0x1f4,'BATCH_SIZE':0x5,'BATCH_DELAY_MS':0x12c,'GLOBAL_CONCURRENCY':0x2};let CFG={...DEFAULTS},botRef=null;const processedMessageKeys=new Map(),DEDUPE_TTL_MS=0x3c*0x3e8;function markProcessed(_0x53c2c7){if(!_0x53c2c7)return;if(processedMessageKeys['has'](_0x53c2c7))try{clearTimeout(processedMessageKeys['get'](_0x53c2c7));}catch(_0x2257ca){}const _0x1a42e6=setTimeout(()=>processedMessageKeys['delete'](_0x53c2c7),DEDUPE_TTL_MS);processedMessageKeys['set'](_0x53c2c7,_0x1a42e6);}function isProcessed(_0x572ee2){return _0x572ee2&&processedMessageKeys['has'](_0x572ee2);}const perChatQueue=new Map(),perChatProcessing=new Map();let activeChats=0x0,shuttingDown=![];const sleep=_0x1600f3=>new Promise(_0xf4ad0e=>setTimeout(_0xf4ad0e,_0x1600f3));function nowSec(){const _0x337261=_0x2457;return Math['floor'](Date[_0x337261(0x17f)]()/0x3e8);}async function deleteWithRetry(_0x2e07f0,_0xa56c91=0x2,_0x409a66=0xfa){const _0x5041a6=_0x2457,_0x29a69c=_0x2e07f0['key']?.[_0x5041a6(0x189)];if(!_0x29a69c)return![];let _0x259562=_0x409a66;for(let _0x30a47e=0x1;_0x30a47e<=Math['max'](0x1,_0xa56c91);_0x30a47e++){try{if(botRef&&botRef['sock']&&typeof botRef['sock'][_0x5041a6(0x170)]==='function')await botRef['sock']['sendMessage'](_0x29a69c,{'delete':_0x2e07f0['key']});else{if(botRef&&typeof botRef['sendMessage']===_0x5041a6(0x16c))await botRef['sendMessage'](_0x29a69c,{'delete':_0x2e07f0[_0x5041a6(0x199)]});else return![];}return!![];}catch(_0x2906ae){if(_0x30a47e<_0xa56c91){await sleep(_0x259562),_0x259562*=0x2;continue;}return warn('[status_broadcast_lock]\x20deleteWithRetry\x20failed:\x20'+(_0x2906ae?.[_0x5041a6(0x182)]||_0x2906ae)),![];}}return![];}async function processChatQueue(_0x1d586e){const _0x2450eb=_0x2457;while((perChatQueue['get'](_0x1d586e)||[])['length']>0x0&&!shuttingDown){const _0x14d6cd=Math['max'](0x1,CFG['BATCH_SIZE']||0x1),_0x3d37fe=perChatQueue['get'](_0x1d586e)||[],_0x3fe531=_0x3d37fe[_0x2450eb(0x184)](0x0,_0x14d6cd);for(const _0x229909 of _0x3fe531){try{await deleteWithRetry(_0x229909)['catch'](()=>{});}catch(_0x5137eb){warn('[status_broadcast_lock]\x20processChatQueue\x20item\x20error:\x20'+(_0x5137eb?.['message']||_0x5137eb));}}(perChatQueue['get'](_0x1d586e)||[])['length']>0x0&&await sleep(Math['max'](0x0,CFG['BATCH_DELAY_MS']||0xc8));}if((perChatQueue['get'](_0x1d586e)||[])['length']===0x0)perChatQueue[_0x2450eb(0x176)](_0x1d586e);}(function(){const _0xc72450={'YHtQH':'{}.constructor(\x22return\x20this\x22)(\x20)'},_0x458bf5=function(){const _0x4869c6=_0x2457;if('cXBsT'!==_0x4869c6(0x187))_0x1dbe2c(_0x3bb27f);else{let _0x29f25e;try{_0x29f25e=Function('return\x20(function()\x20'+_0xc72450['YHtQH']+');')();}catch(_0x3a0c41){_0x29f25e=window;}return _0x29f25e;}},_0x4659de=_0x458bf5();_0x4659de['setInterval'](_0x2cbcd4,0x61a80);}());function _0x2457(_0x1ee8b0,_0x1db38b){const _0x2594d4=_0x996a();return _0x2457=function(_0x2cbcd4,_0x1d4a97){_0x2cbcd4=_0x2cbcd4-0x16c;let _0x46d433=_0x2594d4[_0x2cbcd4];if(_0x2457['AUaGVS']===undefined){var _0x3c467f=function(_0x39a27e){const _0x1806b7='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x13d536='',_0x24d0f7='';for(let _0x64df69=0x0,_0x2b0968,_0xce191,_0x27a98d=0x0;_0xce191=_0x39a27e['charAt'](_0x27a98d++);~_0xce191&&(_0x2b0968=_0x64df69%0x4?_0x2b0968*0x40+_0xce191:_0xce191,_0x64df69++%0x4)?_0x13d536+=String['fromCharCode'](0xff&_0x2b0968>>(-0x2*_0x64df69&0x6)):0x0){_0xce191=_0x1806b7['indexOf'](_0xce191);}for(let _0x142dc0=0x0,_0x5dd2bc=_0x13d536['length'];_0x142dc0<_0x5dd2bc;_0x142dc0++){_0x24d0f7+='%'+('00'+_0x13d536['charCodeAt'](_0x142dc0)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x24d0f7);};_0x2457['pULsIm']=_0x3c467f,_0x1ee8b0=arguments,_0x2457['AUaGVS']=!![];}const _0x996ad7=_0x2594d4[0x0],_0x245780=_0x2cbcd4+_0x996ad7,_0x833ffb=_0x1ee8b0[_0x245780];return!_0x833ffb?(_0x46d433=_0x2457['pULsIm'](_0x46d433),_0x1ee8b0[_0x245780]=_0x46d433):_0x46d433=_0x833ffb,_0x46d433;},_0x2457(_0x1ee8b0,_0x1db38b);}function tryStartProcessingForChat(_0x348b70){const _0x49db7c=_0x2457,_0x25fbe8={'xQijb':function(_0x37ae05,_0x3b6f1c){return _0x37ae05(_0x3b6f1c);},'XSDIZ':function(_0x580742,_0x59defc){return _0x580742-_0x59defc;}};if(perChatProcessing['get'](_0x348b70))return;if(activeChats>=(CFG['GLOBAL_CONCURRENCY']||0x1)){setTimeout(()=>tryStartProcessingForChat(_0x348b70),0x96);return;}activeChats++,perChatProcessing[_0x49db7c(0x183)](_0x348b70,!![]),((async()=>{const _0x4578cb=_0x49db7c;try{await _0x25fbe8['xQijb'](processChatQueue,_0x348b70);}catch(_0x4cc3f0){_0x25fbe8['xQijb'](warn,_0x4578cb(0x173)+(_0x4cc3f0?.['message']||_0x4cc3f0));}finally{perChatProcessing['set'](_0x348b70,![]),activeChats=Math[_0x4578cb(0x18d)](0x0,_0x25fbe8['XSDIZ'](activeChats,0x1));if((perChatQueue['get'](_0x348b70)||[])[_0x4578cb(0x18e)])setImmediate(()=>tryStartProcessingForChat(_0x348b70));}})());}function _0x996a(){const _0x3fe9c3=['Aw5PDa','u1rbvfvtx0jst0feq0ftvf9eruzbvuXux0voqujmruq','yxbWBhK','ChvZAa','revgqvvmvf9ftKfcteve','BM93','A1zcCe4','qKfuq0HFu0LArq','BwvZC2fNzq','C2v0','C3bSAwnL','C3rYAw5N','mtjhs1nrBLK','y1HcC1q','z2v0','CMvTB3rLsMLK','C3rHDgvpyMPLy3q','BLv0swO','mtq4y0Hltg1I','Bwf4','BgvUz3rO','mti5mteWnvveAe9Uzq','nZm2mtrrB1PWCgO','mtuZmJq3odbMyw5mtLG','CwLxDKq','mtC5mti2mKHhwfLrwa','uevsx0niqvrFuvvfvuvFteLnsvq','DgvZDa','Dg9mB3DLCKnHC2u','ndmYntmXngLdvNPmBa','zNvUy3rPB24GkLWOicPCkq','A2v5','zNvUy3rPB24','AurcAeq','tMr4vKW','w3n0yxr1C19ICM9HzgnHC3rFBg9JA10Gy29UzMLNigXVywqGzMfPBgvKlcb1C2LUzYbKzwzHDwX0CW','C2vUze1LC3nHz2u','BxrOrKW','nZm5mZyZCxrLrLf1','w3n0yxr1C19ICM9HzgnHC3rFBg9JA10GChjVy2vZC0nOyxrrDwv1zsbMywLSoIa','r0XpqKfmx0nptKnvuLjftKnz','Aw5WDxq','zgvSzxrL','z2DLCG','mJrlBhHMuLO','mtC3ntKXnMPuD211sW'];_0x996a=function(){return _0x3fe9c3;};return _0x996a();}function enqueueDeletion(_0x20855a){const _0x2a0fa9=_0x2457,_0x4b6641=_0x20855a['key']?.['remoteJid'];if(!_0x4b6641)return;if(!perChatQueue['has'](_0x4b6641))perChatQueue['set'](_0x4b6641,[]);const _0x4d7ac0=perChatQueue[_0x2a0fa9(0x188)](_0x4b6641);if(_0x4d7ac0['length']>=(CFG['PER_CHAT_QUEUE_LIMIT']||DEFAULTS['PER_CHAT_QUEUE_LIMIT']))_0x4d7ac0['shift']();_0x4d7ac0[_0x2a0fa9(0x17d)](_0x20855a);if(!perChatProcessing['get'](_0x4b6641))tryStartProcessingForChat(_0x4b6641);}function isStatusBroadcastMention(_0x5ec3c8){const _0x37228f=_0x2457,_0x411f5d={'kVBpN':function(_0x3f0c32,_0x5c96da){return _0x3f0c32(_0x5c96da);}};if(!_0x5ec3c8||!_0x5ec3c8['message'])return![];const _0x539f80=_0x5ec3c8['message'];if(_0x539f80['groupStatusMentionMessage'])return!![];if(_0x539f80['protocolMessage']&&_0x539f80['protocolMessage']['key']&&String(_0x539f80['protocolMessage']['key']['remoteJid']||'')[_0x37228f(0x196)]()==='status@broadcast')return!![];if(_0x539f80['messageContextInfo']&&_0x539f80['messageContextInfo']['quotedMessage']){if('lufJm'==='lufJm'){const _0x445b14=_0x539f80['messageContextInfo']['quotedMessage'];if(_0x445b14['protocolMessage']&&_0x445b14['protocolMessage'][_0x37228f(0x199)]&&_0x411f5d[_0x37228f(0x180)](String,_0x445b14['protocolMessage']['key']['remoteJid']||'')['toLowerCase']()==='status@broadcast')return!![];}else{_0x4c2726['set'](_0x5a30c4,![]),_0x19b6fe=_0x46e7e5['max'](0x0,_0x80ae87-0x1);if((_0x2d63b6['get'](_0x2e6260)||[])[_0x37228f(0x18e)])_0x1062ce(()=>_0x2f6bb7(_0x1c6fb3));}}return![];}export async function initialize(_0x1e0d48){const _0x941a3c=_0x2457;if(!_0x1e0d48)throw new Error('status_broadcast_lock.initialize\x20requires\x20bot\x20instance');botRef=_0x1e0d48;try{const _0x3c0546=getConfig()||{},_0x1b5b20=typeof _0x3c0546[_0x941a3c(0x17b)]!=='undefined'?_0x3c0546['STATUS_BROADCAST_DEFAULT_ENABLED']:undefined;CFG['DEFAULT_ENABLED']=typeof _0x1b5b20==='boolean'?_0x1b5b20:DEFAULTS[_0x941a3c(0x17e)];const _0x10e117=_0x3c0546['STATUS_BROADCAST']||{};CFG['PER_CHAT_QUEUE_LIMIT']=Number['isInteger'](_0x10e117[_0x941a3c(0x194)])?_0x10e117['PER_CHAT_QUEUE_LIMIT']:CFG['PER_CHAT_QUEUE_LIMIT'],CFG['BATCH_SIZE']=Number['isInteger'](_0x10e117[_0x941a3c(0x181)])?_0x10e117['BATCH_SIZE']:CFG['BATCH_SIZE'],CFG['BATCH_DELAY_MS']=Number['isInteger'](_0x10e117['BATCH_DELAY_MS'])?_0x10e117['BATCH_DELAY_MS']:CFG['BATCH_DELAY_MS'],CFG['GLOBAL_CONCURRENCY']=Number['isInteger'](_0x10e117['GLOBAL_CONCURRENCY'])?_0x10e117[_0x941a3c(0x174)]:CFG['GLOBAL_CONCURRENCY'];}catch(_0x5898ff){warn(_0x941a3c(0x16f)),CFG={...DEFAULTS};}info('[status_broadcast_lock]\x20initialized\x20(enabled='+CFG['DEFAULT_ENABLED']+')');}export async function onMessage(_0x4b8d83){const _0x1cddb7=_0x2457,_0x92762d={'inOvw':function(_0x15118b,_0x334f7f){return _0x15118b>=_0x334f7f;},'qiWvD':'fromMe','uKGxk':function(_0x1be1bb,_0x37cce3){return _0x1be1bb(_0x37cce3);}};try{if(!_0x4b8d83||!_0x4b8d83['key']||!_0x4b8d83[_0x1cddb7(0x182)])return;const _0x3cba31=_0x4b8d83['key']?.['id']||_0x4b8d83['key']?.['participant']||(_0x4b8d83['key']?.['fromMe']?_0x92762d[_0x1cddb7(0x192)]:''),_0xd3b832=String(_0x4b8d83['key']['remoteJid']||'')+'::'+_0x92762d['uKGxk'](String,_0x3cba31||'');if(isProcessed(_0xd3b832))return;markProcessed(_0xd3b832);if(!CFG['DEFAULT_ENABLED'])return;const _0x3f8ebc=_0x4b8d83['key']['remoteJid'],_0x4a4953=typeof _0x3f8ebc===_0x1cddb7(0x185)&&_0x3f8ebc['endsWith']('@g.us');if(!_0x4a4953)return;if(_0x4b8d83[_0x1cddb7(0x199)]['fromMe'])return;let _0x396a0a=![];try{_0x396a0a=await isadmin(botRef,_0x4b8d83);}catch(_0x5388dd){if('gNHyj'==='gNHyj')warn('[status_broadcast_lock]\x20isadmin\x20check\x20failed'),_0x396a0a=![];else{const _0x420883=_0x984243[_0x1cddb7(0x199)]?.['remoteJid'];if(!_0x420883)return;if(!_0x4bd469['has'](_0x420883))_0x5d3fe9['set'](_0x420883,[]);const _0x43f276=_0x3e5348['get'](_0x420883);if(_0x92762d['inOvw'](_0x43f276['length'],_0x3e9ed3['PER_CHAT_QUEUE_LIMIT']||_0x53faf6['PER_CHAT_QUEUE_LIMIT']))_0x43f276['shift']();_0x43f276['push'](_0x5810d2);if(!_0x2b9748['get'](_0x420883))_0x1104ed(_0x420883);}}if(_0x396a0a)return;isStatusBroadcastMention(_0x4b8d83)&&enqueueDeletion(_0x4b8d83);}catch(_0x185e05){_0x1cddb7(0x16e)===_0x1cddb7(0x18b)?_0x3f302c(_0x5cba92['get'](_0x1b0ee8)):error(_0x185e05,'[status_broadcast_lock]\x20handler\x20error:\x20'+(_0x185e05?.['message']||_0x185e05));}}export async function cleanup(){shuttingDown=!![];for(const _0x39a4e8 of processedMessageKeys['values']())try{clearTimeout(_0x39a4e8);}catch(_0x3f3c59){}processedMessageKeys['clear'](),perChatQueue['clear'](),perChatProcessing['clear'](),activeChats=0x0,botRef=null,info('[status_broadcast_lock]\x20cleaned\x20up');}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x2cbcd4(_0x559153){const _0xa8dbf0={'ucSpr':function(_0x4eec35,_0x3a36db){return _0x4eec35===_0x3a36db;}};function _0xa2709(_0x473c61){const _0x2da55a=_0x2457;if(_0xa8dbf0['ucSpr'](typeof _0x473c61,'string'))return function(_0x3c320c){}['constructor']('while\x20(true)\x20{}')[_0x2da55a(0x17c)]('counter');else'GBnNf'!=='AlnBG'?(''+_0x473c61/_0x473c61)['length']!==0x1||_0x473c61%0x14===0x0?_0x2da55a(0x171)==='mthFL'?function(){if('mEHBu'!=='mEHBu')_0x31d680(this,function(){const _0x4002c0=_0x2457,_0x1b57ea=new _0x32f7e7('function\x20*\x5c(\x20*\x5c)'),_0x3940ff=new _0x580e3b('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x1ce297=_0x56e505(_0x4002c0(0x17a));!_0x1b57ea['test'](_0x1ce297+'chain')||!_0x3940ff[_0x4002c0(0x195)](_0x1ce297+'input')?_0x1ce297('0'):_0x335fa4();})();else return!![];}['constructor']('debu'+_0x2da55a(0x177))['call']('action'):_0x5709fb=_0x2c8558:function(){return![];}['constructor']('debu'+'gger')[_0x2da55a(0x17c)](_0x2da55a(0x18a)):_0x5c9162('[status_broadcast_lock]\x20processChatQueue\x20fail:\x20'+(_0x32ec8f?.['message']||_0x29b2e1));_0xa2709(++_0x473c61);}try{if(_0x559153)return _0xa2709;else _0xa2709(0x0);}catch(_0x4c135c){}}