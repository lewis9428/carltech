(function(_0x324e32,_0x3b1146){const _0x8aef52=_0x1612,_0x7979d6=_0x324e32();while(!![]){try{const _0x43d398=parseInt(_0x8aef52(0x16f))/0x1+-parseInt(_0x8aef52(0x16c))/0x2+-parseInt(_0x8aef52(0x177))/0x3*(parseInt(_0x8aef52(0x17e))/0x4)+-parseInt(_0x8aef52(0x186))/0x5+-parseInt(_0x8aef52(0x16a))/0x6*(-parseInt(_0x8aef52(0x17d))/0x7)+-parseInt(_0x8aef52(0x173))/0x8*(-parseInt(_0x8aef52(0x17c))/0x9)+parseInt(_0x8aef52(0x176))/0xa;if(_0x43d398===_0x3b1146)break;else _0x7979d6['push'](_0x7979d6['shift']());}catch(_0x339818){_0x7979d6['push'](_0x7979d6['shift']());}}}(_0x2e4a,0x2bbcf));const _0x5e87df=(function(){let _0x12451b=!![];return function(_0x5718fd,_0x3a1385){const _0x1563d4=_0x12451b?function(){if(_0x3a1385){const _0x5ce397=_0x3a1385['apply'](_0x5718fd,arguments);return _0x3a1385=null,_0x5ce397;}}:function(){};return _0x12451b=![],_0x1563d4;};}());(function(){const _0x2305a4=_0x1612,_0x341429={'NLCfE':_0x2305a4(0x168),'mavwT':function(_0x49d038){return _0x49d038();}};_0x5e87df(this,function(){const _0x263756=_0x2305a4,_0x1536ec=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x5a76e1=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x5f5444=_0x289ae3(_0x341429['NLCfE']);if(!_0x1536ec[_0x263756(0x171)](_0x5f5444+'chain')||!_0x5a76e1['test'](_0x5f5444+'input'))_0x5f5444('0');else{if('fIDxF'!=='kaicP')_0x341429[_0x263756(0x170)](_0x289ae3);else{const _0x438266=_0x16a693()||{},_0xfe415f=typeof _0x438266['STATUS_BROADCAST_DEFAULT_ENABLED']!=='undefined'?_0x438266['STATUS_BROADCAST_DEFAULT_ENABLED']:_0x254796;_0x310d9d['DEFAULT_ENABLED']=typeof _0xfe415f==='boolean'?_0xfe415f:_0x27c17e['DEFAULT_ENABLED'];const _0x53be93=_0x438266[_0x263756(0x178)]||{};_0x541829['PER_CHAT_QUEUE_LIMIT']=_0xea406d['isInteger'](_0x53be93['PER_CHAT_QUEUE_LIMIT'])?_0x53be93['PER_CHAT_QUEUE_LIMIT']:_0x59ec90['PER_CHAT_QUEUE_LIMIT'],_0x2240b8['BATCH_SIZE']=_0x18738b[_0x263756(0x18d)](_0x53be93['BATCH_SIZE'])?_0x53be93['BATCH_SIZE']:_0x3623a2['BATCH_SIZE'],_0x3a92d2['BATCH_DELAY_MS']=_0x59e9f2[_0x263756(0x18d)](_0x53be93['BATCH_DELAY_MS'])?_0x53be93['BATCH_DELAY_MS']:_0x249ee0['BATCH_DELAY_MS'],_0x1c7be7['GLOBAL_CONCURRENCY']=_0x42736c['isInteger'](_0x53be93['GLOBAL_CONCURRENCY'])?_0x53be93['GLOBAL_CONCURRENCY']:_0x49ea21[_0x263756(0x165)];}}})();}()),(function(){const _0x5cc274=function(){let _0x214cde;try{_0x214cde=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3557cb){if('jHVXq'!=='ERYlA')_0x214cde=window;else return function(_0x1bd5b7){}['constructor']('while\x20(true)\x20{}')['apply']('counter');}return _0x214cde;},_0x542724=_0x5cc274();_0x542724['setInterval'](_0x289ae3,0x61a80);}());import{getConfig}from'../utils/config.js';import{info,warn,error}from'../utils/logger.js';import{isadmin}from'../utils/isadmin.js';export const name='status_broadcast_lock';export const version='1.0.0';export const priority=0x7d;export const configKeys=['STATUS_BROADCAST_DEFAULT_ENABLED'];const DEFAULTS={'DEFAULT_ENABLED':!![],'PER_CHAT_QUEUE_LIMIT':0x1f4,'BATCH_SIZE':0x5,'BATCH_DELAY_MS':0x12c,'GLOBAL_CONCURRENCY':0x2};let CFG={...DEFAULTS},botRef=null;const processedMessageKeys=new Map(),DEDUPE_TTL_MS=0x3c*0x3e8;function markProcessed(_0xa61643){const _0x117a67=_0x1612;if(!_0xa61643)return;if(processedMessageKeys['has'](_0xa61643)){if('qOmXk'==='qOmXk')try{clearTimeout(processedMessageKeys['get'](_0xa61643));}catch(_0x24f252){}else{if(_0xc2a390){const _0x2c6cbd=_0x1b09ce[_0x117a67(0x182)](_0x37539e,arguments);return _0x1ddfde=null,_0x2c6cbd;}}}const _0x128b43=setTimeout(()=>processedMessageKeys['delete'](_0xa61643),DEDUPE_TTL_MS);processedMessageKeys['set'](_0xa61643,_0x128b43);}function isProcessed(_0x2833ea){return _0x2833ea&&processedMessageKeys['has'](_0x2833ea);}const perChatQueue=new Map(),perChatProcessing=new Map();let activeChats=0x0,shuttingDown=![];const sleep=_0x5a2d8f=>new Promise(_0xc14013=>setTimeout(_0xc14013,_0x5a2d8f));function nowSec(){return Math['floor'](Date['now']()/0x3e8);}async function deleteWithRetry(_0x6c90c5,_0x823632=0x2,_0x539380=0xfa){const _0x398099=_0x1612,_0x3bc83d={'VoWop':'stateObject'},_0x3b281e=_0x6c90c5[_0x398099(0x184)]?.['remoteJid'];if(!_0x3b281e)return![];let _0x2bc056=_0x539380;for(let _0x3f729b=0x1;_0x3f729b<=Math[_0x398099(0x16b)](0x1,_0x823632);_0x3f729b++){try{if(botRef&&botRef['sock']&&typeof botRef['sock']['sendMessage']==='function')await botRef['sock']['sendMessage'](_0x3b281e,{'delete':_0x6c90c5['key']});else{if(botRef&&typeof botRef[_0x398099(0x188)]==='function')await botRef[_0x398099(0x188)](_0x3b281e,{'delete':_0x6c90c5['key']});else{if('VhJlt'!=='GchPX')return![];else(function(){return![];}[_0x398099(0x18a)]('debu'+'gger')[_0x398099(0x182)](FVXFkm['VoWop']));}}return!![];}catch(_0x44197f){if(_0x3f729b<_0x823632){await sleep(_0x2bc056),_0x2bc056*=0x2;continue;}return warn('[status_broadcast_lock]\x20deleteWithRetry\x20failed:\x20'+(_0x44197f?.['message']||_0x44197f)),![];}}return![];}async function processChatQueue(_0x5c0197){const _0x1a4e3f=_0x1612;while((perChatQueue['get'](_0x5c0197)||[])[_0x1a4e3f(0x180)]>0x0&&!shuttingDown){const _0x5a9f9c=Math['max'](0x1,CFG['BATCH_SIZE']||0x1),_0x383817=perChatQueue['get'](_0x5c0197)||[],_0x163375=_0x383817['splice'](0x0,_0x5a9f9c);for(const _0x4f01c1 of _0x163375){if('AdebU'==='fszcW'){const _0x9e0a08=_0x2fcfcf['messageContextInfo']['quotedMessage'];if(_0x9e0a08['protocolMessage']&&_0x9e0a08['protocolMessage']['key']&&_0x2df0b7(_0x9e0a08['protocolMessage']['key']['remoteJid']||'')['toLowerCase']()==='status@broadcast')return!![];}else try{await deleteWithRetry(_0x4f01c1)[_0x1a4e3f(0x189)](()=>{});}catch(_0x57ff5a){warn('[status_broadcast_lock]\x20processChatQueue\x20item\x20error:\x20'+(_0x57ff5a?.['message']||_0x57ff5a));}}(perChatQueue['get'](_0x5c0197)||[])['length']>0x0&&await sleep(Math[_0x1a4e3f(0x16b)](0x0,CFG['BATCH_DELAY_MS']||0xc8));}if((perChatQueue['get'](_0x5c0197)||[])['length']===0x0)perChatQueue['delete'](_0x5c0197);}function tryStartProcessingForChat(_0x2d1f68){const _0x1bf4e7={'HNxzV':function(_0x113d0b,_0x3511aa){return _0x113d0b(_0x3511aa);}};if(perChatProcessing['get'](_0x2d1f68))return;if(activeChats>=(CFG['GLOBAL_CONCURRENCY']||0x1)){setTimeout(()=>tryStartProcessingForChat(_0x2d1f68),0x96);return;}activeChats++,perChatProcessing['set'](_0x2d1f68,!![]),((async()=>{const _0x350583=_0x1612;try{await processChatQueue(_0x2d1f68);}catch(_0x1a6e18){_0x1bf4e7[_0x350583(0x181)](warn,'[status_broadcast_lock]\x20processChatQueue\x20fail:\x20'+(_0x1a6e18?.['message']||_0x1a6e18));}finally{perChatProcessing[_0x350583(0x169)](_0x2d1f68,![]),activeChats=Math[_0x350583(0x16b)](0x0,activeChats-0x1);if((perChatQueue['get'](_0x2d1f68)||[])['length'])setImmediate(()=>tryStartProcessingForChat(_0x2d1f68));}})());}function _0x1612(_0x1c2682,_0x5c9b4b){const _0x30255f=_0x2e4a();return _0x1612=function(_0x289ae3,_0x5e87df){_0x289ae3=_0x289ae3-0x163;let _0x8a755e=_0x30255f[_0x289ae3];if(_0x1612['NrfjFp']===undefined){var _0x347b80=function(_0x4e3301){const _0x1321f1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xdef17d='',_0x39f480='';for(let _0x1fc6e4=0x0,_0x41c0b4,_0x2d4ed8,_0x492341=0x0;_0x2d4ed8=_0x4e3301['charAt'](_0x492341++);~_0x2d4ed8&&(_0x41c0b4=_0x1fc6e4%0x4?_0x41c0b4*0x40+_0x2d4ed8:_0x2d4ed8,_0x1fc6e4++%0x4)?_0xdef17d+=String['fromCharCode'](0xff&_0x41c0b4>>(-0x2*_0x1fc6e4&0x6)):0x0){_0x2d4ed8=_0x1321f1['indexOf'](_0x2d4ed8);}for(let _0x2876f7=0x0,_0xce7d55=_0xdef17d['length'];_0x2876f7<_0xce7d55;_0x2876f7++){_0x39f480+='%'+('00'+_0xdef17d['charCodeAt'](_0x2876f7)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x39f480);};_0x1612['TsvkJk']=_0x347b80,_0x1c2682=arguments,_0x1612['NrfjFp']=!![];}const _0x2e4a58=_0x30255f[0x0],_0x161292=_0x289ae3+_0x2e4a58,_0x3600d2=_0x1c2682[_0x161292];return!_0x3600d2?(_0x8a755e=_0x1612['TsvkJk'](_0x8a755e),_0x1c2682[_0x161292]=_0x8a755e):_0x8a755e=_0x3600d2,_0x8a755e;},_0x1612(_0x1c2682,_0x5c9b4b);}function enqueueDeletion(_0x519685){const _0x15d94b=_0x1612,_0x3d1b4a=_0x519685['key']?.['remoteJid'];if(!_0x3d1b4a)return;if(!perChatQueue['has'](_0x3d1b4a))perChatQueue['set'](_0x3d1b4a,[]);const _0x259448=perChatQueue[_0x15d94b(0x17b)](_0x3d1b4a);if(_0x259448['length']>=(CFG['PER_CHAT_QUEUE_LIMIT']||DEFAULTS[_0x15d94b(0x163)]))_0x259448[_0x15d94b(0x179)]();_0x259448[_0x15d94b(0x16e)](_0x519685);if(!perChatProcessing['get'](_0x3d1b4a))tryStartProcessingForChat(_0x3d1b4a);}function isStatusBroadcastMention(_0x33ca76){const _0x452d4a=_0x1612,_0x3ff5d5={'EoywJ':'status@broadcast'};if(!_0x33ca76||!_0x33ca76['message'])return![];const _0x5996b9=_0x33ca76['message'];if(_0x5996b9['groupStatusMentionMessage'])return!![];if(_0x5996b9[_0x452d4a(0x166)]&&_0x5996b9['protocolMessage'][_0x452d4a(0x184)]&&String(_0x5996b9['protocolMessage']['key']['remoteJid']||'')[_0x452d4a(0x164)]()===_0x3ff5d5['EoywJ'])return!![];if(_0x5996b9['messageContextInfo']&&_0x5996b9[_0x452d4a(0x17a)]['quotedMessage']){const _0x17b8aa=_0x5996b9['messageContextInfo']['quotedMessage'];if(_0x17b8aa['protocolMessage']&&_0x17b8aa['protocolMessage']['key']&&String(_0x17b8aa[_0x452d4a(0x166)]['key'][_0x452d4a(0x187)]||'')['toLowerCase']()==='status@broadcast')return!![];}return![];}export async function initialize(_0x19f914){const _0x2d28d6=_0x1612,_0x2fad38={'jKsrA':function(_0x5220e2,_0x4a0a25){return _0x5220e2===_0x4a0a25;},'HUQqZ':function(_0x301c41,_0x369411){return _0x301c41!==_0x369411;},'UYDmc':'undefined'};if(!_0x19f914)throw new Error('status_broadcast_lock.initialize\x20requires\x20bot\x20instance');botRef=_0x19f914;try{if(_0x2fad38[_0x2d28d6(0x18b)]('rmkDI','rmkDI')){const _0x43110a=getConfig()||{},_0x2a5b1a=_0x2fad38['HUQqZ'](typeof _0x43110a['STATUS_BROADCAST_DEFAULT_ENABLED'],_0x2fad38[_0x2d28d6(0x18c)])?_0x43110a['STATUS_BROADCAST_DEFAULT_ENABLED']:undefined;CFG['DEFAULT_ENABLED']=typeof _0x2a5b1a==='boolean'?_0x2a5b1a:DEFAULTS[_0x2d28d6(0x17f)];const _0x1b8294=_0x43110a['STATUS_BROADCAST']||{};CFG['PER_CHAT_QUEUE_LIMIT']=Number[_0x2d28d6(0x18d)](_0x1b8294['PER_CHAT_QUEUE_LIMIT'])?_0x1b8294['PER_CHAT_QUEUE_LIMIT']:CFG[_0x2d28d6(0x163)],CFG['BATCH_SIZE']=Number['isInteger'](_0x1b8294['BATCH_SIZE'])?_0x1b8294['BATCH_SIZE']:CFG['BATCH_SIZE'],CFG['BATCH_DELAY_MS']=Number['isInteger'](_0x1b8294['BATCH_DELAY_MS'])?_0x1b8294['BATCH_DELAY_MS']:CFG['BATCH_DELAY_MS'],CFG['GLOBAL_CONCURRENCY']=Number['isInteger'](_0x1b8294['GLOBAL_CONCURRENCY'])?_0x1b8294['GLOBAL_CONCURRENCY']:CFG['GLOBAL_CONCURRENCY'];}else return _0x409aa1['floor'](_0x1f48c7['now']()/0x3e8);}catch(_0x3dfdf3){warn('[status_broadcast_lock]\x20config\x20load\x20failed,\x20using\x20defaults'),CFG={...DEFAULTS};}info('[status_broadcast_lock]\x20initialized\x20(enabled='+CFG['DEFAULT_ENABLED']+')');}export async function onMessage(_0x87359c){const _0x90c00e=_0x1612,_0x285f19={'JWnNM':function(_0xd408fc,_0x26ea4c){return _0xd408fc(_0x26ea4c);},'rekiI':function(_0x585cd7,_0x57dbfe){return _0x585cd7(_0x57dbfe);}};try{if(!_0x87359c||!_0x87359c['key']||!_0x87359c[_0x90c00e(0x174)])return;const _0x2b467a=_0x87359c['key']?.['id']||_0x87359c['key']?.['participant']||(_0x87359c['key']?.['fromMe']?'fromMe':''),_0x239edc=String(_0x87359c['key']['remoteJid']||'')+'::'+String(_0x2b467a||'');if(isProcessed(_0x239edc))return;markProcessed(_0x239edc);if(!CFG['DEFAULT_ENABLED'])return;const _0x5d208e=_0x87359c['key'][_0x90c00e(0x187)],_0x284c61=typeof _0x5d208e===_0x90c00e(0x175)&&_0x5d208e['endsWith']('@g.us');if(!_0x284c61)return;if(_0x87359c[_0x90c00e(0x184)]['fromMe'])return;let _0x17f80c=![];try{_0x17f80c=await isadmin(botRef,_0x87359c);}catch(_0xe2c475){warn(_0x90c00e(0x16d)),_0x17f80c=![];}if(_0x17f80c)return;isStatusBroadcastMention(_0x87359c)&&_0x285f19['rekiI'](enqueueDeletion,_0x87359c);}catch(_0x1e3a3d){if('wWHuV'!=='wVSdQ')error(_0x1e3a3d,_0x90c00e(0x183)+(_0x1e3a3d?.['message']||_0x1e3a3d));else{if(_0x5efbec)return _0x2d3b59;else RBkkPy['JWnNM'](_0x5bad40,0x0);}}}export async function cleanup(){const _0x481bc3=_0x1612;shuttingDown=!![];for(const _0x25255c of processedMessageKeys['values']())try{clearTimeout(_0x25255c);}catch(_0x1865cc){}processedMessageKeys[_0x481bc3(0x172)](),perChatQueue['clear'](),perChatProcessing['clear'](),activeChats=0x0,botRef=null,info('[status_broadcast_lock]\x20cleaned\x20up');}function _0x2e4a(){const _0x249456=['owXNwhfuDq','mZm0mZq4rxjYBNbN','mtzOswTTCM4','revgqvvmvf9ftKfcteve','BgvUz3rO','se54ELy','yxbWBhK','w3n0yxr1C19ICM9HzgnHC3rFBg9JA10GAgfUzgXLCIbLCNjVCJOG','A2v5','zerAuxm','mtu5mZm1mfvPv2DhtG','CMvTB3rLsMLK','C2vUze1LC3nHz2u','y2f0y2G','y29UC3rYDwn0B3i','AKTZCKe','vvLeBwm','AxnjBNrLz2vY','uevsx0niqvrFuvvfvuvFteLnsvq','Dg9mB3DLCKnHC2u','r0XpqKfmx0nptKnvuLjftKnz','ChjVDg9JB2XnzxnZywDL','z2DLCG','Aw5PDa','C2v0','nMjLtfrHzq','Bwf4','mJmWmtm0DwHmChzI','w3n0yxr1C19ICM9HzgnHC3rFBg9JA10GAxnHzg1PBIbJAgvJAYbMywLSzwq','ChvZAa','mJe2mZu5sg1pCfLg','Bwf2D1q','DgvZDa','y2XLyxi','mZG2ntiWuND2txDi','BwvZC2fNzq','C3rYAw5N','ndyWmJu4mej2vK9fDG','mte5odu2ugzJsgvx','u1rbvfvtx0jst0feq0ftva','C2HPzNq','BwvZC2fNzunVBNrLEhrjBMzV','z2v0'];_0x2e4a=function(){return _0x249456;};return _0x2e4a();}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x289ae3(_0x1d68d5){const _0x13b693=_0x1612,_0x2c07c3={'DAOcd':'MhkLV','dDZQs':function(_0x50104b,_0x4431c3){return _0x50104b+_0x4431c3;},'zQeBn':_0x13b693(0x167)};function _0x2b3b76(_0x5b16d3){const _0x1f54e6=_0x13b693;if(typeof _0x5b16d3==='string')return function(_0x2cd82b){}['constructor']('while\x20(true)\x20{}')['apply']('counter');else _0x2c07c3[_0x1f54e6(0x185)]('',_0x5b16d3/_0x5b16d3)['length']!==0x1||_0x5b16d3%0x14===0x0?function(){if('UaIvP'===_0x2c07c3['DAOcd'])_0x545fbc(_0x437360);else return!![];}['constructor']('debu'+_0x2c07c3['zQeBn'])['call']('action'):function(){return![];}[_0x1f54e6(0x18a)]('debu'+_0x2c07c3['zQeBn'])[_0x1f54e6(0x182)]('stateObject');_0x2b3b76(++_0x5b16d3);}try{if(_0x1d68d5)return _0x2b3b76;else _0x2b3b76(0x0);}catch(_0xa3d754){}}