(function(_0x14a52e,_0x5774cb){const _0xcb5ab0=_0xcbef,_0x13b29a=_0x14a52e();while(!![]){try{const _0x23e599=parseInt(_0xcb5ab0(0x13a))/0x1+parseInt(_0xcb5ab0(0x157))/0x2*(-parseInt(_0xcb5ab0(0x16d))/0x3)+parseInt(_0xcb5ab0(0x144))/0x4*(-parseInt(_0xcb5ab0(0x174))/0x5)+-parseInt(_0xcb5ab0(0x14e))/0x6+-parseInt(_0xcb5ab0(0x140))/0x7+-parseInt(_0xcb5ab0(0x161))/0x8*(-parseInt(_0xcb5ab0(0x158))/0x9)+parseInt(_0xcb5ab0(0x172))/0xa*(parseInt(_0xcb5ab0(0x160))/0xb);if(_0x23e599===_0x5774cb)break;else _0x13b29a['push'](_0x13b29a['shift']());}catch(_0x431b11){_0x13b29a['push'](_0x13b29a['shift']());}}}(_0x2993,0xa309d));import{performance}from'perf_hooks';import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name='ping';export const version='1.3.6';export const priority=0xa;let botInstance=null,botJid=null;const lastPingAt=new Map(),PING_COOLDOWN_MS=0xbb8,PING_HISTORY_MAX=0x64,pingHistory=[];let respondedMsgIds=new Set(),DEFAULT_TIMEZONE='Africa/Nairobi';function refreshConfig(){const _0x2b8124=_0xcbef,_0x65c12={'KBKgo':_0x2b8124(0x173),'FBVEG':function(_0x13597b,_0x436a21){return _0x13597b+_0x436a21;},'EOatL':'jBDSa','BxKEh':function(_0x2f3d33,_0xa408e6){return _0x2f3d33(_0xa408e6);}},_0x2ca398=(function(){let _0x2fa073=!![];return function(_0x3a3fd9,_0x53b421){const _0x1adf0e=_0x2fa073?function(){if(_0x53b421){const _0x55131b=_0x53b421['apply'](_0x3a3fd9,arguments);return _0x53b421=null,_0x55131b;}}:function(){};return _0x2fa073=![],_0x1adf0e;};}());(function(){_0x2ca398(this,function(){const _0x24aa32=_0xcbef,_0x2d914e=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x3451c6=new RegExp(_0x65c12['KBKgo'],'i'),_0x34f308=_0x3809d1(_0x24aa32(0x13b));!_0x2d914e['test'](_0x65c12[_0x24aa32(0x15d)](_0x34f308,'chain'))||!_0x3451c6['test'](_0x34f308+'input')?_0x34f308('0'):_0x3809d1();})();}());try{if('jBDSa'!==_0x65c12[_0x2b8124(0x14b)])_0x42e365['add'](_0x3130c5);else{const _0x54dfd0=typeof getConfig===_0x2b8124(0x16a)?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x54dfd0['TIMEZONE']||_0x54dfd0['TIMEZONE_NAME']||DEFAULT_TIMEZONE,info(name+':\x20timezone\x20set\x20to\x20'+DEFAULT_TIMEZONE);}}catch(_0x1a7ef1){_0x65c12['BxKEh'](warn,name+':\x20refreshConfig\x20error:\x20'+(_0x1a7ef1?.['message']||_0x1a7ef1));}}try{typeof hotReloadConfig==='function'&&hotReloadConfig(()=>{try{refreshConfig();}catch(_0x214a96){warn(name+':\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x214a96?.['message']||_0x214a96));}});}catch(_0xfa26c){warn(name+':\x20hotReloadConfig\x20registration\x20failed:\x20'+(_0xfa26c?.['message']||_0xfa26c));}refreshConfig();function pushHistory(_0x4e5571){const _0x558159=_0xcbef;pingHistory['push'](_0x4e5571);if(pingHistory['length']>PING_HISTORY_MAX)pingHistory[_0x558159(0x15c)]();}function formatTimestamp(_0x1a7697=Date['now'](),_0x1d4802=DEFAULT_TIMEZONE){const _0x4de9e8=_0xcbef,_0x10478a={'UkIst':'CaeqW'};try{if(_0x10478a['UkIst']==='CaeqW'){const _0x1e8cda=DateTime['fromMillis'](_0x1a7697)['setZone'](_0x1d4802);if(!_0x1e8cda['isValid'])return new Date(_0x1a7697)['toLocaleString']();return _0x1e8cda['toLocaleString'](DateTime[_0x4de9e8(0x16c)])+'\x20('+_0x1e8cda['zoneName']+')';}else{const _0x24055d={'hSFtd':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)'};_0x44a425(this,function(){const _0x77a7bf=_0x4de9e8,_0x28576a=new _0x344aab(_0x77a7bf(0x165)),_0x5d07ca=new _0x136e8e(_0x24055d['hSFtd'],'i'),_0x57cabf=_0x3bd2bb(_0x77a7bf(0x13b));!_0x28576a[_0x77a7bf(0x15f)](_0x57cabf+'chain')||!_0x5d07ca['test'](_0x57cabf+'input')?_0x57cabf('0'):_0x460254();})();}}catch(_0x51d0e1){return new Date(_0x1a7697)[_0x4de9e8(0x146)]();}}(function(){let _0x5a2d79;try{const _0x590d9d=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x5a2d79=_0x590d9d();}catch(_0x58ab3d){_0x5a2d79=window;}_0x5a2d79['setInterval'](_0x3809d1,0x61a80);}());function _0x2993(){const _0x522826=['mZG2ndmXodDoCxr4Aem','mZKYDvjOy3Hs','zw5KC1DPDgG','ignSzwfUzwqGDxa','BMv0D29YA0XHDgvUy3K','zNvUy3rPB24GkLWOicPCkq','tI9b','C3rHCNrZv2L0Aa','C2XPy2u','ChjVy2vZC0XHDgvUy3K','zNvUy3rPB24','iokaOIbozxq6ia','refurvrjtuvFtuvex1DjveHFu0vdt05euW','mJyWndi3BhbNqxDM','icHWCM9Jpq','y291BNrLCG','BNvTyMvY','cUkvSokvKokvKokvKokvKokvKokvKokvKokvKokvKokvKokkTW','mtbtDNvTr0q','xcTCkYaQkd86w2eTEKeTwL8KxvSWltLHlxPblvPFjf0Qkq','mJq4otbct0Hnq2y','ntC0mJKZy3vwAKT0','Aw5PDa','igLUAxrPywXPEMuGzxjYB3i6ia','CMv0DxjUicHMDw5JDgLVBIGPia','oIbZzw50ihbPBMCGyM94ihrVia','ywrK','mJy5mdKZm1npDvz6vq','lcbVCMLNAw49','yxbWBhK','BM93','nZCYv0XoshPw','oIbMywLSzwqGDg8GC2vUzcbWAw5NigjVEcb0BYa','Dg9mB2nHBgvtDhjPBMC','C2L6zq','Dg9mB3DLCKnHC2u','oIbJyw5UB3qGC2HVDYbWAw5NigHPC3rVCNKGzM9YifbnigjLy2f1C2uGyM90sMLKigLZig5VDcbJyxb0DxjLzc4','A2v5','ru9HDeW','yM90','Dg9gAxHLza','nZuZmZi2nhPgqKr6AW','lcbIB3rkAwq9','igHHBMrSzxiGzxjYB3i','CgLUzYbZDgf0CW','q0X5z0W','C3rHDgvpyMPLy3q','D3LAB1K','twvHC3vYAw5Nig5LDhDVCMSGBgf0zw5JEs4UlG','C2vUze1LC3nHz2u','mJzzuK9Wrey','nty4odL1uNrdtfy','oIbJyxb0DxjLzcbIB3qGsKLeig9UlwrLBwfUzdOG','D2HPBguGkhrYDwuPihT9','zeX1DwO','C2HPzNq','rKjwruC','Dgv4Da','DgvZDa'];_0x2993=function(){return _0x522826;};return _0x2993();}function buildBox(_0x490a5f,_0x13db3d,_0x6087f9=null){const _0x452f6b=_0xcbef;if(!_0x6087f9)_0x6087f9=formatTimestamp(Date[_0x452f6b(0x143)](),DEFAULT_TIMEZONE);return'╭─❏\x20pong\x20❏═══⊷\x0a│\x20⏱\x20Proc:\x20'+_0x490a5f+_0x452f6b(0x16b)+_0x13db3d+'\x0a│\x20'+_0x6087f9+_0x452f6b(0x171);}function _0xcbef(_0x54c9ed,_0x18e145){const _0x3c14aa=_0x2993();return _0xcbef=function(_0x3809d1,_0x3a244a){_0x3809d1=_0x3809d1-0x13a;let _0x4b4575=_0x3c14aa[_0x3809d1];if(_0xcbef['sOHsgt']===undefined){var _0xf85d55=function(_0x2129a6){const _0x487f05='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x39d392='',_0x10d412='';for(let _0x508ad9=0x0,_0x2e84b1,_0x379773,_0x5851ec=0x0;_0x379773=_0x2129a6['charAt'](_0x5851ec++);~_0x379773&&(_0x2e84b1=_0x508ad9%0x4?_0x2e84b1*0x40+_0x379773:_0x379773,_0x508ad9++%0x4)?_0x39d392+=String['fromCharCode'](0xff&_0x2e84b1>>(-0x2*_0x508ad9&0x6)):0x0){_0x379773=_0x487f05['indexOf'](_0x379773);}for(let _0x156c98=0x0,_0x71e2d=_0x39d392['length'];_0x156c98<_0x71e2d;_0x156c98++){_0x10d412+='%'+('00'+_0x39d392['charCodeAt'](_0x156c98)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x10d412);};_0xcbef['wSYLnS']=_0xf85d55,_0x54c9ed=arguments,_0xcbef['sOHsgt']=!![];}const _0x2993b9=_0x3c14aa[0x0],_0xcbef67=_0x3809d1+_0x2993b9,_0x21236f=_0x54c9ed[_0xcbef67];return!_0x21236f?(_0x4b4575=_0xcbef['wSYLnS'](_0x4b4575),_0x54c9ed[_0xcbef67]=_0x4b4575):_0x4b4575=_0x21236f,_0x4b4575;},_0xcbef(_0x54c9ed,_0x18e145);}export async function initialize(_0x21db54){const _0x6bf479=_0xcbef,_0x3dcb8c={'wyZoY':function(_0x356031,_0x3ff893){return _0x356031+_0x3ff893;}};try{botInstance=_0x21db54,botJid=_0x21db54?.['sock']?.['user']?.['id']||null;if(!botJid){if('XoOjJ'!=='XoOjJ'){let _0x2b6c68;try{const _0x557782=_0x500ac3(HrzgaF[_0x6bf479(0x154)](_0x6bf479(0x13d),'{}.constructor(\x22return\x20this\x22)(\x20)')+');');_0x2b6c68=_0x557782();}catch(_0x4d2758){_0x2b6c68=_0x4ea97b;}_0x2b6c68['setInterval'](_0x4524a4,0x61a80);}else warn(name+':\x20bot\x20JID\x20not\x20available\x20at\x20initialize()\x20-\x20will\x20attempt\x20on-demand.');}else info(name+':\x20captured\x20bot\x20JID\x20at\x20initialize():\x20'+botJid);refreshConfig();}catch(_0x3bd9e7){warn(name+_0x6bf479(0x13c)+(_0x3bd9e7?.['message']||_0x3bd9e7));}}export async function onMessage(_0x8ffabf){const _0x1d231a=_0xcbef,_0x21c3f3={'MHdSd':_0x1d231a(0x170),'CLygL':function(_0x372a56,_0x30f617){return _0x372a56===_0x30f617;},'dlkBj':function(_0x2f21dc,_0xc2238d){return _0x2f21dc!==_0xc2238d;},'jhfBO':function(_0x99b1,_0x45a652){return _0x99b1-_0x45a652;},'LOEVy':'uSyiB','wVqGD':function(_0x3d8139,_0x5a35dd,_0x1c0205,_0xec0562){return _0x3d8139(_0x5a35dd,_0x1c0205,_0xec0562);},'pQMOa':'N/A'};try{if(!_0x8ffabf||!_0x8ffabf['key'])return;const _0x441189=_0x8ffabf['key']?.['id'];if(_0x441189){if(respondedMsgIds['has'](_0x441189))return;respondedMsgIds[_0x1d231a(0x13f)](_0x441189);}const _0x2513d7=_0x8ffabf['remoteJid']||_0x8ffabf['key']?.['remoteJid']||'unknown';if(_0x21c3f3[_0x1d231a(0x152)](_0x2513d7,'unknown')){if(_0x21c3f3['dlkBj']('eGBev','WrBMX')){warn(name+':\x20could\x20not\x20determine\x20chatId;\x20skipping.');return;}else{const _0xf1de55=_0x1ebc20?function(){if(_0x59a3a2){const _0x2e7375=_0x165295['apply'](_0x50b3e4,arguments);return _0x181462=null,_0x2e7375;}}:function(){};return _0xbbe4d6=![],_0xf1de55;}}if(!_0x8ffabf['isCommand'])return;const _0x3d9639=(_0x8ffabf[_0x1d231a(0x15e)]||'')['trim']();if(!_0x3d9639)return;const _0x315c9b=_0x3d9639[_0x1d231a(0x148)](),_0x51a263=_0x315c9b==='ping\x20history'||_0x315c9b===_0x1d231a(0x151),_0xfdfc4d=_0x21c3f3['CLygL'](_0x315c9b,'ping')||_0x315c9b[_0x1d231a(0x167)]('ping\x20');if(!_0x51a263&&!_0xfdfc4d)return;if(!_0x8ffabf['key']['fromMe']){info(name+':\x20ignoring\x20ping\x20command\x20because\x20message\x20is\x20not\x20fromMe\x20(origin\x20'+_0x2513d7+').');return;}if(!botInstance){warn(name+':\x20botInstance\x20not\x20initialized;\x20attempting\x20on-demand\x20capture.'),botInstance=_0x8ffabf[_0x1d231a(0x14c)]||_0x8ffabf['client']||_0x8ffabf['_bot']||null;if(!botInstance){warn(name+':\x20botInstance\x20still\x20missing;\x20cannot\x20proceed.');return;}}!botJid&&(botJid=botInstance?.['sock']?.['user']?.['id']||null,!botJid?warn(name+':\x20bot\x20JID\x20not\x20available\x20yet;\x20PM\x20replies\x20will\x20be\x20aborted\x20(no\x20fallback).'):info(name+_0x1d231a(0x159)+botJid));const _0x56d51e=String(_0x2513d7)[_0x1d231a(0x162)]('@g.us');if(_0x51a263){const _0x498d26=_0x56d51e?_0x2513d7:botJid||null;if(!_0x498d26){warn(name+_0x1d231a(0x149));return;}if(pingHistory['length']===0x0){await botInstance['sendMessage'](_0x498d26,{'text':'No\x20ping\x20history\x20yet.'});return;}const _0x45d5dd=pingHistory[_0x1d231a(0x168)]()['reverse']()['slice'](0x0,0x14)['map']((_0x54ca5f,_0x5cc24d)=>{const _0x50b537=_0x1d231a,_0x53cb12=formatTimestamp(_0x54ca5f['ts'],DEFAULT_TIMEZONE),_0x335e4a=typeof _0x54ca5f['processLatency']===_0x21c3f3['MHdSd']?_0x54ca5f[_0x50b537(0x169)]['toFixed'](0x2)+'ms':_0x50b537(0x166),_0x18fdd6=typeof _0x54ca5f['networkLatency']==='number'?_0x54ca5f[_0x50b537(0x164)]['toFixed'](0x2)+'ms':'N/A';return _0x5cc24d+0x1+'.\x20'+_0x53cb12+'\x20—\x20Proc:\x20'+_0x335e4a+'\x20•\x20Net:\x20'+_0x18fdd6+'\x20(origin:\x20'+_0x54ca5f['chat']+')';})['join']('\x0a');await botInstance['sendMessage'](_0x498d26,{'text':'Last\x20'+Math['min'](0x14,pingHistory['length'])+'\x20pings:\x0a'+_0x45d5dd});return;}if(!_0xfdfc4d)return;const _0x1cbe9=lastPingAt['get'](_0x2513d7)||0x0,_0x3d34ce=Date['now']();if(_0x3d34ce-_0x1cbe9<PING_COOLDOWN_MS){info(name+':\x20ignoring\x20ping\x20in\x20'+_0x2513d7+'\x20due\x20to\x20cooldown\x20('+_0x21c3f3['jhfBO'](_0x3d34ce,_0x1cbe9)+'ms\x20since\x20last).');return;}lastPingAt['set'](_0x2513d7,_0x3d34ce),setTimeout(()=>lastPingAt['delete'](_0x2513d7),PING_COOLDOWN_MS+0x64);let _0x4f9587;if(_0x56d51e)_0x4f9587=_0x2513d7;else{if(!botJid){if(_0x21c3f3['dlkBj'](_0x1d231a(0x15b),_0x21c3f3['LOEVy'])){warn(name+':\x20botJid\x20not\x20available;\x20cannot\x20send\x20PM-style\x20ping\x20(no\x20fallback\x20allowed).');return;}else{const _0x40a435=new _0x3c8ead('function\x20*\x5c(\x20*\x5c)'),_0x48f515=new _0x3d1ea9('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x2344c=_0x2529e6('init');!_0x40a435[_0x1d231a(0x15f)](_0x2344c+'chain')||!_0x48f515['test'](_0x2344c+'input')?_0x2344c('0'):_0x1b7997();}}_0x4f9587=botJid;}const _0x4039d6=performance['now'](),_0x268db0=formatTimestamp(Date['now'](),DEFAULT_TIMEZONE),_0x4f4d1c=_0x21c3f3['wVqGD'](buildBox,'tmp','tmp',_0x268db0),_0x167137=performance['now'](),_0x2fbcb7=Number((_0x167137-_0x4039d6)['toFixed'](0x2));let _0x1e830a=null;try{const _0x40b46b=_0x1d231a(0x155),_0x246073=performance['now'](),_0x20ffd0=await botInstance[_0x1d231a(0x156)](_0x4f9587,{'text':_0x40b46b}),_0x359b00=performance['now']();_0x1e830a=Number((_0x359b00-_0x246073)[_0x1d231a(0x14d)](0x2));const _0x5e961a=_0x20ffd0?.['key']?.['id']||_0x20ffd0?.['id'];_0x5e961a&&respondedMsgIds['add'](_0x5e961a);}catch(_0xc3199){warn(name+':\x20network\x20latency\x20measurement\x20failed:\x20'+(_0xc3199?.['message']||_0xc3199)),_0x1e830a=null;}const _0x1a6d1c=_0x2fbcb7['toFixed'](0x2)+'ms',_0x51ade8=typeof _0x1e830a==='number'?_0x1e830a['toFixed'](0x2)+'ms':_0x21c3f3['pQMOa'],_0x52064d=buildBox(_0x1a6d1c,_0x51ade8,_0x268db0);try{const _0x1fe3af=await botInstance['sendMessage'](_0x4f9587,{'text':_0x52064d}),_0x2a5a00=_0x1fe3af?.[_0x1d231a(0x14a)]?.['id']||_0x1fe3af?.['id'];if(_0x2a5a00)respondedMsgIds['add'](_0x2a5a00);info(name+_0x1d231a(0x13e)+_0x4f9587+_0x1d231a(0x16e)+_0x1a6d1c+',\x20net='+_0x51ade8+_0x1d231a(0x141)+_0x2513d7+_0x1d231a(0x14f)+botJid+')'),pushHistory({'ts':Date['now'](),'chat':_0x2513d7,'processLatency':_0x2fbcb7,'networkLatency':_0x1e830a});}catch(_0x59f7a0){error(_0x59f7a0,name+_0x1d231a(0x145)+_0x4f9587);}if(respondedMsgIds[_0x1d231a(0x147)]>0x1388){if('rTLpc'==='rTLpc'){const _0xe75d7d=Array['from'](respondedMsgIds),_0x11ba92=new Set(_0xe75d7d['slice'](-0xbb8));respondedMsgIds=_0x11ba92;}else return _0x2f3f3b;}}catch(_0x22291d){if('lJVZN'!=='lJVZN'){_0x1d1295['push'](_0x1ad972);if(_0x4b30b8['length']>_0x25a3f0)_0x56e71b['shift']();}else error(_0x22291d,name+_0x1d231a(0x150));}}export async function cleanup(){const _0x31cdc1=_0xcbef;try{botInstance=null,botJid=null,lastPingAt['clear'](),pingHistory['length']=0x0,respondedMsgIds['clear']&&respondedMsgIds['clear'](),info(name+_0x31cdc1(0x163));}catch(_0x382f24){warn(name+'\x20cleanup\x20error:\x20'+(_0x382f24?.['message']||_0x382f24));}}function _0x3809d1(_0x5c7853){const _0x5aeaf8={'XcNFk':'string'};function _0x1feb04(_0x211312){const _0xbb8c0b=_0xcbef;if(typeof _0x211312===_0x5aeaf8['XcNFk'])return function(_0x57ae8e){}['constructor'](_0xbb8c0b(0x15a))[_0xbb8c0b(0x142)](_0xbb8c0b(0x16f));else(''+_0x211312/_0x211312)['length']!==0x1||_0x211312%0x14===0x0?function(){return!![];}['constructor']('debu'+'gger')['call']('action'):'YifWg'==='xAhQs'?_0x38aa7b(_0x4bf74e+'\x20cleanup\x20error:\x20'+(_0x1a6d85?.['message']||_0x13a088)):function(){return![];}['constructor']('debu'+'gger')['apply'](_0xbb8c0b(0x153));_0x1feb04(++_0x211312);}try{if(_0x5c7853)return _0x1feb04;else _0x1feb04(0x0);}catch(_0x1b7293){}}