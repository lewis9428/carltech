const _0x5059c5=_0x1436;(function(_0x1d4008,_0x28f277){const _0x6cb8e4=_0x1436,_0x1977e8=_0x1d4008();while(!![]){try{const _0x1355c8=-parseInt(_0x6cb8e4(0x108))/0x1*(-parseInt(_0x6cb8e4(0x116))/0x2)+-parseInt(_0x6cb8e4(0x104))/0x3*(parseInt(_0x6cb8e4(0x11d))/0x4)+parseInt(_0x6cb8e4(0x11c))/0x5+-parseInt(_0x6cb8e4(0x105))/0x6+parseInt(_0x6cb8e4(0x10b))/0x7+parseInt(_0x6cb8e4(0xf9))/0x8+-parseInt(_0x6cb8e4(0xef))/0x9*(parseInt(_0x6cb8e4(0x10a))/0xa);if(_0x1355c8===_0x28f277)break;else _0x1977e8['push'](_0x1977e8['shift']());}catch(_0xa85d6a){_0x1977e8['push'](_0x1977e8['shift']());}}}(_0x59ff,0x216fb));function _0x59ff(){const _0x3debda=['veLnrvPptKu','mta3odi0nvzitKTosW','ng1HwwLmBq','C2L6zq','wuTPtfu','oIbYzwzYzxnOq29UzMLNigvYCM9YoIa','ChjVy2vZC0XHDgvUy3K','zgvIDq','mtq4odz6v2vmy1u','icHVCMLNAw46ia','BgvUz3rO','Evv4EuW','C2XPy2u','DgvZDa','C2v0sw50zxj2ywW','C2vUze1LC3nHz2u','CgLUzW','ihbPBMDZoGO','mteZmdaWme9JANHTua','zgvSzxrL','y2HHDa','r2nArvO','ywrK','tI9b','y29UC3rYDwn0B3i','C2v0wM9Uzq','CMvTB3rLsMLK','renzAgi','zNjVBq','ntG4oty5v0DMs2Hg','mtaYotyZmg5iu2HHtW','AhL5q0u','Dg9gAxHLza','mwvADg1wEG','BwvZC2fNzq','nJCWwgr1ugHk','mtq0odq4ounqBeD0BW','BM93','oIbIB3rkAwqGBM90igf2ywLSywjSztSGy2fUBM90ihnLBMqGue0TC3r5BguGCgLUzYaOBM8GzMfSBgjHy2SGywXSB3DLzcKU','uhHOue0','igHHBMrSzxiGzxjYB3i','oIbUzxr3B3jRigXHDgvUy3KGBwvHC3vYzw1LBNqGzMfPBgvKoIa','oIbJyxb0DxjLzcbIB3qGsKLeigf0igLUAxrPywXPEMuOktOG','EuTPvMO','tM8GCgLUzYbOAxn0B3j5ihLLDc4','ms4ZlJy','ANboAfy','mtaZnZuWsgHYCw9e','oIbIB3rjBNn0yw5JzsbUB3qGAw5PDgLHBgL6zwq7igf0DgvTChrPBMCGB24TzgvTyw5KignHChr1CMuU','BKrRALO','BNvTyMvY','oIbOB3rszwXVywrdB25MAwCGCMvNAxn0CMf0Aw9UigzHAwXLzdOG'];_0x59ff=function(){return _0x3debda;};return _0x59ff();}import{performance}from'perf_hooks';import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';export const name='ping';export const version=_0x5059c5(0x114);export const priority=0xa;let botInstance=null,botJid=null;function _0x1436(_0x24d43b,_0x107977){const _0x1b8065=_0x59ff();return _0x1436=function(_0x27000a,_0x2c9884){_0x27000a=_0x27000a-0xec;let _0x3665f8=_0x1b8065[_0x27000a];if(_0x1436['chSnau']===undefined){var _0x26fa25=function(_0x28486b){const _0x1987bf='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x30f13f='',_0x454845='';for(let _0x2cea16=0x0,_0x4ed096,_0x9c755a,_0xd62d0b=0x0;_0x9c755a=_0x28486b['charAt'](_0xd62d0b++);~_0x9c755a&&(_0x4ed096=_0x2cea16%0x4?_0x4ed096*0x40+_0x9c755a:_0x9c755a,_0x2cea16++%0x4)?_0x30f13f+=String['fromCharCode'](0xff&_0x4ed096>>(-0x2*_0x2cea16&0x6)):0x0){_0x9c755a=_0x1987bf['indexOf'](_0x9c755a);}for(let _0x26b258=0x0,_0x54e619=_0x30f13f['length'];_0x26b258<_0x54e619;_0x26b258++){_0x454845+='%'+('00'+_0x30f13f['charCodeAt'](_0x26b258)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x454845);};_0x1436['uOKvqH']=_0x26fa25,_0x24d43b=arguments,_0x1436['chSnau']=!![];}const _0x59ff5a=_0x1b8065[0x0],_0x143648=_0x27000a+_0x59ff5a,_0x40df96=_0x24d43b[_0x143648];return!_0x40df96?(_0x3665f8=_0x1436['uOKvqH'](_0x3665f8),_0x24d43b[_0x143648]=_0x3665f8):_0x3665f8=_0x40df96,_0x3665f8;},_0x1436(_0x24d43b,_0x107977);}const lastPingAt=new Map(),PING_COOLDOWN_MS=0xbb8,PING_HISTORY_MAX=0x64,pingHistory=[];let respondedMsgIds=new Set();(function(){const _0x375b0f={'kummE':function(_0x29e089,_0x1622ec){return _0x29e089(_0x1622ec);}};let _0x49e57a;try{const _0x3f1826=_0x375b0f['kummE'](Function,'return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x49e57a=_0x3f1826();}catch(_0x1ffe21){_0x49e57a=window;}_0x49e57a['setInterval'](_0x27000a,0x61a80);}());let DEFAULT_TIMEZONE='Africa/Nairobi';function refreshConfig(){const _0x3ae65d=_0x5059c5,_0x511fec=(function(){const _0x232eaf=_0x1436;if('npAUB'==='Dmmjq'){const _0x7da945=_0x544209(_0x16b0f5['ts'],_0x329400),_0x2ed5d5=typeof _0x257675['processLatency']==='number'?_0x35618a[_0x232eaf(0xed)]['toFixed'](0x2)+'ms':'N/A',_0x1afcf7=typeof _0x4a7d07['networkLatency']===_0x232eaf(0x119)?_0xe54022['networkLatency'][_0x232eaf(0x107)](0x2)+'ms':'N/A';return _0xd0ca30+0x1+'.\x20'+_0x7da945+'\x20—\x20Proc:\x20'+_0x2ed5d5+'\x20•\x20Net:\x20'+_0x1afcf7+'\x20(origin:\x20'+_0x2f9899[_0x232eaf(0xfb)]+')';}else{let _0x2a571c=!![];return function(_0x3c6162,_0x28769c){const _0x1e490a=_0x2a571c?function(){if(_0x28769c){const _0x2c15fd=_0x28769c['apply'](_0x3c6162,arguments);return _0x28769c=null,_0x2c15fd;}}:function(){};return _0x2a571c=![],_0x1e490a;};}}());(function(){_0x511fec(this,function(){const _0x1481cf=_0x1436,_0x15c676=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x4d7adb=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x2e0e7e=_0x27000a('init');!_0x15c676[_0x1481cf(0xf4)](_0x2e0e7e+'chain')||!_0x4d7adb['test'](_0x2e0e7e+'input')?_0x2e0e7e('0'):_0x27000a();})();}());try{const _0x1e2ec3=typeof getConfig==='function'?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x1e2ec3[_0x3ae65d(0x11b)]||_0x1e2ec3['TIMEZONE_NAME']||DEFAULT_TIMEZONE,info(name+':\x20timezone\x20set\x20to\x20'+DEFAULT_TIMEZONE);}catch(_0x4faa48){warn(name+_0x3ae65d(0xec)+(_0x4faa48?.['message']||_0x4faa48));}}try{typeof hotReloadConfig==='function'&&hotReloadConfig(()=>{try{refreshConfig();}catch(_0x255a7f){warn(name+':\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x255a7f?.['message']||_0x255a7f));}});}catch(_0x2bc48a){warn(name+_0x5059c5(0x11a)+(_0x2bc48a?.['message']||_0x2bc48a));}refreshConfig();function pushHistory(_0x5af92){const _0x1508bc=_0x5059c5;pingHistory['push'](_0x5af92);if(pingHistory[_0x1508bc(0xf1)]>PING_HISTORY_MAX)pingHistory['shift']();}function formatTimestamp(_0x5a3937=Date['now'](),_0x5c0d8a=DEFAULT_TIMEZONE){const _0x48740b=_0x5059c5;try{const _0x41c8b1=DateTime['fromMillis'](_0x5a3937)[_0x48740b(0x100)](_0x5c0d8a);if(!_0x41c8b1['isValid'])return new Date(_0x5a3937)['toLocaleString']();return _0x41c8b1['toLocaleString'](DateTime['DATETIME_MED_WITH_SECONDS'])+'\x20('+_0x41c8b1['zoneName']+')';}catch(_0x2d697a){return new Date(_0x5a3937)['toLocaleString']();}}function buildBox(_0x424f94,_0x29112e,_0x178b25=null){const _0x1dbd3a=_0x5059c5;if(!_0x178b25)_0x178b25=formatTimestamp(Date[_0x1dbd3a(0x10c)](),DEFAULT_TIMEZONE);return'╭─❏\x20pong\x20❏═══⊷\x0a│\x20⏱\x20Proc:\x20'+_0x424f94+'\x20•\x20Net:\x20'+_0x29112e+'\x0a│\x20'+_0x178b25+'\x0a╰══════════⊷';}export async function initialize(_0x40da63){const _0xc93131=_0x5059c5;try{botInstance=_0x40da63,botJid=_0x40da63?.['sock']?.['user']?.['id']||null,!botJid?warn(name+':\x20bot\x20JID\x20not\x20available\x20at\x20initialize()\x20-\x20will\x20attempt\x20on-demand.'):info(name+_0xc93131(0x111)+botJid),refreshConfig();}catch(_0x4998dd){'UAYDH'!=='kkmGY'?warn(name+'\x20initialize\x20error:\x20'+(_0x4998dd?.['message']||_0x4998dd)):_0x35c254(0x0);}}export async function onMessage(_0x5a5928){const _0x57ca23=_0x5059c5,_0x42566f={'jpNhV':function(_0x4eec60,_0x483c60){return _0x4eec60===_0x483c60;},'WARiJ':'ping\x20history','dSvLA':'@g.us','rvtwh':function(_0x25e608,_0x504a10){return _0x25e608(_0x504a10);},'iLDcE':function(_0x4188b5,_0x431e2a){return _0x4188b5<_0x431e2a;},'yKiVj':function(_0x313573,_0x1ae804){return _0x313573(_0x1ae804);}};try{if(!_0x5a5928||!_0x5a5928['key'])return;const _0x1fa26d=_0x5a5928['key']?.['id'];if(_0x1fa26d){if(respondedMsgIds['has'](_0x1fa26d))return;respondedMsgIds['add'](_0x1fa26d);}const _0x130032=_0x5a5928[_0x57ca23(0x101)]||_0x5a5928['key']?.['remoteJid']||'unknown';if(_0x130032==='unknown'){warn(name+':\x20could\x20not\x20determine\x20chatId;\x20skipping.');return;}if(!_0x5a5928['isCommand'])return;const _0x28dc36=(_0x5a5928['text']||'')['trim']();if(!_0x28dc36)return;const _0xfbaf9b=_0x28dc36['toLowerCase'](),_0x5ebfa9=_0x42566f[_0x57ca23(0x115)](_0xfbaf9b,_0x42566f['WARiJ'])||_0xfbaf9b==='ping\x20stats',_0x154945=_0xfbaf9b===_0x57ca23(0xf7)||_0xfbaf9b['startsWith']('ping\x20');if(!_0x5ebfa9&&!_0x154945)return;if(!_0x5a5928['key']['fromMe']){if(_0x57ca23(0x118)!=='nDkjZ'){_0x9451eb(_0x255a45+':\x20ignoring\x20ping\x20command\x20because\x20message\x20is\x20not\x20fromMe\x20(origin\x20'+_0x1572cc+').');return;}else{info(name+':\x20ignoring\x20ping\x20command\x20because\x20message\x20is\x20not\x20fromMe\x20(origin\x20'+_0x130032+').');return;}}if(!botInstance){warn(name+_0x57ca23(0x117)),botInstance=_0x5a5928['bot']||_0x5a5928['client']||_0x5a5928['_bot']||null;if(!botInstance){warn(name+':\x20botInstance\x20still\x20missing;\x20cannot\x20proceed.');return;}}!botJid&&(botJid=botInstance?.['sock']?.['user']?.['id']||null,!botJid?warn(name+':\x20bot\x20JID\x20not\x20available\x20yet;\x20PM\x20replies\x20will\x20be\x20aborted\x20(no\x20fallback).'):info(name+':\x20captured\x20bot\x20JID\x20on-demand:\x20'+botJid));const _0x3a1e1f=String(_0x130032)['endsWith'](_0x42566f['dSvLA']);if(_0x5ebfa9){const _0x220836=_0x3a1e1f?_0x130032:botJid||null;if(!_0x220836){_0x42566f['rvtwh'](warn,name+':\x20cannot\x20show\x20ping\x20history\x20for\x20PM\x20because\x20botJid\x20is\x20not\x20captured.');return;}if(pingHistory[_0x57ca23(0xf1)]===0x0){await botInstance['sendMessage'](_0x220836,{'text':_0x57ca23(0x113)});return;}const _0x555eb7=pingHistory[_0x57ca23(0xf3)]()['reverse']()[_0x57ca23(0xf3)](0x0,0x14)['map']((_0x2610d7,_0x1919ee)=>{const _0x3400bb=_0x57ca23,_0x1a1125=formatTimestamp(_0x2610d7['ts'],DEFAULT_TIMEZONE),_0x5208a4=typeof _0x2610d7[_0x3400bb(0xed)]==='number'?_0x2610d7['processLatency']['toFixed'](0x2)+'ms':'N/A',_0x54bd29=typeof _0x2610d7['networkLatency']===_0x3400bb(0x119)?_0x2610d7['networkLatency']['toFixed'](0x2)+'ms':_0x3400bb(0xfe);return _0x1919ee+0x1+'.\x20'+_0x1a1125+'\x20—\x20Proc:\x20'+_0x5208a4+'\x20•\x20Net:\x20'+_0x54bd29+_0x3400bb(0xf0)+_0x2610d7['chat']+')';})['join']('\x0a');await botInstance[_0x57ca23(0xf6)](_0x220836,{'text':'Last\x20'+Math['min'](0x14,pingHistory[_0x57ca23(0xf1)])+_0x57ca23(0xf8)+_0x555eb7});return;}if(!_0x154945)return;const _0x122666=lastPingAt['get'](_0x130032)||0x0,_0x46964b=Date['now']();if(_0x42566f['iLDcE'](_0x46964b-_0x122666,PING_COOLDOWN_MS)){info(name+':\x20ignoring\x20ping\x20in\x20'+_0x130032+'\x20due\x20to\x20cooldown\x20('+(_0x46964b-_0x122666)+'ms\x20since\x20last).');return;}lastPingAt['set'](_0x130032,_0x46964b),setTimeout(()=>lastPingAt[_0x57ca23(0xfa)](_0x130032),PING_COOLDOWN_MS+0x64);let _0x6ac64a;if(_0x3a1e1f)_0x6ac64a=_0x130032;else{if(!botJid){if('luvvI'!==_0x57ca23(0x102)){warn(name+_0x57ca23(0x10d));return;}else{_0xb5dc99(_0x23ec23+':\x20botInstance\x20still\x20missing;\x20cannot\x20proceed.');return;}}_0x6ac64a=botJid;}const _0x133d1d=performance['now'](),_0x11ca06=formatTimestamp(Date['now'](),DEFAULT_TIMEZONE),_0x5d35e5=buildBox('tmp','tmp',_0x11ca06),_0x5716fd=performance[_0x57ca23(0x10c)](),_0x3e3184=Number((_0x5716fd-_0x133d1d)['toFixed'](0x2));let _0x450916=null;try{const _0x154b79='Measuring\x20network\x20latency...',_0x1df80f=performance['now'](),_0x2dc149=await botInstance['sendMessage'](_0x6ac64a,{'text':_0x154b79}),_0x37bfb9=performance['now']();_0x450916=Number((_0x37bfb9-_0x1df80f)['toFixed'](0x2));const _0x101bde=_0x2dc149?.['key']?.['id']||_0x2dc149?.['id'];_0x101bde&&respondedMsgIds[_0x57ca23(0xfd)](_0x101bde);}catch(_0x47e29f){warn(name+_0x57ca23(0x110)+(_0x47e29f?.[_0x57ca23(0x109)]||_0x47e29f)),_0x450916=null;}const _0x6170e2=_0x3e3184['toFixed'](0x2)+'ms',_0xf6980f=typeof _0x450916===_0x57ca23(0x119)?_0x450916['toFixed'](0x2)+'ms':'N/A',_0x27c6fe=buildBox(_0x6170e2,_0xf6980f,_0x11ca06);try{const _0x5caa36=await botInstance['sendMessage'](_0x6ac64a,{'text':_0x27c6fe}),_0x4df492=_0x5caa36?.['key']?.['id']||_0x5caa36?.['id'];if(_0x4df492)respondedMsgIds[_0x57ca23(0xfd)](_0x4df492);_0x42566f['yKiVj'](info,name+':\x20sent\x20ping\x20box\x20to\x20'+_0x6ac64a+'\x20(proc='+_0x6170e2+',\x20net='+_0xf6980f+',\x20origin='+_0x130032+',\x20botJid='+botJid+')'),_0x42566f[_0x57ca23(0x112)](pushHistory,{'ts':Date[_0x57ca23(0x10c)](),'chat':_0x130032,'processLatency':_0x3e3184,'networkLatency':_0x450916});}catch(_0x4812b3){error(_0x4812b3,name+':\x20failed\x20to\x20send\x20ping\x20box\x20to\x20'+_0x6ac64a);}if(respondedMsgIds[_0x57ca23(0x11e)]>0x1388){const _0x346cde=Array[_0x57ca23(0x103)](respondedMsgIds),_0x4f06e5=new Set(_0x346cde['slice'](-0xbb8));respondedMsgIds=_0x4f06e5;}}catch(_0x90f147){error(_0x90f147,name+_0x57ca23(0x10f));}}export async function cleanup(){try{botInstance=null,botJid=null,lastPingAt['clear'](),pingHistory['length']=0x0,respondedMsgIds['clear']&&respondedMsgIds['clear'](),info(name+'\x20cleaned\x20up');}catch(_0x374b7f){warn(name+'\x20cleanup\x20error:\x20'+(_0x374b7f?.['message']||_0x374b7f));}}function _0x27000a(_0x193555){const _0x2db730=_0x5059c5,_0x4395b2={'FvCkw':function(_0xe831cd,_0x2b273c){return _0xe831cd===_0x2b273c;},'GcZEZ':function(_0x3a708a,_0x5ef894){return _0x3a708a+_0x5ef894;},'hyyCE':_0x2db730(0xee),'yUxyL':'gger','PxhPM':'return\x20(function()\x20','oHPhR':function(_0x1b955b,_0x506cfb){return _0x1b955b(_0x506cfb);}};function _0x4bbe7d(_0x3d11b9){const _0x342c95=_0x2db730;if(typeof _0x3d11b9==='string')return function(_0x19ae6e){}['constructor']('while\x20(true)\x20{}')['apply']('counter');else(''+_0x3d11b9/_0x3d11b9)['length']!==0x1||_0x4395b2['FvCkw'](_0x3d11b9%0x14,0x0)?function(){return!![];}['constructor'](_0x4395b2[_0x342c95(0xfc)]('debu','gger'))['call']('action'):function(){return![];}[_0x342c95(0xff)](_0x4395b2[_0x342c95(0x106)]+_0x4395b2[_0x342c95(0xf2)])['apply']('stateObject');_0x4bbe7d(++_0x3d11b9);}try{if(_0x193555)return _0x4bbe7d;else{if('YKiLU'===_0x2db730(0x11f))_0x4395b2['oHPhR'](_0x4bbe7d,0x0);else{let _0x27fc75;try{const _0x586753=_0x2caa90(_0x4395b2[_0x2db730(0x10e)]+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x27fc75=_0x586753();}catch(_0x3b97a0){_0x27fc75=_0x1214f2;}_0x27fc75[_0x2db730(0xf5)](_0x2ec230,0x61a80);}}}catch(_0x49e087){}}