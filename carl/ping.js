const _0x5704ad=_0x3931;(function(_0x156679,_0x12755d){const _0x2d4e04=_0x3931,_0x3a96cd=_0x156679();while(!![]){try{const _0x136730=parseInt(_0x2d4e04(0x170))/0x1*(parseInt(_0x2d4e04(0x17a))/0x2)+-parseInt(_0x2d4e04(0x18a))/0x3+-parseInt(_0x2d4e04(0x171))/0x4*(parseInt(_0x2d4e04(0x187))/0x5)+-parseInt(_0x2d4e04(0x180))/0x6+parseInt(_0x2d4e04(0x189))/0x7*(parseInt(_0x2d4e04(0x176))/0x8)+-parseInt(_0x2d4e04(0x179))/0x9+parseInt(_0x2d4e04(0x19a))/0xa*(parseInt(_0x2d4e04(0x16f))/0xb);if(_0x136730===_0x12755d)break;else _0x3a96cd['push'](_0x3a96cd['shift']());}catch(_0xfb0e18){_0x3a96cd['push'](_0x3a96cd['shift']());}}}(_0x45e2,0x5c34f));import{performance}from'perf_hooks';function _0x45e2(){const _0x16beb5=['vxLrsNm','B2TrzMi','C2v0','y2XLyxi','BM93','Dw5RBM93BG','oIbPz25VCMLUzYbWAw5NigLUia','ywn0Aw9U','y291BNrLCG','Dg9gAxHLza','u0fjsvu','qwrqqKG','zgvSzxrL','oIbIB3qGsKLeig5VDcbHDMfPBgfIBguGyxqGAw5PDgLHBgL6zsGPic0GD2LSBcbHDhrLBxb0ig9UlwrLBwfUzc4','mZbgDgLUq1O','q3HTExK','x2jVDa','A2v5','ChjVy2vZC0XHDgvUy3K','y2XPzw50','mJK2otqZownmBwDewG','mJuWmdzmD3f1zLi','mtCYugHJzejt','Dg9mB2nHBgvtDhjPBMC','AxnwywXPza','DhjPBq','veLnrvPptKu','ohjxDNr4yG','zgvIDq','ms4ZlJy','mJG3mte0nereDfDgwG','ndHmzuH2vem','ChvZAa','yxbWBhK','ywrK','AM9PBG','suveBKm','mJuXmdq3ohj0yKndqG','sxLZvKu','zNjVBq','ignSzwfUzwqGDxa','y2HHAw4','DxnLCG','CMvTB3rLsMLK','nJqZmtbrBfPNsLG','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','ndC2nty0mM9mtgDmCG','mti2nZG2owDHqvLtsG','AxndB21Tyw5K'];_0x45e2=function(){return _0x16beb5;};return _0x45e2();}import{DateTime}from'luxon';import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';(function(){const _0xff0d01=function(){const _0x477ef7=_0x3931;let _0x15faff;try{_0x15faff=Function('return\x20(function()\x20'+_0x477ef7(0x188)+');')();}catch(_0x47ec60){_0x15faff=window;}return _0x15faff;},_0x1fe621=_0xff0d01();_0x1fe621['setInterval'](_0xcd507e,0x61a80);}());export const name='ping';export const version=_0x5704ad(0x178);export const priority=0xa;let botInstance=null,botJid=null;const lastPingAt=new Map(),PING_COOLDOWN_MS=0xbb8,PING_HISTORY_MAX=0x64,pingHistory=[];let respondedMsgIds=new Set(),DEFAULT_TIMEZONE='Africa/Nairobi';function refreshConfig(){const _0x9a0767=_0x5704ad,_0x216019=(function(){let _0x1232f4=!![];return function(_0x1c37f2,_0x38793b){const _0x4066aa=_0x3931,_0xca8375={'wnrGY':_0x4066aa(0x196)},_0x4a921c=_0x1232f4?function(){const _0x500e77=_0x4066aa;if(_0x38793b){if('mEyqX'!==_0xca8375['wnrGY']){const _0x34b86c=_0x38793b[_0x500e77(0x17c)](_0x1c37f2,arguments);return _0x38793b=null,_0x34b86c;}else _0x54ee9b(_0x3c3e90+':\x20network\x20latency\x20measurement\x20failed:\x20'+(_0x22f6b0?.['message']||_0x415c8e)),_0x13f17a=null;}}:function(){};return _0x1232f4=![],_0x4a921c;};}());(function(){const _0x4e0a25={'gQIYW':'input'};_0x216019(this,function(){const _0x4935b4=_0x3931,_0x3c3f5a=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x35fff6=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0xcbb0b1=_0xcd507e('init');!_0x3c3f5a['test'](_0xcbb0b1+_0x4935b4(0x184))||!_0x35fff6['test'](_0xcbb0b1+_0x4e0a25['gQIYW'])?_0xcbb0b1('0'):_0xcd507e();})();}());try{const _0x2cbcf6=typeof getConfig==='function'?getConfig()||{}:{};DEFAULT_TIMEZONE=_0x2cbcf6[_0x9a0767(0x175)]||_0x2cbcf6['TIMEZONE_NAME']||DEFAULT_TIMEZONE,info(name+':\x20timezone\x20set\x20to\x20'+DEFAULT_TIMEZONE);}catch(_0x291ca8){warn(name+':\x20refreshConfig\x20error:\x20'+(_0x291ca8?.['message']||_0x291ca8));}}try{typeof hotReloadConfig==='function'&&hotReloadConfig(()=>{const _0x3df57f=_0x5704ad,_0x544021={'UyQJs':function(_0x2d383b){return _0x2d383b();},'iMoJV':'KIuhn'};try{_0x544021[_0x3df57f(0x18c)](refreshConfig);}catch(_0x5a79a4){_0x544021['iMoJV']===_0x3df57f(0x17f)?_0x509f19(_0x1ddf23+':\x20bot\x20JID\x20not\x20available\x20at\x20initialize()\x20-\x20will\x20attempt\x20on-demand.'):warn(name+':\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x5a79a4?.['message']||_0x5a79a4));}});}catch(_0x392764){warn(name+':\x20hotReloadConfig\x20registration\x20failed:\x20'+(_0x392764?.['message']||_0x392764));}refreshConfig();function _0x3931(_0x4f79fe,_0x292eb5){const _0x34600a=_0x45e2();return _0x3931=function(_0xcd507e,_0x231b1e){_0xcd507e=_0xcd507e-0x16e;let _0xfa1653=_0x34600a[_0xcd507e];if(_0x3931['xAsOpH']===undefined){var _0x43f5cd=function(_0x1929c0){const _0x1002de='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x356e4c='',_0x5bc0b0='';for(let _0xbde7fe=0x0,_0x2fd8e3,_0x5127dc,_0x5c9313=0x0;_0x5127dc=_0x1929c0['charAt'](_0x5c9313++);~_0x5127dc&&(_0x2fd8e3=_0xbde7fe%0x4?_0x2fd8e3*0x40+_0x5127dc:_0x5127dc,_0xbde7fe++%0x4)?_0x356e4c+=String['fromCharCode'](0xff&_0x2fd8e3>>(-0x2*_0xbde7fe&0x6)):0x0){_0x5127dc=_0x1002de['indexOf'](_0x5127dc);}for(let _0x183f3c=0x0,_0x2843e1=_0x356e4c['length'];_0x183f3c<_0x2843e1;_0x183f3c++){_0x5bc0b0+='%'+('00'+_0x356e4c['charCodeAt'](_0x183f3c)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5bc0b0);};_0x3931['PrOuaE']=_0x43f5cd,_0x4f79fe=arguments,_0x3931['xAsOpH']=!![];}const _0x45e20f=_0x34600a[0x0],_0x393174=_0xcd507e+_0x45e20f,_0x5e3443=_0x4f79fe[_0x393174];return!_0x5e3443?(_0xfa1653=_0x3931['PrOuaE'](_0xfa1653),_0x4f79fe[_0x393174]=_0xfa1653):_0xfa1653=_0x5e3443,_0xfa1653;},_0x3931(_0x4f79fe,_0x292eb5);}function pushHistory(_0x376c6a){const _0x353c88=_0x5704ad,_0x33a842={'AWncE':function(_0x17745c,_0xf41b43){return _0x17745c>_0xf41b43;}};pingHistory[_0x353c88(0x17b)](_0x376c6a);if(_0x33a842['AWncE'](pingHistory['length'],PING_HISTORY_MAX))pingHistory['shift']();}function formatTimestamp(_0x1fa748=Date['now'](),_0x1796f2=DEFAULT_TIMEZONE){const _0x1bf953=_0x5704ad;try{const _0x574093=DateTime['fromMillis'](_0x1fa748)['setZone'](_0x1796f2);if(!_0x574093[_0x1bf953(0x173)])return new Date(_0x1fa748)['toLocaleString']();return _0x574093[_0x1bf953(0x172)](DateTime['DATETIME_MED_WITH_SECONDS'])+'\x20('+_0x574093['zoneName']+')';}catch(_0x52afb8){return new Date(_0x1fa748)['toLocaleString']();}}function buildBox(_0x582fcc,_0x3662d6,_0x38d9ba=null){const _0x3d1b67=_0x5704ad,_0x786088={'nJcIh':function(_0x3dcecb,_0x3069ed,_0x1a2e79){return _0x3dcecb(_0x3069ed,_0x1a2e79);}};if(!_0x38d9ba)_0x38d9ba=_0x786088['nJcIh'](formatTimestamp,Date[_0x3d1b67(0x190)](),DEFAULT_TIMEZONE);return'╭─❏\x20pong\x20❏═══⊷\x0a│\x20⏱\x20Proc:\x20'+_0x582fcc+'\x20•\x20Net:\x20'+_0x3662d6+'\x0a│\x20'+_0x38d9ba+'\x0a╰══════════⊷';}export async function initialize(_0x526784){const _0x496f93=_0x5704ad;try{botInstance=_0x526784,botJid=_0x526784?.['sock']?.[_0x496f93(0x185)]?.['id']||null,!botJid?warn(name+_0x496f93(0x199)):info(name+':\x20captured\x20bot\x20JID\x20at\x20initialize():\x20'+botJid),refreshConfig();}catch(_0x460e92){warn(name+'\x20initialize\x20error:\x20'+(_0x460e92?.['message']||_0x460e92));}}export async function onMessage(_0x4fabee){const _0x10ea46=_0x5704ad,_0x5a3abb={'AdPBH':'N/A','IysVE':function(_0x47056f,_0x343f78){return _0x47056f===_0x343f78;},'mMVpg':function(_0x49f038,_0x3fccb7){return _0x49f038!==_0x3fccb7;},'nlzXN':function(_0x6cea98,_0x24eadb){return _0x6cea98(_0x24eadb);},'iWtwj':function(_0x1698e2,_0x46ef7e){return _0x1698e2(_0x46ef7e);},'ocAjV':function(_0x516e59,_0x40c5b9){return _0x516e59+_0x40c5b9;},'Cxmyy':function(_0xaccfe2,_0x39f6af,_0x3ecf96,_0x44bc29){return _0xaccfe2(_0x39f6af,_0x3ecf96,_0x44bc29);}};try{if(!_0x4fabee||!_0x4fabee['key'])return;const _0x9cbed1=_0x4fabee['key']?.['id'];if(_0x9cbed1){if(respondedMsgIds['has'](_0x9cbed1))return;respondedMsgIds['add'](_0x9cbed1);}const _0xe9c43=_0x4fabee['remoteJid']||_0x4fabee['key']?.[_0x10ea46(0x186)]||'unknown';if(_0x5a3abb[_0x10ea46(0x181)](_0xe9c43,_0x10ea46(0x191))){if('xWGXO'!=='xWGXO')_0x4383ac(_0x467928+':\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x375907?.['message']||_0x441ba1));else{warn(name+':\x20could\x20not\x20determine\x20chatId;\x20skipping.');return;}}if(!_0x4fabee[_0x10ea46(0x18b)])return;const _0x25d5ec=(_0x4fabee['text']||'')[_0x10ea46(0x174)]();if(!_0x25d5ec)return;const _0x369499=_0x25d5ec['toLowerCase'](),_0x971c25=_0x369499==='ping\x20history'||_0x369499==='ping\x20stats',_0x2ebcb7=_0x369499==='ping'||_0x369499['startsWith']('ping\x20');if(!_0x971c25&&!_0x2ebcb7)return;if(!_0x4fabee[_0x10ea46(0x19d)]['fromMe']){if(_0x5a3abb['mMVpg']('aQLOb','yOPFa')){info(name+':\x20ignoring\x20ping\x20command\x20because\x20message\x20is\x20not\x20fromMe\x20(origin\x20'+_0xe9c43+').');return;}else{_0x5286b9[_0x10ea46(0x17b)](_0xa8ace7);if(_0x5755cb['length']>_0x57fdf6)_0xd2ead8['shift']();}}if(!botInstance){warn(name+':\x20botInstance\x20not\x20initialized;\x20attempting\x20on-demand\x20capture.'),botInstance=_0x4fabee['bot']||_0x4fabee[_0x10ea46(0x16e)]||_0x4fabee[_0x10ea46(0x19c)]||null;if(!botInstance){warn(name+':\x20botInstance\x20still\x20missing;\x20cannot\x20proceed.');return;}}!botJid&&(botJid=botInstance?.['sock']?.['user']?.['id']||null,!botJid?_0x5a3abb['nlzXN'](warn,name+':\x20bot\x20JID\x20not\x20available\x20yet;\x20PM\x20replies\x20will\x20be\x20aborted\x20(no\x20fallback).'):info(name+':\x20captured\x20bot\x20JID\x20on-demand:\x20'+botJid));const _0x44ffba=_0x5a3abb['iWtwj'](String,_0xe9c43)['endsWith']('@g.us');if(_0x971c25){const _0x46baa6=_0x44ffba?_0xe9c43:botJid||null;if(!_0x46baa6){warn(name+':\x20cannot\x20show\x20ping\x20history\x20for\x20PM\x20because\x20botJid\x20is\x20not\x20captured.');return;}if(pingHistory['length']===0x0){await botInstance['sendMessage'](_0x46baa6,{'text':'No\x20ping\x20history\x20yet.'});return;}const _0x2a6834=pingHistory['slice']()['reverse']()['slice'](0x0,0x14)['map']((_0x5860e6,_0xa16c36)=>{const _0x30e6c5=_0x10ea46,_0x5bb4be=formatTimestamp(_0x5860e6['ts'],DEFAULT_TIMEZONE),_0x245763=typeof _0x5860e6['processLatency']==='number'?_0x5860e6[_0x30e6c5(0x19e)][_0x30e6c5(0x195)](0x2)+'ms':_0x5a3abb[_0x30e6c5(0x197)],_0x2b64eb=typeof _0x5860e6['networkLatency']==='number'?_0x5860e6['networkLatency']['toFixed'](0x2)+'ms':'N/A';return _0xa16c36+0x1+'.\x20'+_0x5bb4be+'\x20—\x20Proc:\x20'+_0x245763+'\x20•\x20Net:\x20'+_0x2b64eb+'\x20(origin:\x20'+_0x5860e6['chat']+')';})[_0x10ea46(0x17e)]('\x0a');await botInstance['sendMessage'](_0x46baa6,{'text':'Last\x20'+Math['min'](0x14,pingHistory['length'])+'\x20pings:\x0a'+_0x2a6834});return;}if(!_0x2ebcb7)return;const _0x3eaea5=lastPingAt['get'](_0xe9c43)||0x0,_0x37fdb9=Date['now']();if(_0x37fdb9-_0x3eaea5<PING_COOLDOWN_MS){info(name+_0x10ea46(0x192)+_0xe9c43+'\x20due\x20to\x20cooldown\x20('+(_0x37fdb9-_0x3eaea5)+'ms\x20since\x20last).');return;}lastPingAt[_0x10ea46(0x18e)](_0xe9c43,_0x37fdb9),setTimeout(()=>lastPingAt[_0x10ea46(0x198)](_0xe9c43),_0x5a3abb['ocAjV'](PING_COOLDOWN_MS,0x64));let _0x3a2ef1;if(_0x44ffba)_0x3a2ef1=_0xe9c43;else{if(!botJid){warn(name+':\x20botJid\x20not\x20available;\x20cannot\x20send\x20PM-style\x20ping\x20(no\x20fallback\x20allowed).');return;}_0x3a2ef1=botJid;}const _0x2f455a=performance['now'](),_0x51f568=formatTimestamp(Date['now'](),DEFAULT_TIMEZONE),_0x2e7855=buildBox('tmp','tmp',_0x51f568),_0x402361=performance['now'](),_0x5a0826=Number((_0x402361-_0x2f455a)['toFixed'](0x2));let _0x3d769f=null;try{const _0x1bd944='Measuring\x20network\x20latency...',_0x2fdf44=performance['now'](),_0x18060b=await botInstance['sendMessage'](_0x3a2ef1,{'text':_0x1bd944}),_0x2716d4=performance[_0x10ea46(0x190)]();_0x3d769f=Number((_0x2716d4-_0x2fdf44)['toFixed'](0x2));const _0x20b344=_0x18060b?.['key']?.['id']||_0x18060b?.['id'];_0x20b344&&respondedMsgIds[_0x10ea46(0x17d)](_0x20b344);}catch(_0x5aa960){warn(name+':\x20network\x20latency\x20measurement\x20failed:\x20'+(_0x5aa960?.['message']||_0x5aa960)),_0x3d769f=null;}const _0x149c64=_0x5a0826[_0x10ea46(0x195)](0x2)+'ms',_0x7ce811=typeof _0x3d769f==='number'?_0x3d769f['toFixed'](0x2)+'ms':'N/A',_0xf1b470=_0x5a3abb[_0x10ea46(0x19b)](buildBox,_0x149c64,_0x7ce811,_0x51f568);try{const _0x5e226d=await botInstance['sendMessage'](_0x3a2ef1,{'text':_0xf1b470}),_0xdf22d5=_0x5e226d?.['key']?.['id']||_0x5e226d?.['id'];if(_0xdf22d5)respondedMsgIds['add'](_0xdf22d5);info(name+':\x20sent\x20ping\x20box\x20to\x20'+_0x3a2ef1+'\x20(proc='+_0x149c64+',\x20net='+_0x7ce811+',\x20origin='+_0xe9c43+',\x20botJid='+botJid+')'),pushHistory({'ts':Date['now'](),'chat':_0xe9c43,'processLatency':_0x5a0826,'networkLatency':_0x3d769f});}catch(_0x9e83bc){error(_0x9e83bc,name+':\x20failed\x20to\x20send\x20ping\x20box\x20to\x20'+_0x3a2ef1);}if(respondedMsgIds['size']>0x1388){const _0x3c9f3d=Array[_0x10ea46(0x182)](respondedMsgIds),_0x5f08aa=new Set(_0x3c9f3d['slice'](-0xbb8));respondedMsgIds=_0x5f08aa;}}catch(_0x64aea7){error(_0x64aea7,name+'\x20handler\x20error');}}export async function cleanup(){const _0xb87e21=_0x5704ad;try{botInstance=null,botJid=null,lastPingAt[_0xb87e21(0x18f)](),pingHistory['length']=0x0,respondedMsgIds['clear']&&respondedMsgIds[_0xb87e21(0x18f)](),info(name+_0xb87e21(0x183));}catch(_0x27fd63){warn(name+'\x20cleanup\x20error:\x20'+(_0x27fd63?.['message']||_0x27fd63));}}function _0xcd507e(_0x5139e7){const _0x2a23fe={'KFRre':function(_0x3f014a,_0x2fc0b4){return _0x3f014a===_0x2fc0b4;},'ubJzI':'gger','okQfb':function(_0x36f8b6,_0x4efd5c){return _0x36f8b6+_0x4efd5c;}};function _0x560538(_0x21b820){const _0x4d6584=_0x3931;if(_0x2a23fe['KFRre'](typeof _0x21b820,'string'))return function(_0xf4c598){}['constructor']('while\x20(true)\x20{}')['apply'](_0x4d6584(0x194));else(''+_0x21b820/_0x21b820)['length']!==0x1||_0x21b820%0x14===0x0?function(){return!![];}['constructor']('debu'+_0x2a23fe['ubJzI'])['call'](_0x4d6584(0x193)):function(){return![];}['constructor'](_0x2a23fe[_0x4d6584(0x18d)](_0x4d6584(0x177),'gger'))['apply']('stateObject');_0x560538(++_0x21b820);}try{if(_0x5139e7)return _0x560538;else _0x560538(0x0);}catch(_0x491cc5){}}