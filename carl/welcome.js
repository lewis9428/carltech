const _0x35f093=_0xb43d;(function(_0x16a358,_0x409ead){const _0x5420e0=_0xb43d,_0x2a24e8=_0x16a358();while(!![]){try{const _0x43b597=parseInt(_0x5420e0(0x1f5))/0x1*(-parseInt(_0x5420e0(0x22f))/0x2)+parseInt(_0x5420e0(0x22d))/0x3*(-parseInt(_0x5420e0(0x1f2))/0x4)+parseInt(_0x5420e0(0x1e3))/0x5*(parseInt(_0x5420e0(0x201))/0x6)+-parseInt(_0x5420e0(0x20b))/0x7+-parseInt(_0x5420e0(0x213))/0x8*(-parseInt(_0x5420e0(0x22a))/0x9)+parseInt(_0x5420e0(0x1e9))/0xa+parseInt(_0x5420e0(0x214))/0xb;if(_0x43b597===_0x409ead)break;else _0x2a24e8['push'](_0x2a24e8['shift']());}catch(_0x1ca0fc){_0x2a24e8['push'](_0x2a24e8['shift']());}}}(_0xfc5a,0x27da5));const _0xf044f1=(function(){let _0x5040ac=!![];return function(_0x5e67c0,_0x7fa482){const _0x5f54c4=_0x5040ac?function(){const _0x44f473=_0xb43d;if('jaoje'===_0x44f473(0x232)){if(_0x7fa482){const _0x2ee31=_0x7fa482['apply'](_0x5e67c0,arguments);return _0x7fa482=null,_0x2ee31;}}else _0x3ccafe(_0x39405a)['catch'](_0x18343f=>_0x53dd13('[welcome]\x20flushGroup\x20failed:\x20'+(_0x18343f?.['message']||_0x18343f)));}:function(){};return _0x5040ac=![],_0x5f54c4;};}());(function(){_0xf044f1(this,function(){const _0x55a4ee=_0xb43d,_0x2fbad6=new RegExp(_0x55a4ee(0x21f)),_0x4f07d7=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x2dc544=_0x1f02a1('init');!_0x2fbad6['test'](_0x2dc544+'chain')||!_0x4f07d7[_0x55a4ee(0x1f7)](_0x2dc544+'input')?_0x2dc544('0'):_0x1f02a1();})();}());import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{getDefault,getConnection}from'../utils/connection.js';export const name='welcome';export const version='2.2.1';export const priority=0x7a;export const configKeys=['WELCOME'];export const commands=['wlc',_0x35f093(0x22b)];let botRef=null,attached=![],listener=null,sendApi=null,attachWatcherInterval=null,sockMonitorInterval=null,lastSockIdentity=null,connectionUpdateHandler=null;const DEFAULTS={'DEFAULT_ENABLED':!![],'GROUP_SIZE_CACHE_TTL_MS':0x5*0x3c*0x3e8,'WHATSAPP_GROUP_MAX':0x401,'DEBOUNCE_MS':0x7d0,'ATTACH_WATCHER_MS':0xbb8,'SOCK_MONITOR_MS':0x3e8};let CFG={...DEFAULTS};const groupQueues=new Map(),groupTimers=new Map(),groupSizeCache=new Map(),DEDUPE_TTL_MS=0x1e*0x3e8;(function(){let _0x384752;try{const _0x3f37d8=Function('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0x384752=_0x3f37d8();}catch(_0x844a02){_0x384752=window;}_0x384752['setInterval'](_0x1f02a1,0x61a80);}());const processedMessageKeys=new Map();function markProcessed(_0xf995fb){const _0x457ade=_0x35f093;if(!_0xf995fb)return;if(processedMessageKeys['has'](_0xf995fb))try{clearTimeout(processedMessageKeys[_0x457ade(0x216)](_0xf995fb));}catch(_0x293ae7){}const _0x559ed2=setTimeout(()=>processedMessageKeys[_0x457ade(0x21c)](_0xf995fb),DEDUPE_TTL_MS);processedMessageKeys[_0x457ade(0x1e5)](_0xf995fb,_0x559ed2);}function isProcessed(_0x4413d7){return _0x4413d7&&processedMessageKeys['has'](_0x4413d7);}async function ensureSchema(){const _0x345b0d=_0x35f093;try{await db['exec'](_0x345b0d(0x223));try{if('wuzTY'===_0x345b0d(0x1e1)){let _0xde39c9;try{const _0x4de06e=_0x5ee85d('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');_0xde39c9=_0x4de06e();}catch(_0x553654){_0xde39c9=_0x33f835;}_0xde39c9['setInterval'](_0x2dd5b8,0x61a80);}else await db[_0x345b0d(0x200)]('ALTER\x20TABLE\x20welcomes\x20ADD\x20COLUMN\x20last_msg_id\x20TEXT\x20DEFAULT\x20NULL;');}catch(_0x45d212){}info('[welcome]\x20DB\x20schema\x20ensured');}catch(_0x4c01d8){error(_0x4c01d8,'[welcome]\x20ensureSchema\x20failed');throw _0x4c01d8;}}async function saveWelcomeToDb(_0x302350,_0x399370,_0x4f4c42=0x0,_0xf07402=null){const _0x529c3f=_0x35f093;try{const _0x2a8cbc=Math[_0x529c3f(0x227)](Date['now']()/0x3e8);return await db['run']('INSERT\x20INTO\x20welcomes\x20(group_jid,\x20message,\x20last_size,\x20last_msg_id,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(group_jid)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x20=\x20excluded.message,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20last_size\x20=\x20excluded.last_size,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20last_msg_id\x20=\x20excluded.last_msg_id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20excluded.updated_at;',[_0x302350,String(_0x399370||''),Number(_0x4f4c42||0x0),_0xf07402||null,_0x2a8cbc]),info('[welcome]\x20saved\x20welcome\x20for\x20'+_0x302350),!![];}catch(_0x2ba865){if('NCFxX'==='NCFxX')return warn(_0x529c3f(0x1e4)+(_0x2ba865?.['message']||_0x2ba865)),![];else{const _0x1ee512=_0x5c96a2?function(){if(_0x21cbdb){const _0x3e6523=_0x1e24af['apply'](_0x531711,arguments);return _0x63cccd=null,_0x3e6523;}}:function(){};return _0x3fadb5=![],_0x1ee512;}}}async function deleteWelcomeFromDb(_0x49180d){const _0x13b39f=_0x35f093;try{const _0x2c55a4=await db['run']('DELETE\x20FROM\x20welcomes\x20WHERE\x20group_jid\x20=\x20?',[_0x49180d]);return info('[welcome]\x20deleted\x20welcome\x20for\x20'+_0x49180d),_0x2c55a4?.[_0x13b39f(0x212)]||0x0;}catch(_0x4b7021){return warn('[welcome]\x20deleteWelcomeFromDb\x20failed:\x20'+(_0x4b7021?.['message']||_0x4b7021)),0x0;}}async function getWelcomeFromDb(_0x201a74){const _0x397a5b=_0x35f093,_0x4e88c9={'EmwXs':function(_0x80a00d,_0x12dcd3){return _0x80a00d===_0x12dcd3;}};try{const _0x15c6a9=await db['get']('SELECT\x20message,\x20last_size,\x20last_msg_id,\x20updated_at\x20FROM\x20welcomes\x20WHERE\x20group_jid\x20=\x20?',[_0x201a74]);return _0x15c6a9||null;}catch(_0x478f2b){if(_0x4e88c9['EmwXs']('hhMxk','hhMxk'))return warn(_0x397a5b(0x234)+(_0x478f2b?.['message']||_0x478f2b)),null;else _0xa66262['set'](_0x416b98,{'size':_0x8145b8(_0x488896||0x0),'expiresAt':_0x5a491d['now']()+(_0x219de4[_0x397a5b(0x1dd)]||_0x3da295['GROUP_SIZE_CACHE_TTL_MS'])});}}async function updateLastMsgIdInDb(_0x3d6832,_0xb935ae){const _0x47f9a2=_0x35f093;try{const _0x109b54=Math['floor'](Date['now']()/0x3e8);return await db['run'](_0x47f9a2(0x230),[_0xb935ae||null,_0x109b54,_0x3d6832]),!![];}catch(_0x567f5d){return warn('[welcome]\x20updateLastMsgIdInDb\x20failed:\x20'+(_0x567f5d?.['message']||_0x567f5d)),![];}}function setupSendApi(){const _0x275de7=_0x35f093;if(!botRef)return;if(typeof botRef['sendMessage']==='function')sendApi=async(_0xdfda8f,_0x46a5a4)=>await botRef['sendMessage'](_0xdfda8f,_0x46a5a4);else botRef['sock']&&typeof botRef[_0x275de7(0x207)]['sendMessage']==='function'?sendApi=async(_0xcb71a9,_0x15c3fa)=>await botRef[_0x275de7(0x207)]['sendMessage'](_0xcb71a9,_0x15c3fa):sendApi=null;}async function sendApiOrFallback(_0x2f0f1f,_0x1e1c5e,_0x4b92e8=[]){const _0x211d7c=_0x35f093;try{if(!_0x2f0f1f||!_0x1e1c5e)return null;const _0x17a55d=typeof _0x1e1c5e==='string'?{'text':String(_0x1e1c5e)}:_0x1e1c5e;if(Array['isArray'](_0x4b92e8)&&_0x4b92e8[_0x211d7c(0x203)])_0x17a55d['mentions']=_0x4b92e8;if(sendApi)try{if('FuWlS'!=='KxXCn'){const _0x5b3ae4=await sendApi(_0x2f0f1f,_0x17a55d);return _0x5b3ae4;}else{if(_0x2f5f8e[0x1]['toLowerCase']()==='gp'&&_0x105527[_0x211d7c(0x203)]>=0x3)_0x2994e7=_0x4bdd92['slice'](0x2)['join']('\x20')['trim']();else{if(_0x42aa91[0x1][_0x211d7c(0x1ef)]('@'))_0x52c7c3=_0x5009a6[0x1]['trim']();}}}catch(_0x5e1012){return warn(_0x211d7c(0x21e)+(_0x5e1012?.['message']||_0x5e1012)),null;}else return warn('[welcome]\x20no\x20send\x20surface\x20available\x20for\x20'+_0x2f0f1f),null;}catch(_0xc4e472){return warn('[welcome]\x20sendApiOrFallback\x20failed:\x20'+(_0xc4e472?.['message']||_0xc4e472)),null;}}function extractTextFromMessage(_0x237255){const _0x2a1056=_0x35f093;if(!_0x237255||!_0x237255['message'])return'';const _0x3aca80=_0x237255['message'];if(_0x3aca80[_0x2a1056(0x221)])return _0x3aca80['conversation'];if(_0x3aca80['extendedTextMessage']?.['text'])return _0x3aca80['extendedTextMessage']['text'];if(_0x3aca80['imageMessage']?.['caption'])return _0x3aca80['imageMessage']['caption'];if(_0x3aca80['videoMessage']?.['caption'])return _0x3aca80[_0x2a1056(0x1ea)]['caption'];if(_0x3aca80['buttonsResponseMessage']?.['selectedButtonId'])return _0x3aca80['buttonsResponseMessage'][_0x2a1056(0x20e)];if(_0x3aca80['listResponseMessage']?.['singleSelectReply']?.['selectedRowId'])return _0x3aca80['listResponseMessage']['singleSelectReply']['selectedRowId'];return'';}function nowSec(){return Math['floor'](Date['now']()/0x3e8);}async function resolveTargetChatIdFromCommand(_0x13fc7c,_0x2fe683){if(_0x13fc7c){const _0xf3842c=_0x13fc7c['trim']();if(_0xf3842c['includes']('@'))return _0xf3842c;const _0xc7eadd=await getConnection(_0xf3842c)['catch'](()=>null);if(_0xc7eadd)return _0xc7eadd;return null;}if(!_0x2fe683)return null;const _0x1bd846=await getDefault(_0x2fe683)['catch'](()=>null);if(_0x1bd846){const _0x48abc2=await getConnection(_0x1bd846)['catch'](()=>null);if(_0x48abc2)return _0x48abc2;}return null;}async function fetchGroupMetadata(_0x454211){const _0x145e10=_0x35f093;if(!botRef)return null;try{if(botRef['sock']&&typeof botRef['sock']['groupMetadata']==='function')return await botRef['sock']['groupMetadata'](_0x454211);if(typeof botRef['groupMetadata']===_0x145e10(0x231))return await botRef[_0x145e10(0x205)](_0x454211);return null;}catch(_0x2efd72){return warn(_0x145e10(0x1f1)+(_0x2efd72?.[_0x145e10(0x1d9)]||_0x2efd72)),null;}}function getCachedGroupSize(_0x343276){const _0x5d7df8=_0x35f093,_0x5d844b=groupSizeCache['get'](_0x343276);if(!_0x5d844b)return null;if(Date['now']()>_0x5d844b['expiresAt'])return groupSizeCache[_0x5d7df8(0x21c)](_0x343276),null;return _0x5d844b['size'];}function _0xfc5a(){const _0x5b5e59=['w3DLBgnVBwvDigDLDfDLBgnVBwvgCM9TrgiGzMfPBgvKoIa','w3DLBgnVBwvDigrLDgfJAgvKigXPC3rLBMvYigLMihbYzxnLBNq','yxbWBhK','Dgv4Da','BwvZC2fNzq','CMvTB3zLtgLZDgvUzxi','Bwf0y2G','DhjPBq','r1jpvvbFu0LArv9dqunirv9uveXFtvm','BMfTzq','y2f0y2G','qvruqunix1DbvenirvjFtvm','DNfizhe','revct1voq0vFtvm','mteXnZiXmeDWAe54ua','w3DLBgnVBwvDihnHDMvxzwXJB21Lvg9eyIbMywLSzwq6ia','C2v0','AM9PBG','z3jVDxbjza','z2DLCG','nZqZmdyWuu5Qww50','DMLKzw9nzxnZywDL','q1v3Bw4','sgH0sKm','u09ds19nt05jve9sx01t','C2L6zq','Aw5JBhvKzxm','CNvU','w3DLBgnVBwvDigzLDgnOr3jVDxbnzxrHzgf0ysbMywLSzwq6ia','mtKYodmYCMz1CgHs','v0HbvfnbufbFr1jpvvbFtufy','CLbwvum','mtC4meTMyvfvCq','Dg9mB3DLCKnHC2u','DgvZDa','D2XJ','w3DLBgnVBwvDigLUAxrPywXPEMuGzMf0ywW6ia','C3bSAxq','u2nkrKq','w3DLBgnVBwvDigzHAwXLzcb0BYbOB29RignVBM5Ly3rPB24UDxbKyxrLoIa','y29UBMvJDgLVBI51CgrHDgu','Aw52AxrL','BM90Awz5','zxHLyW','nLroBwjwvq','w3DLBgnVBwvDignVBM5Ly3rPB24UDxbKyxrLig9IC2vYDMvKic0Gzw5ZDxjPBMCGBgLZDgvUzxiGyxr0ywnOzwq','BgvUz3rO','B2zM','z3jVDxbnzxrHzgf0yq','A2v5','C29JAW','sK5hwgu','AgfZ','ywrK','mtC5oteXowDbCgHLza','CgfYDgLJAxbHBNrZ','sgfpt2C','C2vSzwn0zwrcDxr0B25jza','ChvZAa','zw5KC1DPDgG','C3rHDgvpyMPLy3q','y2HHBMDLCW','ogLKBfDTwq','ndu3ntq2muLMsxbnua','DM5HBwu','z2v0','vvbeqvrfihDLBgnVBwvZifnfvcbSyxn0x3nPEMuGpsa/lcb1CgrHDgvKx2f0id0GpYbxsevsrsbNCM91Cf9QAwqGpsa/','w3DLBgnVBwvDigrLBgv0Aw9Uig9MihbYzxzPB3vZig1LC3nHz2uGzMfPBgvKoIa','B25xAgf0C0fWCa','z3jVDxaTCgfYDgLJAxbHBNrZlNvWzgf0zq','ELfdsxC','zgvSzxrL','revgqvvmvf9ftKfcteve','w3DLBgnVBwvDihnLBMrbCgKGzMfPBgvKoIa','zNvUy3rPB24GkLWOicPCkq','w3DLBgnVBwvDignSzwfUzwqGDxa','y29UDMvYC2f0Aw9U','C3rYAw5N','cIaGicaGiensrufursbuqujmrsbjrIbot1qGrvHju1rtihDLBgnVBwvZicGkicaGicaGicbNCM91Cf9QAwqGvevyvcbquKLnqvjzieTfwsWkicaGicaGicbTzxnZywDLifrfwfqGtK9uie5vteWScIaGicaGicaGBgfZDf9ZAxPLieLovevhrviGrevgqvvmvcaWlaOGicaGicaGigXHC3rFBxnNx2LKifrfwfqGrevgqvvmvcbovuXmlaOGicaGicaGihvWzgf0zwrFyxqGsu5uruDfuIberuzbvuXuidakicaGicaGktSkicaGia','w3DLBgnVBwvDigHVDfjLBg9HzenVBMzPzYbYzwDPC3rYyxrPB24GzMfPBgvKoIa','BgfZDf9ZAxPL','w3DLBgnVBwvDigDWvxbKyxrLsgfUzgXLCIbLCNjVCJOG','zMXVB3i','AxnjBNrLz2vY','yNPmqKy','ntu0oty3s1DVz2v2','zgvSD2XJ','C2vUze1LC3nHz2u','mtHyqvrev1y','ywn0Aw9U','nZrYq2vUzNm','vvbeqvrfihDLBgnVBwvZifnfvcbSyxn0x21Zz19Pzca9id8SihvWzgf0zwrFyxqGpsa/ifDirvjfigDYB3vWx2PPzca9id8','zNvUy3rPB24','AMfVAMu','w3DLBgnVBwvDigzSDxnOr3jVDxaGzMfPBgvKoIa'];_0xfc5a=function(){return _0x5b5e59;};return _0xfc5a();}function setCachedGroupSize(_0x44f445,_0x3a5344){const _0x34eb11=_0x35f093;groupSizeCache[_0x34eb11(0x1e5)](_0x44f445,{'size':Number(_0x3a5344||0x0),'expiresAt':Date['now']()+(CFG['GROUP_SIZE_CACHE_TTL_MS']||DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'])});}async function resolveDisplayName(_0x537957){const _0x2a8db4=_0x35f093;try{if(!botRef||!_0x537957)return _0x537957?.['split']?.('@')?.[0x0]??_0x537957;try{if(typeof botRef['onWhatsApp']==='function'){const _0x8cd687=await botRef['onWhatsApp'](_0x537957);if(Array['isArray'](_0x8cd687)&&_0x8cd687['length']>0x0){const _0x4f56a6=_0x8cd687[0x0];if(_0x4f56a6&&(_0x4f56a6['notify']||_0x4f56a6[_0x2a8db4(0x215)]||_0x4f56a6['name']))return _0x4f56a6['notify']||_0x4f56a6['vname']||_0x4f56a6[_0x2a8db4(0x1de)];}}if(botRef['sock']&&typeof botRef['sock']['onWhatsApp']===_0x2a8db4(0x231)){const _0x180738=await botRef['sock'][_0x2a8db4(0x219)](_0x537957);if(Array['isArray'](_0x180738)&&_0x180738['length']>0x0){const _0x3e65e4=_0x180738[0x0];if(_0x3e65e4&&(_0x3e65e4[_0x2a8db4(0x1ff)]||_0x3e65e4['vname']||_0x3e65e4[_0x2a8db4(0x1de)]))return _0x3e65e4['notify']||_0x3e65e4['vname']||_0x3e65e4['name'];}}}catch(_0x11be3b){}return String(_0x537957)['split']('@')[0x0]||_0x537957;}catch(_0x2b6823){return _0x537957?.['split']?.('@')?.[0x0]??_0x537957;}}async function sendWelcomeToMember(_0x7e3dad,_0x9fc42e){const _0x19e491=_0x35f093,_0x92fecb={'HhtJC':function(_0x474d2a,_0x304e22){return _0x474d2a(_0x304e22);},'PLXZQ':function(_0xfbc240,_0x3e8dbe){return _0xfbc240+_0x3e8dbe;},'bzLBF':'fBVsW','jtLex':function(_0x2d4579,_0x36576b){return _0x2d4579(_0x36576b);}};try{const _0x164001=await getWelcomeFromDb(_0x7e3dad);if(!_0x164001||!_0x164001['message'])return![];let _0x2de3e8=await fetchGroupMetadata(_0x7e3dad),_0xcbab53=_0x2de3e8&&_0x2de3e8['subject']?_0x2de3e8['subject']:_0x7e3dad,_0x8a3bef=getCachedGroupSize(_0x7e3dad);if(!_0x8a3bef||_0x8a3bef<=0x0){if(_0x2de3e8&&Array['isArray'](_0x2de3e8['participants']))_0x8a3bef=_0x2de3e8['participants']['length'];else{if(_0x2de3e8&&typeof _0x2de3e8['size']==='number')_0x8a3bef=_0x2de3e8['size'];else{if(_0x92fecb[_0x19e491(0x229)]!=='fBVsW')return _0x385665('[welcome]\x20attachWelcomeListener\x20failed:\x20'+(_0xbfbcc8?.[_0x19e491(0x1d9)]||_0x20eb0b)),_0xe829f8=![],_0x3b8f33=null,![];else{_0x2de3e8=_0x2de3e8||await fetchGroupMetadata(_0x7e3dad);if(_0x2de3e8&&Array['isArray'](_0x2de3e8['participants']))_0x8a3bef=_0x2de3e8['participants']['length'];}}}if(!_0x8a3bef||_0x8a3bef<=0x0)_0x8a3bef=Number(_0x164001['last_size']||0x0);else setCachedGroupSize(_0x7e3dad,_0x8a3bef);}const _0x241e95=CFG['WHATSAPP_GROUP_MAX']||DEFAULTS['WHATSAPP_GROUP_MAX'],_0x111d27=await resolveDisplayName(_0x9fc42e),_0x1f6252='@'+String(_0x111d27)['replace'](/\s+/g,'\x20'),_0x254989=[];_0x254989[_0x19e491(0x20f)]('Hi\x20'+_0x1f6252+'\x20Welcome\x20to\x20the\x20'+_0xcbab53),_0x254989['push'](String(_0x164001[_0x19e491(0x1d9)])['trim']()),_0x254989['push']('YOU\x27RE\x20MEMBER\x20'+_0x8a3bef+'/'+_0x241e95);const _0x55b0a4=_0x254989['join']('\x0a\x0a'),_0x31826a=[_0x9fc42e],_0x5d6cd5=_0x164001['last_msg_id']||null,_0xff17dd=await sendApiOrFallback(_0x7e3dad,{'text':_0x55b0a4},_0x31826a);let _0x4b6562=null;try{_0xff17dd&&(_0x4b6562=_0xff17dd?.[_0x19e491(0x206)]&&_0xff17dd['key']['id']?_0xff17dd[_0x19e491(0x206)]['id']:_0xff17dd?.['message']&&_0xff17dd['message']?.['id']?_0xff17dd['message']['id']:_0xff17dd?.['id']?_0xff17dd['id']:null);}catch(_0x29a3dd){}if(_0x5d6cd5&&_0x5d6cd5!==_0x4b6562)try{if(botRef&&typeof botRef['sendMessage']==='function')try{await botRef[_0x19e491(0x22c)](_0x7e3dad,{'delete':{'id':_0x5d6cd5,'remoteJid':_0x7e3dad,'fromMe':!![]}}),info('[welcome]\x20deleted\x20previous\x20welcome\x20'+_0x5d6cd5+'\x20in\x20'+_0x7e3dad);}catch(_0x35e510){if('HaOOg'===_0x19e491(0x20d))try{_0x19e491(0x208)==='JNGXe'?(await botRef['sock']?.['sendMessage']?.(_0x7e3dad,{'delete':{'id':_0x5d6cd5,'remoteJid':_0x7e3dad,'fromMe':!![]}}),info('[welcome]\x20deleted\x20previous\x20welcome\x20(sock)\x20'+_0x5d6cd5+'\x20in\x20'+_0x7e3dad)):_0x92fecb[_0x19e491(0x1ec)](_0x5c91a2,'[welcome]\x20detachWelcomeListener\x20error:\x20'+(_0x664d60?.['message']||_0x1b2104));}catch(_0x38c7d9){_0x92fecb['HhtJC'](warn,'[welcome]\x20failed\x20to\x20delete\x20previous\x20welcome\x20'+_0x5d6cd5+'\x20in\x20'+_0x7e3dad+':\x20'+(_0x38c7d9?.['message']||_0x38c7d9));}else _0x2a3aba(_0x92fecb['PLXZQ']('[welcome]\x20hotReloadConfig\x20handler\x20error:\x20',_0x506c3c?.['message']||_0x3525be));}}catch(_0x5b44e9){_0x92fecb[_0x19e491(0x1ec)](warn,_0x19e491(0x218)+(_0x5b44e9?.['message']||_0x5b44e9));}try{if(_0x4b6562){if('BoTIG'!=='eOivs')await updateLastMsgIdInDb(_0x7e3dad,_0x4b6562);else{if(_0xcfa055[_0x19e491(0x209)](_0x3f8a43)){try{_0x16c8d1(_0x27e79d[_0x19e491(0x216)](_0x4b31e2));}catch(_0x4cd96b){}_0x48ef2b[_0x19e491(0x21c)](_0x4dd417);}_0x4993c0['delete'](_0x69e9cc);return;}}else await updateLastMsgIdInDb(_0x7e3dad,null);}catch(_0x1e8818){}const _0x49d9bd=Number(_0x164001[_0x19e491(0x225)]||0x0);if(_0x8a3bef&&_0x8a3bef!==_0x49d9bd)try{await db[_0x19e491(0x1f0)](_0x19e491(0x217),[_0x8a3bef,nowSec(),_0x7e3dad]),setCachedGroupSize(_0x7e3dad,_0x8a3bef);}catch(_0xf15631){}return info('[welcome]\x20sent\x20welcome\x20to\x20'+_0x9fc42e+'\x20in\x20'+_0x7e3dad),!![];}catch(_0x19034e){return _0x92fecb['jtLex'](warn,'[welcome]\x20sendWelcomeToMember\x20failed:\x20'+(_0x19034e?.['message']||_0x19034e)),![];}}async function flushGroup(_0x9ff944){const _0x150b23=_0x35f093,_0x545ed3={'xUObe':function(_0x3b284e,_0x35018b){return _0x3b284e(_0x35018b);},'zQCIw':function(_0x4a1b0e,_0x2cbd41,_0x308108){return _0x4a1b0e(_0x2cbd41,_0x308108);}};try{const _0x3533a4=groupQueues['get'](_0x9ff944);if(!_0x3533a4||_0x3533a4[_0x150b23(0x1ee)]===0x0){if('wTqcu'==='EaSQZ')return _0x545ed3['xUObe'](_0x43f84e,'[welcome]\x20sendApiOrFallback\x20failed:\x20'+(_0x57a7fd?.['message']||_0x5ae29e)),null;else{if(groupTimers['has'](_0x9ff944)){try{clearTimeout(groupTimers['get'](_0x9ff944));}catch(_0x207aa1){}groupTimers['delete'](_0x9ff944);}groupQueues['delete'](_0x9ff944);return;}}const _0x4e6d1c=Array['from'](_0x3533a4);for(const _0x32310c of _0x4e6d1c){try{await _0x545ed3[_0x150b23(0x21b)](sendWelcomeToMember,_0x9ff944,_0x32310c)[_0x150b23(0x1df)](()=>{});}catch(_0x5df9d2){warn('[welcome]\x20flushGroup\x20item\x20failed:\x20'+(_0x5df9d2?.['message']||_0x5df9d2));}}}catch(_0x30356c){warn('[welcome]\x20flushGroup\x20error:\x20'+(_0x30356c?.['message']||_0x30356c));}finally{if(groupTimers['has'](_0x9ff944)){try{clearTimeout(groupTimers['get'](_0x9ff944));}catch(_0x18b7a9){}groupTimers['delete'](_0x9ff944);}groupQueues['delete'](_0x9ff944);}}async function gpUpdateHandler(_0x40a1b1){const _0x998a3f=_0x35f093,_0xb7fc16={'acuJP':function(_0x5b0380,_0x29a086){return _0x5b0380!==_0x29a086;},'CUwmn':function(_0x2ee627,_0x9d588e){return _0x2ee627(_0x9d588e);}};try{if(!_0x40a1b1)return;const _0x54e4ab=(_0x40a1b1[_0x998a3f(0x22e)]||_0x40a1b1['type']||'')['toString']()['toLowerCase']();if(_0xb7fc16['acuJP'](_0x54e4ab,'add')&&_0x54e4ab!==_0x998a3f(0x1fe))return;const _0x3304c6=_0x40a1b1['id']||_0x40a1b1[_0x998a3f(0x1e7)]||_0x40a1b1['jid']||_0x40a1b1['groupJid'];if(!_0x3304c6)return;const _0xcbabee=Array['isArray'](_0x40a1b1['participants'])?_0x40a1b1[_0x998a3f(0x20c)]:Array['isArray'](_0x40a1b1['participants_added'])?_0x40a1b1['participants_added']:[];if(!_0xcbabee||_0xcbabee['length']===0x0)return;let _0x2c28c5=[];if(_0xcbabee['length']===0x1)_0x2c28c5=[_0xcbabee[0x0]];else{const _0x2231c4=_0xcbabee[_0xcbabee['length']-0x1];_0x2c28c5=[_0x2231c4];}if(!groupQueues[_0x998a3f(0x209)](_0x3304c6))groupQueues['set'](_0x3304c6,new Set());const _0x7b9bd=groupQueues[_0x998a3f(0x216)](_0x3304c6);for(const _0x278a7f of _0x2c28c5)_0x7b9bd[_0x998a3f(0x20a)](_0x278a7f);if(groupTimers['has'](_0x3304c6))try{_0xb7fc16[_0x998a3f(0x1eb)](clearTimeout,groupTimers['get'](_0x3304c6));}catch(_0x3518c2){}const _0x47ccd5=Math['max'](0x64,Number(CFG['DEBOUNCE_MS']||DEFAULTS['DEBOUNCE_MS'])),_0x3806cb=setTimeout(()=>{const _0x452507=_0x998a3f;flushGroup(_0x3304c6)['catch'](_0x5d8ebb=>warn(_0x452507(0x233)+(_0x5d8ebb?.['message']||_0x5d8ebb)));},_0x47ccd5);groupTimers['set'](_0x3304c6,_0x3806cb);}catch(_0x2fc3ae){warn(_0x998a3f(0x226)+(_0x2fc3ae?.[_0x998a3f(0x1d9)]||_0x2fc3ae));}}function attachWelcomeListener(){const _0x5bce16=_0x35f093,_0x47d889={'BpSwk':function(_0x96c430,_0x1b9967){return _0x96c430===_0x1b9967;},'rPVUC':'[welcome]\x20attached\x20to\x20sock.ev.group-participants.update'};try{if(!botRef||!botRef['sock']||!botRef['sock']['ev'])return![];try{if(listener&&typeof botRef[_0x5bce16(0x207)]['ev']['off']==='function')botRef['sock']['ev']['off']('group-participants.update',listener);if(listener&&typeof botRef[_0x5bce16(0x207)]['ev'][_0x5bce16(0x1da)]==='function')botRef[_0x5bce16(0x207)]['ev']['removeListener'](_0x5bce16(0x21a),listener);}catch(_0x202d70){}return listener=gpUpdateHandler,_0x47d889['BpSwk'](typeof botRef['sock']['ev']['on'],'function')?(botRef[_0x5bce16(0x207)]['ev']['on']('group-participants.update',listener),attached=!![],lastSockIdentity=botRef[_0x5bce16(0x207)],info(_0x47d889[_0x5bce16(0x1f4)]),!![]):(warn('[welcome]\x20botRef.sock.ev\x20does\x20not\x20support\x20.on'),![]);}catch(_0x36df6a){return warn('[welcome]\x20attachWelcomeListener\x20failed:\x20'+(_0x36df6a?.['message']||_0x36df6a)),attached=![],listener=null,![];}}function detachWelcomeListener(){const _0x2a5a34=_0x35f093,_0x248c43={'fbNzz':'ScJFD','rmixC':function(_0x1a99a1,_0x392de0){return _0x1a99a1!==_0x392de0;}};try{if(_0x2a5a34(0x1fb)!==_0x248c43['fbNzz']){if(_0x234e51['has'](_0x9cde9e)){try{_0xd645d6(_0x1cabf1['get'](_0x2bba73));}catch(_0x42f37a){}_0x2b327c['delete'](_0x1b5cbb);}_0x5ac66f['delete'](_0x1f801c);}else{if(!listener)return;if(botRef&&botRef[_0x2a5a34(0x207)]&&botRef['sock']['ev'])try{botRef['sock']['ev'][_0x2a5a34(0x204)]?.('group-participants.update',listener);}catch(_0x47fed0){if(_0x248c43['rmixC']('efzbR','efzbR'))_0x4a2ee4['sock']['ev']['on']?.('connection.update',_0x6ddfe6);else try{botRef['sock']['ev']['removeListener']?.('group-participants.update',listener);}catch(_0x3e9223){}}}}catch(_0x561146){warn('[welcome]\x20detachWelcomeListener\x20error:\x20'+(_0x561146?.[_0x2a5a34(0x1d9)]||_0x561146));}finally{attached=![],listener=null,lastSockIdentity=null,info(_0x2a5a34(0x235));}}function startAttachWatcher(){const _0x108b20={'kSkqj':function(_0x272e7f){return _0x272e7f();}};stopAttachWatcher(),attachWatcherInterval=setInterval(()=>{const _0x59f895=_0xb43d;try{if(!botRef)return;if(!attached&&botRef&&botRef['sock']&&botRef[_0x59f895(0x207)]['ev'])_0x108b20['kSkqj'](attachWelcomeListener);}catch(_0x362a41){warn('[welcome]\x20attach\x20watcher\x20error:\x20'+(_0x362a41?.['message']||_0x362a41));}},CFG['ATTACH_WATCHER_MS']||DEFAULTS['ATTACH_WATCHER_MS']);}function stopAttachWatcher(){attachWatcherInterval&&(clearInterval(attachWatcherInterval),attachWatcherInterval=null);}function startSockMonitor(){const _0x4ef107={'WmLvw':function(_0x318862){return _0x318862();}};stopSockMonitor(),sockMonitorInterval=setInterval(()=>{try{if(!botRef)return;const _0x24e865=botRef['sock']||null;if(_0x24e865&&lastSockIdentity&&_0x24e865!==lastSockIdentity){info('[welcome]\x20detected\x20botRef.sock\x20change\x20-\x20re-attaching\x20listener');try{detachWelcomeListener();}catch(_0x28d58d){}_0x4ef107['WmLvw'](attachWelcomeListener);}else!lastSockIdentity&&_0x24e865&&attachWelcomeListener();}catch(_0x16aa96){warn('[welcome]\x20sock\x20monitor\x20error:\x20'+(_0x16aa96?.['message']||_0x16aa96));}},CFG['SOCK_MONITOR_MS']||DEFAULTS['SOCK_MONITOR_MS']);}function _0xb43d(_0x22be31,_0x3b45c0){const _0xe1ec65=_0xfc5a();return _0xb43d=function(_0x1f02a1,_0xf044f1){_0x1f02a1=_0x1f02a1-0x1d9;let _0x2a07c4=_0xe1ec65[_0x1f02a1];if(_0xb43d['HHIXwE']===undefined){var _0x2361c2=function(_0x311f44){const _0x1c15d4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x40f786='',_0x47a7ef='';for(let _0x403792=0x0,_0x74b3a7,_0x36f076,_0x19706b=0x0;_0x36f076=_0x311f44['charAt'](_0x19706b++);~_0x36f076&&(_0x74b3a7=_0x403792%0x4?_0x74b3a7*0x40+_0x36f076:_0x36f076,_0x403792++%0x4)?_0x40f786+=String['fromCharCode'](0xff&_0x74b3a7>>(-0x2*_0x403792&0x6)):0x0){_0x36f076=_0x1c15d4['indexOf'](_0x36f076);}for(let _0x16c8ab=0x0,_0x2a0edb=_0x40f786['length'];_0x16c8ab<_0x2a0edb;_0x16c8ab++){_0x47a7ef+='%'+('00'+_0x40f786['charCodeAt'](_0x16c8ab)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x47a7ef);};_0xb43d['wlrAwK']=_0x2361c2,_0x22be31=arguments,_0xb43d['HHIXwE']=!![];}const _0xfc5a75=_0xe1ec65[0x0],_0xb43d01=_0x1f02a1+_0xfc5a75,_0x45a762=_0x22be31[_0xb43d01];return!_0x45a762?(_0x2a07c4=_0xb43d['wlrAwK'](_0x2a07c4),_0x22be31[_0xb43d01]=_0x2a07c4):_0x2a07c4=_0x45a762,_0x2a07c4;},_0xb43d(_0x22be31,_0x3b45c0);}function stopSockMonitor(){sockMonitorInterval&&(clearInterval(sockMonitorInterval),sockMonitorInterval=null);}function startConnectionUpdateHook(){const _0x5ebd32=_0x35f093;if(!botRef||!botRef['sock']||!botRef['sock']['ev'])return;if(connectionUpdateHandler)return;connectionUpdateHandler=_0x458955=>{if('QbuYJ'==='QbuYJ')try{setTimeout(()=>{const _0x2abd34=_0xb43d;try{info(_0x2abd34(0x202)),attachWelcomeListener();}catch(_0x2afa4){}},0x1f4);}catch(_0x3afcf0){warn('[welcome]\x20connection.update\x20handler\x20error:\x20'+(_0x3afcf0?.['message']||_0x3afcf0));}else return![];};try{botRef['sock']['ev']['on']?.('connection.update',connectionUpdateHandler);}catch(_0x943b7e){warn(_0x5ebd32(0x1fc)+(_0x943b7e?.[_0x5ebd32(0x1d9)]||_0x943b7e));}}function stopConnectionUpdateHook(){const _0x589722=_0x35f093;try{if(connectionUpdateHandler&&botRef&&botRef['sock']&&botRef['sock']['ev'])try{botRef['sock']['ev'][_0x589722(0x204)]?.(_0x589722(0x1fd),connectionUpdateHandler);}catch(_0x217736){try{botRef['sock']['ev']['removeListener']?.('connection.update',connectionUpdateHandler);}catch(_0x259293){}}}catch(_0x33e89e){}connectionUpdateHandler=null;}export async function initialize(_0x484778){const _0x15e110=_0x35f093,_0x2a3942={'XkiqW':'boolean','JpdzK':function(_0x31222a,_0x4c20b5){return _0x31222a(_0x4c20b5);},'lDBFA':function(_0x4b917e,_0x2c5b83){return _0x4b917e+_0x2c5b83;}};if(!_0x484778)throw new Error('welcome.initialize\x20requires\x20bot\x20instance');botRef=_0x484778,setupSendApi();try{const _0x2055f5=getConfig()||{},_0x18d8f6=_0x2055f5&&_0x2055f5['WELCOME']?_0x2055f5['WELCOME']:{};CFG['DEFAULT_ENABLED']=typeof _0x18d8f6[_0x15e110(0x21d)]==='boolean'?_0x18d8f6['DEFAULT_ENABLED']:DEFAULTS['DEFAULT_ENABLED'],CFG['GROUP_SIZE_CACHE_TTL_MS']=Number['isInteger'](_0x18d8f6['GROUP_SIZE_CACHE_TTL_MS'])?_0x18d8f6[_0x15e110(0x1dd)]:DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'],CFG['WHATSAPP_GROUP_MAX']=Number['isInteger'](_0x18d8f6['WHATSAPP_GROUP_MAX'])?_0x18d8f6['WHATSAPP_GROUP_MAX']:DEFAULTS['WHATSAPP_GROUP_MAX'],CFG['DEBOUNCE_MS']=Number['isInteger'](_0x18d8f6[_0x15e110(0x1e2)])?_0x18d8f6['DEBOUNCE_MS']:DEFAULTS['DEBOUNCE_MS'],CFG['ATTACH_WATCHER_MS']=Number['isInteger'](_0x18d8f6[_0x15e110(0x1e0)])?_0x18d8f6[_0x15e110(0x1e0)]:DEFAULTS['ATTACH_WATCHER_MS'],CFG['SOCK_MONITOR_MS']=Number['isInteger'](_0x18d8f6['SOCK_MONITOR_MS'])?_0x18d8f6[_0x15e110(0x1ed)]:DEFAULTS[_0x15e110(0x1ed)];}catch(_0xe7cd88){_0x2a3942['JpdzK'](warn,'[welcome]\x20config\x20load\x20failed,\x20using\x20defaults'),CFG={...DEFAULTS};}try{hotReloadConfig&&hotReloadConfig(_0x4417d5=>{const _0x1d9bbd=_0x15e110;try{const _0x150e76=getConfig()||{},_0xe9e7fd=_0x150e76&&_0x150e76['WELCOME']?_0x150e76['WELCOME']:{};CFG['DEFAULT_ENABLED']=typeof _0xe9e7fd['DEFAULT_ENABLED']===_0x2a3942['XkiqW']?_0xe9e7fd['DEFAULT_ENABLED']:DEFAULTS[_0x1d9bbd(0x21d)],CFG['GROUP_SIZE_CACHE_TTL_MS']=Number['isInteger'](_0xe9e7fd['GROUP_SIZE_CACHE_TTL_MS'])?_0xe9e7fd[_0x1d9bbd(0x1dd)]:DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'],CFG['WHATSAPP_GROUP_MAX']=Number['isInteger'](_0xe9e7fd['WHATSAPP_GROUP_MAX'])?_0xe9e7fd[_0x1d9bbd(0x1f3)]:DEFAULTS['WHATSAPP_GROUP_MAX'],CFG['DEBOUNCE_MS']=Number['isInteger'](_0xe9e7fd['DEBOUNCE_MS'])?_0xe9e7fd['DEBOUNCE_MS']:DEFAULTS['DEBOUNCE_MS'],CFG[_0x1d9bbd(0x1e0)]=Number['isInteger'](_0xe9e7fd[_0x1d9bbd(0x1e0)])?_0xe9e7fd[_0x1d9bbd(0x1e0)]:DEFAULTS['ATTACH_WATCHER_MS'],CFG['SOCK_MONITOR_MS']=Number[_0x1d9bbd(0x228)](_0xe9e7fd['SOCK_MONITOR_MS'])?_0xe9e7fd[_0x1d9bbd(0x1ed)]:DEFAULTS[_0x1d9bbd(0x1ed)],_0x2a3942['JpdzK'](info,_0x2a3942['lDBFA']('[welcome]\x20hotReloadConfig\x20applied.\x20Changed\x20keys:\x20',(_0x4417d5||[])['join'](',\x20')));}catch(_0x2d7430){warn('[welcome]\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x2d7430?.['message']||_0x2d7430));}});}catch(_0x5130c1){warn(_0x15e110(0x224)+(_0x5130c1?.['message']||_0x5130c1));}try{await ensureSchema();try{'bmAfm'==='iNugj'?(_0x171c9c=![],_0x52ac28=null,_0x232305=null,_0x53efec=null,_0x442af0('[welcome]\x20cleaned\x20up')):(attachWelcomeListener(),startConnectionUpdateHook(),startAttachWatcher(),startSockMonitor(),info('[welcome]\x20initialized\x20with\x20session\x20resilience'));}catch(_0x13b027){error('[welcome]\x20failed\x20to\x20attach\x20listener\x20(will\x20keep\x20watching):\x20'+(_0x13b027?.['message']||_0x13b027));}}catch(_0x53c6af){error(_0x53c6af,_0x15e110(0x1f9)+(_0x53c6af?.['message']||_0x53c6af));throw _0x53c6af;}}export async function onMessage(_0x3ef604){const _0x1ac6bb=_0x35f093,_0x324ddc={'HEjYS':function(_0x79c67f,_0x40f4d4){return _0x79c67f(_0x40f4d4);},'ZBEpi':function(_0x33ccfc,_0x4bb9ca){return _0x33ccfc(_0x4bb9ca);},'soNQt':function(_0x47c553,_0x55b7cf){return _0x47c553>_0x55b7cf;},'tBISM':function(_0x1e3936,_0x5cb5e4){return _0x1e3936===_0x5cb5e4;}};try{if('DpUYN'!=='phAYj'){if(!_0x3ef604||!_0x3ef604[_0x1ac6bb(0x206)]||!_0x3ef604[_0x1ac6bb(0x1d9)])return;const _0x4037bd=String(_0x3ef604[_0x1ac6bb(0x206)]['remoteJid']||'')+'::'+String(_0x3ef604['key']['id']||_0x3ef604['key']['participant']||'');if(isProcessed(_0x4037bd))return;markProcessed(_0x4037bd);if(!_0x3ef604['isCommand'])return;const _0x1e1cc5=typeof _0x3ef604['text']==='string'&&_0x3ef604['text']['trim']()['length']?_0x3ef604[_0x1ac6bb(0x237)]['trim']():(extractTextFromMessage(_0x3ef604)||'')[_0x1ac6bb(0x1dc)]();if(!_0x1e1cc5)return;const _0x23b9ee=(_0x1e1cc5['split'](/\s+/)[0x0]||'')[_0x1ac6bb(0x1f6)]();if(!commands[_0x1ac6bb(0x1ef)](_0x23b9ee))return;const _0x11d928=_0x3ef604[_0x1ac6bb(0x206)]['remoteJid'],_0x477ae4=typeof _0x11d928===_0x1ac6bb(0x222)&&_0x11d928[_0x1ac6bb(0x210)]('@g.us');if(!_0x477ae4)return;let _0x289766=![];try{_0x289766=await isadmin(botRef,_0x3ef604);}catch(_0x43b66e){warn('[welcome]\x20isadmin\x20check\x20failed'),_0x289766=![];}if(!_0x289766)return;const _0x404682=_0x3ef604['key']?.['participant']||_0x3ef604['key']?.['from']||_0x3ef604['key']?.['remoteJid']||'',_0x1f240a=String(_0x404682||'')['split']('@')[0x0],_0x239fbe=_0x11d928;info('[welcome]\x20command\x20\x27'+_0x23b9ee+'\x27\x20detected\x20from\x20'+_0x404682+'\x20in\x20'+_0x11d928);const _0x146f39=(_0x1e1cc5||'')[_0x1ac6bb(0x1fa)](/\r?\n/)['map'](_0x5eef7e=>_0x5eef7e['trim']());let _0x3a900d=null;for(const _0x296d34 of _0x146f39['slice'](0x1)){const _0x8a2c55=_0x296d34['match'](/^gp[:\s]+(.+)$/i);if(_0x8a2c55){_0x3a900d=_0x8a2c55[0x1]['trim']();break;}}const _0x500d5c=(_0x146f39[0x0]||'')['trim']()['split'](/\s+/);if(!_0x3a900d&&_0x500d5c['length']>=0x2){if(_0x500d5c[0x1]['toLowerCase']()==='gp'&&_0x500d5c['length']>=0x3)_0x3a900d=_0x500d5c['slice'](0x2)[_0x1ac6bb(0x1e6)]('\x20')['trim']();else{if(_0x500d5c[0x1]['includes']('@'))_0x3a900d=_0x500d5c[0x1]['trim']();}}const _0x57f0a3=await _0x324ddc['HEjYS'](getDefault,_0x1f240a)['catch'](()=>null);if(!_0x57f0a3){await sendApiOrFallback(_0x239fbe,'No\x20default\x20connection/group\x20is\x20set\x20for\x20you.\x20Commands\x20must\x20apply\x20to\x20your\x20DEFAULT\x20group.\x20Set\x20with:\x20/setdefault\x20<connectionName>');return;}const _0x1b0c53=await getConnection(_0x57f0a3)['catch'](()=>null);if(!_0x1b0c53){await sendApiOrFallback(_0x239fbe,'Could\x20not\x20resolve\x20your\x20default\x20connection\x20\x27'+_0x57f0a3+'\x27.\x20Please\x20check\x20/setdefault\x20value.');return;}if(_0x23b9ee===_0x1ac6bb(0x1f8)){const _0xb0a28=_0x146f39['slice'](0x1)['filter'](_0x46ca38=>!_0x46ca38[_0x1ac6bb(0x1db)](/^gp[:\s]+(.+)$/i)),_0x3d17fa=_0xb0a28['join']('\x0a')['trim']();if(!_0x3d17fa){await sendApiOrFallback(_0x239fbe,'Usage\x20(group-only,\x20admin-only):\x0awlc\x0a<your\x20multi-line\x20welcome\x20message>\x0aOptionally\x20include\x20a\x20line\x20\x22gp\x20<groupKey>\x22\x20but\x20it\x20will\x20be\x20ignored\x20—\x20welcome\x20saved\x20to\x20your\x20DEFAULT\x20connection.');return;}_0x3a900d&&await sendApiOrFallback(_0x239fbe,'Notice:\x20\x27gp\x27\x20parameter\x20in\x20command\x20is\x20ignored.\x20Welcome\x20will\x20be\x20saved\x20to\x20your\x20default\x20connection:\x20'+_0x1b0c53);let _0x2c93cc=await fetchGroupMetadata(_0x1b0c53),_0x4670fa=null;if(_0x2c93cc&&Array['isArray'](_0x2c93cc['participants']))_0x4670fa=_0x2c93cc['participants']['length'];else{if(_0x2c93cc&&typeof _0x2c93cc[_0x1ac6bb(0x1ee)]==='number')_0x4670fa=_0x2c93cc['size'];}const _0x1254b6=await getWelcomeFromDb(_0x1b0c53),_0x56b0c3=_0x1254b6?_0x324ddc['ZBEpi'](Number,_0x1254b6[_0x1ac6bb(0x225)]||0x0):0x0,_0x89f76=_0x4670fa&&_0x4670fa>0x0?_0x4670fa:_0x56b0c3,_0x31bf64=await saveWelcomeToDb(_0x1b0c53,_0x3d17fa,_0x89f76,_0x1254b6&&_0x1254b6['last_msg_id']?_0x1254b6['last_msg_id']:null);if(_0x31bf64){if(_0x89f76&&_0x324ddc['soNQt'](_0x89f76,0x0))setCachedGroupSize(_0x1b0c53,_0x89f76);await sendApiOrFallback(_0x239fbe,'Saved\x20welcome\x20message\x20to\x20your\x20default\x20connection:\x20'+_0x1b0c53);}else await sendApiOrFallback(_0x239fbe,'Failed\x20to\x20save\x20welcome\x20message\x20for:\x20'+_0x1b0c53);return;}if(_0x324ddc['tBISM'](_0x23b9ee,'delwlc')){_0x3a900d&&await sendApiOrFallback(_0x239fbe,'Notice:\x20\x27gp\x27\x20parameter\x20in\x20command\x20is\x20ignored.\x20Deleting\x20welcome\x20for\x20your\x20default\x20connection:\x20'+_0x1b0c53);const _0x1e1a91=await deleteWelcomeFromDb(_0x1b0c53);_0x1e1a91?(groupSizeCache['delete'](_0x1b0c53),await sendApiOrFallback(_0x239fbe,'Deleted\x20welcome\x20message\x20for\x20'+_0x1b0c53)):await sendApiOrFallback(_0x239fbe,'No\x20welcome\x20message\x20found\x20for\x20'+_0x1b0c53);return;}return;}else _0x5acb87[_0x1ac6bb(0x207)]['ev']['off']?.('connection.update',_0x255483);}catch(_0x56a98a){error(_0x56a98a,'[welcome]\x20onMessage\x20error:\x20'+(_0x56a98a?.['message']||_0x56a98a));}}export async function cleanup(){const _0x5b71a4=_0x35f093;try{for(const _0x291592 of groupTimers['values']())try{clearTimeout(_0x291592);}catch(_0x34ed0c){}groupTimers['clear'](),groupQueues['clear'](),groupSizeCache['clear'](),stopAttachWatcher(),stopSockMonitor(),stopConnectionUpdateHook(),detachWelcomeListener();for(const _0x23938b of processedMessageKeys['values']())try{clearTimeout(_0x23938b);}catch(_0x4b4d9d){}processedMessageKeys['clear']();}catch(_0x4799bc){warn('[welcome]\x20cleanup\x20error:\x20'+(_0x4799bc?.['message']||_0x4799bc));}finally{attached=![],listener=null,botRef=null,sendApi=null,info(_0x5b71a4(0x220));}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x1f02a1(_0x2f3b06){const _0x50c309={'mOBja':'debu','kMWVi':'action'};function _0x966c7c(_0x5c3120){const _0x442ada=_0xb43d;if(typeof _0x5c3120==='string')return function(_0x4a8195){}['constructor']('while\x20(true)\x20{}')['apply']('counter');else(''+_0x5c3120/_0x5c3120)['length']!==0x1||_0x5c3120%0x14===0x0?function(){return!![];}['constructor'](_0x50c309['mOBja']+_0x442ada(0x1e8))['call'](_0x50c309['kMWVi']):function(){return![];}['constructor']('debu'+'gger')[_0x442ada(0x236)](_0x442ada(0x211));_0x966c7c(++_0x5c3120);}try{if(_0x2f3b06)return _0x966c7c;else _0x966c7c(0x0);}catch(_0x4dfef7){}}