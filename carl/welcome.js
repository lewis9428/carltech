(function(_0x2d6075,_0x4b6837){const _0x49674f=_0x303c,_0x5ec7dc=_0x2d6075();while(!![]){try{const _0x54c7e5=parseInt(_0x49674f(0x140))/0x1*(-parseInt(_0x49674f(0xf9))/0x2)+parseInt(_0x49674f(0x132))/0x3+parseInt(_0x49674f(0x123))/0x4*(-parseInt(_0x49674f(0x10a))/0x5)+parseInt(_0x49674f(0x103))/0x6*(-parseInt(_0x49674f(0x14d))/0x7)+parseInt(_0x49674f(0x119))/0x8*(parseInt(_0x49674f(0x14c))/0x9)+-parseInt(_0x49674f(0x13b))/0xa*(parseInt(_0x49674f(0x150))/0xb)+parseInt(_0x49674f(0x13a))/0xc;if(_0x54c7e5===_0x4b6837)break;else _0x5ec7dc['push'](_0x5ec7dc['shift']());}catch(_0x51eaca){_0x5ec7dc['push'](_0x5ec7dc['shift']());}}}(_0x41e8,0x42b39));const _0x4cfe51=(function(){let _0x580302=!![];return function(_0x386f10,_0x2ab781){const _0xa5d743=_0x580302?function(){if(_0x2ab781){const _0xdff02c=_0x2ab781['apply'](_0x386f10,arguments);return _0x2ab781=null,_0xdff02c;}}:function(){};return _0x580302=![],_0xa5d743;};}());(function(){const _0x27c0a5={'exotv':'function\x20*\x5c(\x20*\x5c)','vgFow':'init','fFNvl':function(_0x590dd9,_0x587517){return _0x590dd9(_0x587517);}};_0x4cfe51(this,function(){const _0x23c88=_0x303c,_0x5441e5=new RegExp(_0x27c0a5['exotv']),_0x43d906=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x14e0e6=_0x4252c6(_0x27c0a5[_0x23c88(0x137)]);!_0x5441e5['test'](_0x14e0e6+'chain')||!_0x43d906['test'](_0x14e0e6+'input')?_0x27c0a5['fFNvl'](_0x14e0e6,'0'):_0x4252c6();})();}());import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{getDefault,getConnection}from'../utils/connection.js';export const name='welcome';export const version='2.2.1';export const priority=0x7a;export const configKeys=['WELCOME'];export const commands=['wlc','delwlc'];function _0x303c(_0xbcfeca,_0x5b0bc4){const _0x3c36f8=_0x41e8();return _0x303c=function(_0x4252c6,_0x4cfe51){_0x4252c6=_0x4252c6-0xf9;let _0x38de13=_0x3c36f8[_0x4252c6];if(_0x303c['eiVfNz']===undefined){var _0xc0c607=function(_0x45e651){const _0x26ccec='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0xfa1c8c='',_0x5d2da2='';for(let _0x2810a5=0x0,_0x377e63,_0x4db02f,_0x2897fd=0x0;_0x4db02f=_0x45e651['charAt'](_0x2897fd++);~_0x4db02f&&(_0x377e63=_0x2810a5%0x4?_0x377e63*0x40+_0x4db02f:_0x4db02f,_0x2810a5++%0x4)?_0xfa1c8c+=String['fromCharCode'](0xff&_0x377e63>>(-0x2*_0x2810a5&0x6)):0x0){_0x4db02f=_0x26ccec['indexOf'](_0x4db02f);}for(let _0x4eba2f=0x0,_0x1b361f=_0xfa1c8c['length'];_0x4eba2f<_0x1b361f;_0x4eba2f++){_0x5d2da2+='%'+('00'+_0xfa1c8c['charCodeAt'](_0x4eba2f)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x5d2da2);};_0x303c['plZfbt']=_0xc0c607,_0xbcfeca=arguments,_0x303c['eiVfNz']=!![];}const _0x41e8bd=_0x3c36f8[0x0],_0x303c02=_0x4252c6+_0x41e8bd,_0x4a4f2f=_0xbcfeca[_0x303c02];return!_0x4a4f2f?(_0x38de13=_0x303c['plZfbt'](_0x38de13),_0xbcfeca[_0x303c02]=_0x38de13):_0x38de13=_0x4a4f2f,_0x38de13;},_0x303c(_0xbcfeca,_0x5b0bc4);}let botRef=null,attached=![],listener=null,sendApi=null,attachWatcherInterval=null,sockMonitorInterval=null,lastSockIdentity=null,connectionUpdateHandler=null;const DEFAULTS={'DEFAULT_ENABLED':!![],'GROUP_SIZE_CACHE_TTL_MS':0x5*0x3c*0x3e8,'WHATSAPP_GROUP_MAX':0x401,'DEBOUNCE_MS':0x7d0,'ATTACH_WATCHER_MS':0xbb8,'SOCK_MONITOR_MS':0x3e8};let CFG={...DEFAULTS};const groupQueues=new Map(),groupTimers=new Map(),groupSizeCache=new Map(),DEDUPE_TTL_MS=0x1e*0x3e8,processedMessageKeys=new Map();function markProcessed(_0x1014ec){const _0x4c70c3=_0x303c;if(!_0x1014ec)return;if(processedMessageKeys['has'](_0x1014ec))try{clearTimeout(processedMessageKeys[_0x4c70c3(0x120)](_0x1014ec));}catch(_0x573382){}const _0x479a4e=setTimeout(()=>processedMessageKeys['delete'](_0x1014ec),DEDUPE_TTL_MS);processedMessageKeys['set'](_0x1014ec,_0x479a4e);}function isProcessed(_0x589cab){const _0x264c4b=_0x303c;return _0x589cab&&processedMessageKeys[_0x264c4b(0x14f)](_0x589cab);}async function ensureSchema(){const _0xdda86f=_0x303c,_0x435656={'bxiBT':function(_0x32318c){return _0x32318c();},'dBASK':function(_0x5b4df4,_0x32b23c){return _0x5b4df4===_0x32b23c;},'yNkRa':function(_0x52f623,_0x2e0815){return _0x52f623(_0x2e0815);},'agKDN':'tIDua'};try{if(_0x435656['agKDN']==='tIDua'){await db[_0xdda86f(0xfd)]('\x0a\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20welcomes\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20group_jid\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20message\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_size\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_msg_id\x20TEXT\x20DEFAULT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20INTEGER\x20DEFAULT\x200\x0a\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20');try{await db['exec']('ALTER\x20TABLE\x20welcomes\x20ADD\x20COLUMN\x20last_msg_id\x20TEXT\x20DEFAULT\x20NULL;');}catch(_0x2214a7){}info('[welcome]\x20DB\x20schema\x20ensured');}else{const _0x5c2cad=_0x435656[_0xdda86f(0x10d)](_0x3b775d)||{},_0x3caa61=_0x5c2cad&&_0x5c2cad['WELCOME']?_0x5c2cad[_0xdda86f(0x148)]:{};_0x2460ae['DEFAULT_ENABLED']=_0x435656['dBASK'](typeof _0x3caa61['DEFAULT_ENABLED'],_0xdda86f(0x146))?_0x3caa61['DEFAULT_ENABLED']:_0x192968['DEFAULT_ENABLED'],_0x3767d2['GROUP_SIZE_CACHE_TTL_MS']=_0x3dc2d1['isInteger'](_0x3caa61['GROUP_SIZE_CACHE_TTL_MS'])?_0x3caa61['GROUP_SIZE_CACHE_TTL_MS']:_0x209ab4[_0xdda86f(0x133)],_0xbacb00['WHATSAPP_GROUP_MAX']=_0xc0ec68['isInteger'](_0x3caa61['WHATSAPP_GROUP_MAX'])?_0x3caa61['WHATSAPP_GROUP_MAX']:_0x3c133e['WHATSAPP_GROUP_MAX'],_0x4d10b6[_0xdda86f(0x11e)]=_0x439ff2['isInteger'](_0x3caa61['DEBOUNCE_MS'])?_0x3caa61[_0xdda86f(0x11e)]:_0x531bb3['DEBOUNCE_MS'],_0x56a3cf['ATTACH_WATCHER_MS']=_0x145e8a[_0xdda86f(0x101)](_0x3caa61['ATTACH_WATCHER_MS'])?_0x3caa61[_0xdda86f(0x12a)]:_0x5f2b7f['ATTACH_WATCHER_MS'],_0x1dacc1['SOCK_MONITOR_MS']=_0x206087['isInteger'](_0x3caa61[_0xdda86f(0x11f)])?_0x3caa61['SOCK_MONITOR_MS']:_0x1cd5ff['SOCK_MONITOR_MS'],_0x435656['yNkRa'](_0x491ed1,'[welcome]\x20hotReloadConfig\x20applied.\x20Changed\x20keys:\x20'+(_0x1b9e3c||[])['join'](',\x20'));}}catch(_0x4765c9){error(_0x4765c9,'[welcome]\x20ensureSchema\x20failed');throw _0x4765c9;}}async function saveWelcomeToDb(_0x1a80b9,_0x23daf0,_0x1372b3=0x0,_0x35081a=null){const _0x4645ee={'YFGte':function(_0x20619a,_0x59fd1e){return _0x20619a||_0x59fd1e;},'uePdD':function(_0x2b0cbb,_0x393ae8){return _0x2b0cbb||_0x393ae8;}};try{const _0x5045c1=Math['floor'](Date['now']()/0x3e8);return await db['run']('INSERT\x20INTO\x20welcomes\x20(group_jid,\x20message,\x20last_size,\x20last_msg_id,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(group_jid)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x20=\x20excluded.message,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20last_size\x20=\x20excluded.last_size,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20last_msg_id\x20=\x20excluded.last_msg_id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20excluded.updated_at;',[_0x1a80b9,String(_0x23daf0||''),Number(_0x4645ee['YFGte'](_0x1372b3,0x0)),_0x4645ee['uePdD'](_0x35081a,null),_0x5045c1]),info('[welcome]\x20saved\x20welcome\x20for\x20'+_0x1a80b9),!![];}catch(_0x453ee4){return warn('[welcome]\x20saveWelcomeToDb\x20failed:\x20'+(_0x453ee4?.['message']||_0x453ee4)),![];}}async function deleteWelcomeFromDb(_0x5527f4){try{const _0x2035fc=await db['run']('DELETE\x20FROM\x20welcomes\x20WHERE\x20group_jid\x20=\x20?',[_0x5527f4]);return info('[welcome]\x20deleted\x20welcome\x20for\x20'+_0x5527f4),_0x2035fc?.['changes']||0x0;}catch(_0x192eab){return warn('[welcome]\x20deleteWelcomeFromDb\x20failed:\x20'+(_0x192eab?.['message']||_0x192eab)),0x0;}}async function getWelcomeFromDb(_0x3a4315){const _0x141fd4=_0x303c,_0x7bf91={'FfURH':function(_0x2262a8,_0x3ef5ba){return _0x2262a8-_0x3ef5ba;}};try{const _0x148a62=await db[_0x141fd4(0x120)]('SELECT\x20message,\x20last_size,\x20last_msg_id,\x20updated_at\x20FROM\x20welcomes\x20WHERE\x20group_jid\x20=\x20?',[_0x3a4315]);return _0x148a62||null;}catch(_0x50a848){if('fKUUH'==='WLCFO'){const _0x1669b4=_0x42e68c[_0x7bf91['FfURH'](_0x1da4bb[_0x141fd4(0x118)],0x1)];_0xd97717=[_0x1669b4];}else return warn('[welcome]\x20getWelcomeFromDb\x20failed:\x20'+(_0x50a848?.[_0x141fd4(0x12e)]||_0x50a848)),null;}}async function updateLastMsgIdInDb(_0x570279,_0x4ed793){const _0x235817=_0x303c,_0x26de5f={'erCVA':function(_0x153c9c,_0x14d7f2){return _0x153c9c(_0x14d7f2);}};try{if(_0x235817(0x130)!=='jfXHl'){if(_0x5ea12b)return _0x3d935b;else _0x418468(0x0);}else{const _0x2ad9fc=Math['floor'](Date['now']()/0x3e8);return await db['run']('UPDATE\x20welcomes\x20SET\x20last_msg_id\x20=\x20?,\x20updated_at\x20=\x20?\x20WHERE\x20group_jid\x20=\x20?',[_0x4ed793||null,_0x2ad9fc,_0x570279]),!![];}}catch(_0x9f0103){return _0x26de5f['erCVA'](warn,_0x235817(0x112)+(_0x9f0103?.['message']||_0x9f0103)),![];}}function setupSendApi(){const _0x3e2860=_0x303c;if(!botRef)return;if(typeof botRef['sendMessage']==='function')sendApi=async(_0x5904fd,_0x4e1659)=>await botRef['sendMessage'](_0x5904fd,_0x4e1659);else botRef[_0x3e2860(0x104)]&&typeof botRef[_0x3e2860(0x104)][_0x3e2860(0x13f)]==='function'?sendApi=async(_0x5a185b,_0x2e4c9e)=>await botRef[_0x3e2860(0x104)]['sendMessage'](_0x5a185b,_0x2e4c9e):sendApi=null;}(function(){const _0x3de736={'ZeJwZ':function(_0x3015ed,_0x4a0139){return _0x3015ed+_0x4a0139;}};let _0x82b8f9;try{const _0x344963=Function(_0x3de736['ZeJwZ']('return\x20(function()\x20','{}.constructor(\x22return\x20this\x22)(\x20)')+');');_0x82b8f9=_0x344963();}catch(_0x2c8886){_0x82b8f9=window;}_0x82b8f9['setInterval'](_0x4252c6,0x61a80);}());async function sendApiOrFallback(_0x515180,_0x312a73,_0x476e8f=[]){const _0x14f8b6=_0x303c,_0x393fbc={'QjOoS':function(_0x5b14a5,_0x399c06){return _0x5b14a5===_0x399c06;}};try{if(!_0x515180||!_0x312a73)return null;const _0x15d181=_0x393fbc['QjOoS'](typeof _0x312a73,'string')?{'text':String(_0x312a73)}:_0x312a73;if(Array['isArray'](_0x476e8f)&&_0x476e8f['length'])_0x15d181['mentions']=_0x476e8f;if(sendApi)try{if('zHfbh'!==_0x14f8b6(0x142))_0x2a74e9['sock']['ev']['off']?.('group-participants.update',_0x4cccf4);else{const _0x1e23c9=await sendApi(_0x515180,_0x15d181);return _0x1e23c9;}}catch(_0x586cb1){return warn('[welcome]\x20sendApi\x20failed:\x20'+(_0x586cb1?.['message']||_0x586cb1)),null;}else return warn(_0x14f8b6(0x128)+_0x515180),null;}catch(_0x4114f2){if(_0x14f8b6(0x147)===_0x14f8b6(0x126))_0x2eac11('[welcome]\x20connection.update\x20observed\x20-\x20ensuring\x20listener\x20attached'),_0x465422();else return warn('[welcome]\x20sendApiOrFallback\x20failed:\x20'+(_0x4114f2?.['message']||_0x4114f2)),null;}}function extractTextFromMessage(_0x54d698){const _0x23e28c=_0x303c;if(!_0x54d698||!_0x54d698['message'])return'';const _0x1a6d96=_0x54d698['message'];if(_0x1a6d96[_0x23e28c(0x13d)])return _0x1a6d96[_0x23e28c(0x13d)];if(_0x1a6d96['extendedTextMessage']?.[_0x23e28c(0x10c)])return _0x1a6d96[_0x23e28c(0xfc)]['text'];if(_0x1a6d96['imageMessage']?.[_0x23e28c(0xfb)])return _0x1a6d96['imageMessage'][_0x23e28c(0xfb)];if(_0x1a6d96['videoMessage']?.[_0x23e28c(0xfb)])return _0x1a6d96['videoMessage'][_0x23e28c(0xfb)];if(_0x1a6d96['buttonsResponseMessage']?.[_0x23e28c(0x109)])return _0x1a6d96['buttonsResponseMessage']['selectedButtonId'];if(_0x1a6d96['listResponseMessage']?.['singleSelectReply']?.['selectedRowId'])return _0x1a6d96[_0x23e28c(0x141)]['singleSelectReply']['selectedRowId'];return'';}function _0x41e8(){const _0x117790=['CgfYDgLJAxbHBNrZ','uKXcqvG','yM9VBgvHBG','CMHTuNG','v0vmq09nrq','BM93','v0HbvfnbufbFr1jpvvbFtufy','igLUia','mtK1nJy5ovjPAwLXza','n2ntrMz3wG','C3bSAxq','AgfZ','mJmYmw9nEhvkEa','EvLys3y','tM8GD2vSy29TzsbTzxnZywDLigzVDw5KigzVCIa','mK5HAgrxra','Aw52AxrL','y2fWDgLVBG','zxH0zw5KzwruzxH0twvZC2fNzq','zxHLyW','s2PwAfq','zNvUy3rPB24','BNvTyMvY','AxnjBNrLz2vY','B2zM','mJi0ndC3nhDdq3nmEG','C29JAW','y29UC3rYDwn0B3i','ywLwrLy','CMvTB3zLtgLZDgvUzxi','ywn0Aw9U','C2vSzwn0zwrcDxr0B25jza','mZqZntvyy0PvsgG','w3DLBgnVBwvDigDWvxbKyxrLsgfUzgXLCIbLCNjVCJOG','Dgv4Da','yNHPqLq','AM9Wrhu','zw5KC1DPDgG','Bwf0y2G','w3DLBgnVBwvDigf0DgfJAfDLBgnVBwvmAxn0zw5LCIbMywLSzwq6ia','w3DLBgnVBwvDihvWzgf0zuXHC3rnC2DjzeLUrgiGzMfPBgvKoIa','zNjVBq','wgTvALm','ywrK','DM5HBwu','y2XLyxi','BgvUz3rO','ofvRz2fZvW','DhjPBq','z3jVDxbnzxrHzgf0yq','revgqvvmvf9ftKfcteve','w3DLBgnVBwvDigrLDgfJAfDLBgnVBwvmAxn0zw5LCIbLCNjVCJOG','revct1voq0vFtvm','u09ds19nt05jve9sx01t','z2v0','m3WXFdj8nhWW','w3DLBgnVBwvDignSzwfUzwqGDxa','ogjyy2nmwG','C2v0','w3DLBgnVBwvDigrLDgvJDgvKigjVDfjLzI5ZB2nRignOyw5NzsaTihjLlwf0DgfJAgLUzYbSAxn0zw5LCG','BxjjEgy','w3DLBgnVBwvDigHVDfjLBg9HzenVBMzPzYbYzwDPC3rYyxrPB24GzMfPBgvKoIa','w3DLBgnVBwvDig5VihnLBMqGC3vYzMfJzsbHDMfPBgfIBguGzM9Yia','A2v5','qvruqunix1DbvenirvjFtvm','ChvZAa','w3DLBgnVBwvDigLZywrTAw4Gy2HLy2SGzMfPBgvK','D2vSy29Tzs5PBML0AwfSAxPLihjLCxvPCMvZigjVDcbPBNn0yw5Jzq','BwvZC2fNzq','rwnjCgC','AMzysgW','zvzjD0u','mti2nZi5m2rzAwLsEq','r1jpvvbFu0LArv9dqunirv9uveXFtvm','y29UBMvJDgLVBI51CgrHDgu','zgvSzxrL','qu5stK4','DMDgB3C','C2XPy2u','u0zrue0','ntqWmtm2oerWz1jNuG','mtG2odbRD2L5vLO','v2PAs0S','y29UDMvYC2f0Aw9U','y2f0y2G','C2vUze1LC3nHz2u','mZq3mJH2vvrIq3O','BgLZDfjLC3bVBNnLtwvZC2fNzq','EKHMyMG','wwLoD00'];_0x41e8=function(){return _0x117790;};return _0x41e8();}function nowSec(){const _0x1b1ca3=_0x303c;return Math['floor'](Date[_0x1b1ca3(0x149)]()/0x3e8);}async function resolveTargetChatIdFromCommand(_0x3eed6f,_0x38fb15){const _0x23018c=_0x303c;if(_0x3eed6f){const _0x12dbe0=_0x3eed6f['trim']();if(_0x12dbe0['includes']('@'))return _0x12dbe0;const _0xc950b6=await getConnection(_0x12dbe0)[_0x23018c(0x13e)](()=>null);if(_0xc950b6)return _0xc950b6;return null;}if(!_0x38fb15)return null;const _0x123d32=await getDefault(_0x38fb15)[_0x23018c(0x13e)](()=>null);if(_0x123d32){const _0x3645a3=await getConnection(_0x123d32)['catch'](()=>null);if(_0x3645a3)return _0x3645a3;}return null;}async function fetchGroupMetadata(_0x109afb){const _0x591f69=_0x303c,_0x2ac0b5={'qmpry':function(_0x5ebcca,_0x4b5c69){return _0x5ebcca===_0x4b5c69;},'CqTbR':function(_0x38e053,_0x44eb9c){return _0x38e053(_0x44eb9c);}};if(!botRef)return null;try{if(botRef['sock']&&typeof botRef['sock']['groupMetadata']==='function')return await botRef['sock'][_0x591f69(0x11b)](_0x109afb);if(typeof botRef['groupMetadata']==='function'){if(_0x2ac0b5['qmpry']('jopDu',_0x591f69(0x10e)))return await botRef['groupMetadata'](_0x109afb);else{try{_0xa712a5(_0x58ae6e['get'](_0x2e4c30));}catch(_0x1d995b){}_0x2cba66['delete'](_0x29048e);}}return null;}catch(_0x3e6dbd){return _0x2ac0b5['CqTbR'](warn,'[welcome]\x20fetchGroupMetadata\x20failed:\x20'+(_0x3e6dbd?.['message']||_0x3e6dbd)),null;}}function getCachedGroupSize(_0x490847){const _0x57dd7e=_0x303c,_0x24ff9d=groupSizeCache[_0x57dd7e(0x120)](_0x490847);if(!_0x24ff9d)return null;if(Date['now']()>_0x24ff9d['expiresAt'])return groupSizeCache[_0x57dd7e(0x135)](_0x490847),null;return _0x24ff9d['size'];}function setCachedGroupSize(_0x17bcd3,_0x292e9a){const _0x2e91f2=_0x303c,_0x14686b={'yOjyZ':function(_0x165d4f,_0x3510b2){return _0x165d4f||_0x3510b2;}};groupSizeCache[_0x2e91f2(0x124)](_0x17bcd3,{'size':Number(_0x14686b['yOjyZ'](_0x292e9a,0x0)),'expiresAt':Date[_0x2e91f2(0x149)]()+(CFG['GROUP_SIZE_CACHE_TTL_MS']||DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'])});}async function resolveDisplayName(_0x3ee4bd){const _0x462ce9=_0x303c;try{if(!botRef||!_0x3ee4bd)return _0x3ee4bd?.['split']?.('@')?.[0x0]??_0x3ee4bd;try{if(typeof botRef['onWhatsApp']===_0x462ce9(0xff)){const _0x4eadaa=await botRef['onWhatsApp'](_0x3ee4bd);if(Array['isArray'](_0x4eadaa)&&_0x4eadaa['length']>0x0){const _0x4c0cc7=_0x4eadaa[0x0];if(_0x4c0cc7&&(_0x4c0cc7['notify']||_0x4c0cc7['vname']||_0x4c0cc7['name']))return _0x4c0cc7['notify']||_0x4c0cc7[_0x462ce9(0x116)]||_0x4c0cc7['name'];}}if(botRef['sock']&&typeof botRef['sock']['onWhatsApp']==='function'){const _0x4ab087=await botRef['sock']['onWhatsApp'](_0x3ee4bd);if(Array['isArray'](_0x4ab087)&&_0x4ab087['length']>0x0){const _0x4d3b01=_0x4ab087[0x0];if(_0x4d3b01&&(_0x4d3b01['notify']||_0x4d3b01['vname']||_0x4d3b01['name']))return _0x4d3b01['notify']||_0x4d3b01['vname']||_0x4d3b01['name'];}}}catch(_0x3b8bb5){}return String(_0x3ee4bd)['split']('@')[0x0]||_0x3ee4bd;}catch(_0x59e79e){return _0x3ee4bd?.['split']?.('@')?.[0x0]??_0x3ee4bd;}}async function sendWelcomeToMember(_0x4b5bc4,_0x24ecdd){const _0x40b9db=_0x303c,_0x19506b={'SFQPM':function(_0x381411,_0x5577a0){return _0x381411(_0x5577a0);},'EcIpg':function(_0x44201b,_0x2863f4){return _0x44201b!==_0x2863f4;},'GfWeO':function(_0x2465e6,_0x313d0e){return _0x2465e6(_0x313d0e);},'yYXKv':'function'};try{if(_0x19506b[_0x40b9db(0x12f)]('cfZFD','LpLDP')){const _0x40e63c=await _0x19506b['GfWeO'](getWelcomeFromDb,_0x4b5bc4);if(!_0x40e63c||!_0x40e63c['message'])return![];let _0x1ebe8c=await fetchGroupMetadata(_0x4b5bc4),_0x5d4936=_0x1ebe8c&&_0x1ebe8c['subject']?_0x1ebe8c['subject']:_0x4b5bc4,_0x26c15f=_0x19506b['GfWeO'](getCachedGroupSize,_0x4b5bc4);if(!_0x26c15f||_0x26c15f<=0x0){if(_0x1ebe8c&&Array['isArray'](_0x1ebe8c['participants']))_0x26c15f=_0x1ebe8c['participants']['length'];else{if(_0x1ebe8c&&typeof _0x1ebe8c['size']===_0x40b9db(0x100))_0x26c15f=_0x1ebe8c['size'];else{_0x1ebe8c=_0x1ebe8c||await fetchGroupMetadata(_0x4b5bc4);if(_0x1ebe8c&&Array['isArray'](_0x1ebe8c[_0x40b9db(0x144)]))_0x26c15f=_0x1ebe8c['participants'][_0x40b9db(0x118)];}}if(!_0x26c15f||_0x26c15f<=0x0)_0x26c15f=Number(_0x40e63c['last_size']||0x0);else setCachedGroupSize(_0x4b5bc4,_0x26c15f);}const _0x310efb=CFG['WHATSAPP_GROUP_MAX']||DEFAULTS['WHATSAPP_GROUP_MAX'],_0x546129=await resolveDisplayName(_0x24ecdd),_0x3b43e9='@'+String(_0x546129)['replace'](/\s+/g,'\x20'),_0x1d9ed9=[];_0x1d9ed9['push']('Hi\x20'+_0x3b43e9+'\x20Welcome\x20to\x20the\x20'+_0x5d4936),_0x1d9ed9[_0x40b9db(0x12b)](String(_0x40e63c['message'])['trim']()),_0x1d9ed9[_0x40b9db(0x12b)]('YOU\x27RE\x20MEMBER\x20'+_0x26c15f+'/'+_0x310efb);const _0x228820=_0x1d9ed9['join']('\x0a\x0a'),_0x3da2f9=[_0x24ecdd],_0x166b71=_0x40e63c['last_msg_id']||null,_0x2fa66d=await sendApiOrFallback(_0x4b5bc4,{'text':_0x228820},_0x3da2f9);let _0x5d8fa7=null;try{_0x2fa66d&&(_0x5d8fa7=_0x2fa66d?.['key']&&_0x2fa66d[_0x40b9db(0x129)]['id']?_0x2fa66d[_0x40b9db(0x129)]['id']:_0x2fa66d?.['message']&&_0x2fa66d['message']?.['id']?_0x2fa66d['message']['id']:_0x2fa66d?.['id']?_0x2fa66d['id']:null);}catch(_0x1f017c){}if(_0x166b71&&_0x19506b[_0x40b9db(0x12f)](_0x166b71,_0x5d8fa7))try{if(botRef&&typeof botRef[_0x40b9db(0x13f)]===_0x19506b[_0x40b9db(0x151)])try{await botRef['sendMessage'](_0x4b5bc4,{'delete':{'id':_0x166b71,'remoteJid':_0x4b5bc4,'fromMe':!![]}}),info('[welcome]\x20deleted\x20previous\x20welcome\x20'+_0x166b71+'\x20in\x20'+_0x4b5bc4);}catch(_0x3010fe){if('PKFlS'!=='bvxUk')try{await botRef['sock']?.['sendMessage']?.(_0x4b5bc4,{'delete':{'id':_0x166b71,'remoteJid':_0x4b5bc4,'fromMe':!![]}}),info('[welcome]\x20deleted\x20previous\x20welcome\x20(sock)\x20'+_0x166b71+'\x20in\x20'+_0x4b5bc4);}catch(_0x37c3b2){warn('[welcome]\x20failed\x20to\x20delete\x20previous\x20welcome\x20'+_0x166b71+_0x40b9db(0x14b)+_0x4b5bc4+':\x20'+(_0x37c3b2?.['message']||_0x37c3b2));}else{if(_0x1c2675['has'](_0x968187)){try{_0x34a043(_0x7f4a11['get'](_0x583577));}catch(_0x4f9f50){}_0x3b1628['delete'](_0xd136b8);}_0x285180['delete'](_0x3fcf5a);}}}catch(_0x2e2e4a){warn('[welcome]\x20deletion\x20of\x20previous\x20message\x20failed:\x20'+(_0x2e2e4a?.[_0x40b9db(0x12e)]||_0x2e2e4a));}try{_0x5d8fa7?await updateLastMsgIdInDb(_0x4b5bc4,_0x5d8fa7):await updateLastMsgIdInDb(_0x4b5bc4,null);}catch(_0x552fe2){}const _0x4feccf=Number(_0x40e63c['last_size']||0x0);if(_0x26c15f&&_0x26c15f!==_0x4feccf)try{'WjZKK'===_0x40b9db(0x13c)?(await db['run']('UPDATE\x20welcomes\x20SET\x20last_size\x20=\x20?,\x20updated_at\x20=\x20?\x20WHERE\x20group_jid\x20=\x20?',[_0x26c15f,nowSec(),_0x4b5bc4]),setCachedGroupSize(_0x4b5bc4,_0x26c15f)):hNvvig[_0x40b9db(0x139)](_0x444c45,'0');}catch(_0xcaf730){}return info('[welcome]\x20sent\x20welcome\x20to\x20'+_0x24ecdd+'\x20in\x20'+_0x4b5bc4),!![];}else{_0x40c3cb(_0x40b9db(0x125));try{_0x9f1b1e();}catch(_0x30630a){}_0x1a6195();}}catch(_0x52fa7a){return warn('[welcome]\x20sendWelcomeToMember\x20failed:\x20'+(_0x52fa7a?.[_0x40b9db(0x12e)]||_0x52fa7a)),![];}}async function flushGroup(_0x3e8210){const _0x11bb0a=_0x303c,_0x1c2439={'ImZsI':function(_0xe21833,_0x38a912){return _0xe21833(_0x38a912);}};try{const _0xb6a2ee=groupQueues['get'](_0x3e8210);if(!_0xb6a2ee||_0xb6a2ee['size']===0x0){if(groupTimers['has'](_0x3e8210)){try{_0x1c2439['ImZsI'](clearTimeout,groupTimers[_0x11bb0a(0x120)](_0x3e8210));}catch(_0x3b474f){}groupTimers['delete'](_0x3e8210);}groupQueues[_0x11bb0a(0x135)](_0x3e8210);return;}const _0x194229=Array[_0x11bb0a(0x113)](_0xb6a2ee);for(const _0x57b77c of _0x194229){try{await sendWelcomeToMember(_0x3e8210,_0x57b77c)['catch'](()=>{});}catch(_0x582b45){_0x1c2439['ImZsI'](warn,'[welcome]\x20flushGroup\x20item\x20failed:\x20'+(_0x582b45?.[_0x11bb0a(0x12e)]||_0x582b45));}}}catch(_0x11c3c3){warn('[welcome]\x20flushGroup\x20error:\x20'+(_0x11c3c3?.['message']||_0x11c3c3));}finally{if(groupTimers['has'](_0x3e8210)){try{clearTimeout(groupTimers[_0x11bb0a(0x120)](_0x3e8210));}catch(_0x26d212){}groupTimers[_0x11bb0a(0x135)](_0x3e8210);}groupQueues['delete'](_0x3e8210);}}async function gpUpdateHandler(_0x5579eb){const _0x2cea8f=_0x303c;try{if(!_0x5579eb)return;const _0x1ac692=(_0x5579eb[_0x2cea8f(0x108)]||_0x5579eb['type']||'')['toString']()['toLowerCase']();if(_0x1ac692!==_0x2cea8f(0x115)&&_0x1ac692!==_0x2cea8f(0xfa))return;const _0x540c1b=_0x5579eb['id']||_0x5579eb['groupId']||_0x5579eb['jid']||_0x5579eb['groupJid'];if(!_0x540c1b)return;const _0x41367c=Array['isArray'](_0x5579eb[_0x2cea8f(0x144)])?_0x5579eb['participants']:Array['isArray'](_0x5579eb['participants_added'])?_0x5579eb['participants_added']:[];if(!_0x41367c||_0x41367c['length']===0x0)return;let _0x3f402b=[];if(_0x41367c['length']===0x1)_0x3f402b=[_0x41367c[0x0]];else{const _0x1de011=_0x41367c[_0x41367c[_0x2cea8f(0x118)]-0x1];_0x3f402b=[_0x1de011];}if(!groupQueues[_0x2cea8f(0x14f)](_0x540c1b))groupQueues['set'](_0x540c1b,new Set());const _0x36c00b=groupQueues['get'](_0x540c1b);for(const _0x763388 of _0x3f402b)_0x36c00b['add'](_0x763388);if(groupTimers['has'](_0x540c1b))try{clearTimeout(groupTimers['get'](_0x540c1b));}catch(_0x3a7390){}const _0x249173=Math['max'](0x64,Number(CFG['DEBOUNCE_MS']||DEFAULTS['DEBOUNCE_MS'])),_0x3d8481=setTimeout(()=>{const _0xff11ea=_0x2cea8f;flushGroup(_0x540c1b)['catch'](_0x5a8fef=>warn('[welcome]\x20flushGroup\x20failed:\x20'+(_0x5a8fef?.[_0xff11ea(0x12e)]||_0x5a8fef)));},_0x249173);groupTimers['set'](_0x540c1b,_0x3d8481);}catch(_0x5727b7){warn(_0x2cea8f(0x10b)+(_0x5727b7?.[_0x2cea8f(0x12e)]||_0x5727b7));}}function attachWelcomeListener(){const _0x53c514=_0x303c,_0xa8e733={'FUQnU':'[welcome]\x20attachWelcomeListener\x20failed:\x20'};try{if(!botRef||!botRef['sock']||!botRef['sock']['ev'])return![];try{if(listener&&typeof botRef['sock']['ev']['off']==='function')botRef['sock']['ev']['off']('group-participants.update',listener);if(listener&&typeof botRef['sock']['ev']['removeListener']===_0x53c514(0xff))botRef['sock']['ev']['removeListener']('group-participants.update',listener);}catch(_0x1cf4dc){}return listener=gpUpdateHandler,typeof botRef['sock']['ev']['on']==='function'?(botRef[_0x53c514(0x104)]['ev']['on']('group-participants.update',listener),attached=!![],lastSockIdentity=botRef['sock'],info('[welcome]\x20attached\x20to\x20sock.ev.group-participants.update'),!![]):(warn('[welcome]\x20botRef.sock.ev\x20does\x20not\x20support\x20.on'),![]);}catch(_0x34913d){return warn(_0xa8e733['FUQnU']+(_0x34913d?.['message']||_0x34913d)),attached=![],listener=null,![];}}function detachWelcomeListener(){const _0x1b94ab=_0x303c,_0x36be38={'BQtpj':'group-participants.update'};try{if(!listener)return;if(botRef&&botRef[_0x1b94ab(0x104)]&&botRef['sock']['ev']){if('jQaEu'===_0x1b94ab(0xfe))_0x4dee27['sock']['ev']['off']?.(_0x1b94ab(0x134),_0x2b4157);else try{botRef[_0x1b94ab(0x104)]['ev'][_0x1b94ab(0x102)]?.(_0x36be38['BQtpj'],listener);}catch(_0x20cbe9){try{botRef['sock']['ev']['removeListener']?.('group-participants.update',listener);}catch(_0x3ac8b0){}}}}catch(_0x33d4af){warn(_0x1b94ab(0x11d)+(_0x33d4af?.[_0x1b94ab(0x12e)]||_0x33d4af));}finally{attached=![],listener=null,lastSockIdentity=null,info('[welcome]\x20detached\x20listener\x20if\x20present');}}function startAttachWatcher(){const _0x488208={'Jcmwp':function(_0x3f085a,_0x49cc6d){return _0x3f085a+_0x49cc6d;},'uROGR':'[welcome]\x20attach\x20watcher\x20error:\x20','EkFIa':function(_0x5655ae){return _0x5655ae();}};_0x488208['EkFIa'](stopAttachWatcher),attachWatcherInterval=setInterval(()=>{const _0x599738=_0x303c;try{if(!botRef)return;if(!attached&&botRef&&botRef[_0x599738(0x104)]&&botRef['sock']['ev'])attachWelcomeListener();}catch(_0x3e78d0){warn(_0x488208['Jcmwp'](_0x488208['uROGR'],_0x3e78d0?.['message']||_0x3e78d0));}},CFG['ATTACH_WATCHER_MS']||DEFAULTS['ATTACH_WATCHER_MS']);}function stopAttachWatcher(){attachWatcherInterval&&(clearInterval(attachWatcherInterval),attachWatcherInterval=null);}function startSockMonitor(){const _0x59c5f7={'fxguh':'[welcome]\x20detected\x20botRef.sock\x20change\x20-\x20re-attaching\x20listener','tgMpA':function(_0x469cda){return _0x469cda();}};_0x59c5f7['tgMpA'](stopSockMonitor),sockMonitorInterval=setInterval(()=>{try{if(!botRef)return;const _0x16508e=botRef['sock']||null;if(_0x16508e&&lastSockIdentity&&_0x16508e!==lastSockIdentity){info(_0x59c5f7['fxguh']);try{'OqPEi'!=='OqPEi'?_0x9f2873('[welcome]\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x34f77?.['message']||_0x3c13ec)):detachWelcomeListener();}catch(_0x2a76e3){}attachWelcomeListener();}else!lastSockIdentity&&_0x16508e&&attachWelcomeListener();}catch(_0x27385d){'WQUeV'!=='WQUeV'?_0x107e95=_0x18f223:warn('[welcome]\x20sock\x20monitor\x20error:\x20'+(_0x27385d?.['message']||_0x27385d));}},CFG['SOCK_MONITOR_MS']||DEFAULTS['SOCK_MONITOR_MS']);}function stopSockMonitor(){sockMonitorInterval&&(clearInterval(sockMonitorInterval),sockMonitorInterval=null);}function startConnectionUpdateHook(){const _0x547053={'zgNbg':function(_0x4bf24a,_0x5e17e7){return _0x4bf24a(_0x5e17e7);}};if(!botRef||!botRef['sock']||!botRef['sock']['ev'])return;if(connectionUpdateHandler)return;connectionUpdateHandler=_0x1a819f=>{const _0x132eda=_0x303c,_0x17ee6f={'QcsEz':function(_0x27e3ed){return _0x27e3ed();}};try{setTimeout(()=>{try{info('[welcome]\x20connection.update\x20observed\x20-\x20ensuring\x20listener\x20attached'),_0x17ee6f['QcsEz'](attachWelcomeListener);}catch(_0xf3eb9){}},0x1f4);}catch(_0x1246ad){warn('[welcome]\x20connection.update\x20handler\x20error:\x20'+(_0x1246ad?.[_0x132eda(0x12e)]||_0x1246ad));}};try{botRef['sock']['ev']['on']?.('connection.update',connectionUpdateHandler);}catch(_0x1be4ff){_0x547053['zgNbg'](warn,'[welcome]\x20failed\x20to\x20hook\x20connection.update:\x20'+(_0x1be4ff?.['message']||_0x1be4ff));}}function stopConnectionUpdateHook(){const _0x151c2c=_0x303c;try{if(connectionUpdateHandler&&botRef&&botRef['sock']&&botRef['sock']['ev'])try{botRef['sock']['ev']['off']?.('connection.update',connectionUpdateHandler);}catch(_0x1c15cb){try{botRef['sock']['ev'][_0x151c2c(0x107)]?.('connection.update',connectionUpdateHandler);}catch(_0xbebc3a){}}}catch(_0x13aa9e){}connectionUpdateHandler=null;}export async function initialize(_0x23488f){const _0xc6af7a=_0x303c,_0x398253={'jYSCr':function(_0x57205a,_0x95ae7f){return _0x57205a(_0x95ae7f);},'ZWdUJ':function(_0xeaa8c0,_0x4d0e8f){return _0xeaa8c0===_0x4d0e8f;},'lhPVh':function(_0xe5762e,_0x27a211){return _0xe5762e(_0x27a211);},'YiNwM':_0xc6af7a(0x146),'cErbm':'[welcome]\x20config\x20load\x20failed,\x20using\x20defaults','Voity':function(_0x30c1be,_0x1d6698){return _0x30c1be(_0x1d6698);},'sxETd':function(_0x4a8e86){return _0x4a8e86();}};if(!_0x23488f)throw new Error(_0xc6af7a(0x12d));botRef=_0x23488f,setupSendApi();try{const _0xd137e8=getConfig()||{},_0x373cf3=_0xd137e8&&_0xd137e8[_0xc6af7a(0x148)]?_0xd137e8['WELCOME']:{};CFG['DEFAULT_ENABLED']=typeof _0x373cf3[_0xc6af7a(0x11c)]===_0x398253[_0xc6af7a(0x143)]?_0x373cf3['DEFAULT_ENABLED']:DEFAULTS['DEFAULT_ENABLED'],CFG['GROUP_SIZE_CACHE_TTL_MS']=Number['isInteger'](_0x373cf3['GROUP_SIZE_CACHE_TTL_MS'])?_0x373cf3['GROUP_SIZE_CACHE_TTL_MS']:DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'],CFG['WHATSAPP_GROUP_MAX']=Number[_0xc6af7a(0x101)](_0x373cf3[_0xc6af7a(0x14a)])?_0x373cf3[_0xc6af7a(0x14a)]:DEFAULTS['WHATSAPP_GROUP_MAX'],CFG['DEBOUNCE_MS']=Number['isInteger'](_0x373cf3['DEBOUNCE_MS'])?_0x373cf3['DEBOUNCE_MS']:DEFAULTS['DEBOUNCE_MS'],CFG['ATTACH_WATCHER_MS']=Number['isInteger'](_0x373cf3['ATTACH_WATCHER_MS'])?_0x373cf3[_0xc6af7a(0x12a)]:DEFAULTS[_0xc6af7a(0x12a)],CFG['SOCK_MONITOR_MS']=Number['isInteger'](_0x373cf3['SOCK_MONITOR_MS'])?_0x373cf3['SOCK_MONITOR_MS']:DEFAULTS['SOCK_MONITOR_MS'];}catch(_0xad638d){warn(_0x398253['cErbm']),CFG={...DEFAULTS};}try{hotReloadConfig&&hotReloadConfig(_0x161a3a=>{const _0x11ddd7=_0xc6af7a;if('ouALS'==='qnpOL')return _0x398253['jYSCr'](_0x409328,_0x11ddd7(0x111)+(_0x213585?.['message']||_0x2e8238)),_0x3c9348=![],_0x526300=null,![];else try{const _0x546432=getConfig()||{},_0x3035ee=_0x546432&&_0x546432['WELCOME']?_0x546432['WELCOME']:{};CFG['DEFAULT_ENABLED']=_0x398253['ZWdUJ'](typeof _0x3035ee[_0x11ddd7(0x11c)],'boolean')?_0x3035ee[_0x11ddd7(0x11c)]:DEFAULTS['DEFAULT_ENABLED'],CFG['GROUP_SIZE_CACHE_TTL_MS']=Number[_0x11ddd7(0x101)](_0x3035ee['GROUP_SIZE_CACHE_TTL_MS'])?_0x3035ee['GROUP_SIZE_CACHE_TTL_MS']:DEFAULTS[_0x11ddd7(0x133)],CFG['WHATSAPP_GROUP_MAX']=Number[_0x11ddd7(0x101)](_0x3035ee[_0x11ddd7(0x14a)])?_0x3035ee['WHATSAPP_GROUP_MAX']:DEFAULTS['WHATSAPP_GROUP_MAX'],CFG['DEBOUNCE_MS']=Number['isInteger'](_0x3035ee['DEBOUNCE_MS'])?_0x3035ee['DEBOUNCE_MS']:DEFAULTS[_0x11ddd7(0x11e)],CFG['ATTACH_WATCHER_MS']=Number['isInteger'](_0x3035ee['ATTACH_WATCHER_MS'])?_0x3035ee['ATTACH_WATCHER_MS']:DEFAULTS['ATTACH_WATCHER_MS'],CFG['SOCK_MONITOR_MS']=Number['isInteger'](_0x3035ee['SOCK_MONITOR_MS'])?_0x3035ee[_0x11ddd7(0x11f)]:DEFAULTS['SOCK_MONITOR_MS'],_0x398253['lhPVh'](info,'[welcome]\x20hotReloadConfig\x20applied.\x20Changed\x20keys:\x20'+(_0x161a3a||[])['join'](',\x20'));}catch(_0x20eccd){warn('[welcome]\x20hotReloadConfig\x20handler\x20error:\x20'+(_0x20eccd?.['message']||_0x20eccd));}});}catch(_0xb171ff){_0x398253['Voity'](warn,_0xc6af7a(0x127)+(_0xb171ff?.[_0xc6af7a(0x12e)]||_0xb171ff));}try{await _0x398253['sxETd'](ensureSchema);try{attachWelcomeListener(),startConnectionUpdateHook(),startAttachWatcher(),startSockMonitor(),info('[welcome]\x20initialized\x20with\x20session\x20resilience');}catch(_0x54fb5f){error('[welcome]\x20failed\x20to\x20attach\x20listener\x20(will\x20keep\x20watching):\x20'+(_0x54fb5f?.['message']||_0x54fb5f));}}catch(_0xd0e03){error(_0xd0e03,'[welcome]\x20initialize\x20fatal:\x20'+(_0xd0e03?.['message']||_0xd0e03));throw _0xd0e03;}}export async function onMessage(_0x15f434){const _0x237a23=_0x303c,_0xd4e870={'mkDda':function(_0x30757c,_0x2d5388){return _0x30757c(_0x2d5388);},'XkUjS':function(_0x185d88,_0x475006){return _0x185d88(_0x475006);},'FTZZj':function(_0x5dbb6a,_0x2035b6){return _0x5dbb6a===_0x2035b6;},'ACxPD':function(_0x1e8ab9,_0x54341c,_0x47b374){return _0x1e8ab9(_0x54341c,_0x47b374);}};try{if(!_0x15f434||!_0x15f434['key']||!_0x15f434[_0x237a23(0x12e)])return;const _0x2690b6=_0xd4e870['mkDda'](String,_0x15f434[_0x237a23(0x129)]['remoteJid']||'')+'::'+String(_0x15f434['key']['id']||_0x15f434['key']['participant']||'');if(isProcessed(_0x2690b6))return;markProcessed(_0x2690b6);if(!_0x15f434['isCommand'])return;const _0x584927=typeof _0x15f434[_0x237a23(0x10c)]==='string'&&_0x15f434['text']['trim']()['length']?_0x15f434['text'][_0x237a23(0x11a)]():(extractTextFromMessage(_0x15f434)||'')['trim']();if(!_0x584927)return;const _0x4de4dc=(_0x584927[_0x237a23(0x14e)](/\s+/)[0x0]||'')['toLowerCase']();if(!commands['includes'](_0x4de4dc))return;const _0x32507f=_0x15f434['key']['remoteJid'],_0x3cbe04=typeof _0x32507f==='string'&&_0x32507f[_0x237a23(0x10f)]('@g.us');if(!_0x3cbe04)return;let _0x3cdc4d=![];try{_0x3cdc4d=await isadmin(botRef,_0x15f434);}catch(_0xf8168d){_0xd4e870['mkDda'](warn,_0x237a23(0x12c)),_0x3cdc4d=![];}if(!_0x3cdc4d)return;const _0x5de4b2=_0x15f434['key']?.['participant']||_0x15f434['key']?.['from']||_0x15f434['key']?.['remoteJid']||'',_0x466558=_0xd4e870[_0x237a23(0x114)](String,_0x5de4b2||'')['split']('@')[0x0],_0x289f4f=_0x32507f;info('[welcome]\x20command\x20\x27'+_0x4de4dc+'\x27\x20detected\x20from\x20'+_0x5de4b2+'\x20in\x20'+_0x32507f);const _0x644bf5=(_0x584927||'')['split'](/\r?\n/)['map'](_0x2343c6=>_0x2343c6['trim']());let _0x31c6d1=null;for(const _0x2ae0e1 of _0x644bf5['slice'](0x1)){const _0x5a49ee=_0x2ae0e1['match'](/^gp[:\s]+(.+)$/i);if(_0x5a49ee){_0x31c6d1=_0x5a49ee[0x1]['trim']();break;}}const _0x4233d8=(_0x644bf5[0x0]||'')['trim']()['split'](/\s+/);if(!_0x31c6d1&&_0x4233d8['length']>=0x2){if(_0xd4e870['FTZZj'](_0x4233d8[0x1]['toLowerCase'](),'gp')&&_0x4233d8['length']>=0x3)_0x31c6d1=_0x4233d8['slice'](0x2)['join']('\x20')['trim']();else{if(_0x4233d8[0x1]['includes']('@'))_0x31c6d1=_0x4233d8[0x1]['trim']();}}const _0x1938fc=await getDefault(_0x466558)['catch'](()=>null);if(!_0x1938fc){await sendApiOrFallback(_0x289f4f,'No\x20default\x20connection/group\x20is\x20set\x20for\x20you.\x20Commands\x20must\x20apply\x20to\x20your\x20DEFAULT\x20group.\x20Set\x20with:\x20/setdefault\x20<connectionName>');return;}const _0x52a844=await getConnection(_0x1938fc)['catch'](()=>null);if(!_0x52a844){await sendApiOrFallback(_0x289f4f,'Could\x20not\x20resolve\x20your\x20default\x20connection\x20\x27'+_0x1938fc+'\x27.\x20Please\x20check\x20/setdefault\x20value.');return;}if(_0x4de4dc==='wlc'){const _0x375b3e=_0x644bf5[_0x237a23(0x138)](0x1)['filter'](_0x4dec4a=>!_0x4dec4a[_0x237a23(0x110)](/^gp[:\s]+(.+)$/i)),_0x1fe5bc=_0x375b3e['join']('\x0a')['trim']();if(!_0x1fe5bc){await sendApiOrFallback(_0x289f4f,'Usage\x20(group-only,\x20admin-only):\x0awlc\x0a<your\x20multi-line\x20welcome\x20message>\x0aOptionally\x20include\x20a\x20line\x20\x22gp\x20<groupKey>\x22\x20but\x20it\x20will\x20be\x20ignored\x20—\x20welcome\x20saved\x20to\x20your\x20DEFAULT\x20connection.');return;}_0x31c6d1&&await sendApiOrFallback(_0x289f4f,'Notice:\x20\x27gp\x27\x20parameter\x20in\x20command\x20is\x20ignored.\x20Welcome\x20will\x20be\x20saved\x20to\x20your\x20default\x20connection:\x20'+_0x52a844);let _0x104048=await fetchGroupMetadata(_0x52a844),_0x5a8b40=null;if(_0x104048&&Array['isArray'](_0x104048[_0x237a23(0x144)]))_0x5a8b40=_0x104048['participants'][_0x237a23(0x118)];else{if(_0x104048&&typeof _0x104048['size']==='number')_0x5a8b40=_0x104048['size'];}const _0x163a5b=await getWelcomeFromDb(_0x52a844),_0xfbafec=_0x163a5b?Number(_0x163a5b['last_size']||0x0):0x0,_0x14b586=_0x5a8b40&&_0x5a8b40>0x0?_0x5a8b40:_0xfbafec,_0x3a241e=await saveWelcomeToDb(_0x52a844,_0x1fe5bc,_0x14b586,_0x163a5b&&_0x163a5b['last_msg_id']?_0x163a5b['last_msg_id']:null);if(_0x3a241e){if('sfxuE'!=='onRQW'){if(_0x14b586&&_0x14b586>0x0)setCachedGroupSize(_0x52a844,_0x14b586);await sendApiOrFallback(_0x289f4f,'Saved\x20welcome\x20message\x20to\x20your\x20default\x20connection:\x20'+_0x52a844);}else return _0x47d88f('[welcome]\x20sendWelcomeToMember\x20failed:\x20'+(_0x1cba08?.[_0x237a23(0x12e)]||_0x310ff4)),![];}else await sendApiOrFallback(_0x289f4f,'Failed\x20to\x20save\x20welcome\x20message\x20for:\x20'+_0x52a844);return;}if(_0x4de4dc==='delwlc'){_0x31c6d1&&await _0xd4e870['ACxPD'](sendApiOrFallback,_0x289f4f,'Notice:\x20\x27gp\x27\x20parameter\x20in\x20command\x20is\x20ignored.\x20Deleting\x20welcome\x20for\x20your\x20default\x20connection:\x20'+_0x52a844);const _0x4e1910=await deleteWelcomeFromDb(_0x52a844);_0x4e1910?(groupSizeCache['delete'](_0x52a844),await sendApiOrFallback(_0x289f4f,'Deleted\x20welcome\x20message\x20for\x20'+_0x52a844)):await sendApiOrFallback(_0x289f4f,_0x237a23(0x152)+_0x52a844);return;}return;}catch(_0x585746){error(_0x585746,'[welcome]\x20onMessage\x20error:\x20'+(_0x585746?.['message']||_0x585746));}}export async function cleanup(){const _0x86f0ad=_0x303c,_0x1b2189={'RLBAX':function(_0x313028){return _0x313028();},'zmWPp':_0x86f0ad(0x122)};try{for(const _0x404668 of groupTimers['values']())try{clearTimeout(_0x404668);}catch(_0x23f14a){}groupTimers['clear'](),groupQueues[_0x86f0ad(0x117)](),groupSizeCache['clear'](),stopAttachWatcher(),stopSockMonitor(),_0x1b2189[_0x86f0ad(0x145)](stopConnectionUpdateHook),detachWelcomeListener();for(const _0x1e6c7b of processedMessageKeys['values']())try{clearTimeout(_0x1e6c7b);}catch(_0x27e632){}processedMessageKeys['clear']();}catch(_0x4ab261){warn('[welcome]\x20cleanup\x20error:\x20'+(_0x4ab261?.['message']||_0x4ab261));}finally{attached=![],listener=null,botRef=null,sendApi=null,info(_0x1b2189['zmWPp']);}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x4252c6(_0x46cb53){const _0x414be4=_0x303c,_0x34b567={'OrHcF':function(_0x16d59b){return _0x16d59b();},'crCYP':function(_0x160be9,_0x443a98){return _0x160be9+_0x443a98;},'eVIwE':function(_0x3fd1e4,_0x4e119a){return _0x3fd1e4===_0x4e119a;}};function _0x14d94b(_0x44445b){const _0x56cfaa=_0x303c,_0x23041e={'Jbnhm':function(_0x10bf23,_0x524e96){return _0x10bf23(_0x524e96);},'aiVFV':function(_0x324147){return _0x34b567['OrHcF'](_0x324147);}};if(typeof _0x44445b==='string')return'BkVtT'==='BkVtT'?function(_0x4001ae){}['constructor']('while\x20(true)\x20{}')['apply']('counter'):function(_0x4d3999){}[_0x56cfaa(0x105)]('while\x20(true)\x20{}')['apply']('counter');else{if('kcrWi'!=='kcrWi'){const _0x1b9de4=_0x56cfaa(0x121)['split']('|');let _0x10b285=0x0;while(!![]){switch(_0x1b9de4[_0x10b285++]){case'0':_0x23041e['Jbnhm'](_0x7c09af,'[welcome]\x20initialized\x20with\x20session\x20resilience');continue;case'1':_0x218d53();continue;case'2':_0x23041e[_0x56cfaa(0x106)](_0x55e5d);continue;case'3':_0x961481();continue;case'4':_0x35f46c();continue;}break;}}else _0x34b567['crCYP']('',_0x44445b/_0x44445b)['length']!==0x1||_0x34b567[_0x56cfaa(0x131)](_0x44445b%0x14,0x0)?function(){return!![];}['constructor']('debu'+'gger')['call']('action'):function(){return![];}[_0x56cfaa(0x105)]('debu'+'gger')['apply']('stateObject');}_0x14d94b(++_0x44445b);}try{if(_0x414be4(0x136)==='ANRNN'){if(_0x46cb53)return _0x14d94b;else _0x14d94b(0x0);}else _0x36db6e(_0x22d904['get'](_0x44448c));}catch(_0x181169){}}