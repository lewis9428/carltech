function _0x4ef4(){const _0x7c82c1=['yxbWBhK','nda5otm3nMvws21jvW','D2HPBguGkhrYDwuPihT9','uNzty2u','w3DLBgnVBwvDihnVy2SGBw9UAxrVCIbLCNjVCJOG','CMvTB3zLtgLZDgvUzxi','z2v0','A2v5','DM5HBwu','C2LUz2XLu2vSzwn0uMvWBhK','w3DLBgnVBwvDigrLBgv0zwqGChjLDMLVDxmGD2vSy29TzsaOC29JAYKG','vgX6r1K','B25xAgf0C0fWCa','BwvUDgLVBNm','Bwf0y2G','w3DLBgnVBwvDigDLDfDLBgnVBwvgCM9TrgiGzMfPBgvKoIa','yNv0Dg9UC1jLC3bVBNnLtwvZC2fNzq','zNvUy3rPB24GkLWOicPCkq','BwDfALK','zxH0zw5KzwruzxH0twvZC2fNzq','w3DLBgnVBwvDignSzwfUDxaGzxjYB3i6ia','AM9PBG','r1jpvvbFu0LArv9dqunirv9uveXFtvm','w3DLBgnVBwvDihnHDMvxzwXJB21Lvg9eyIbMywLSzwq6ia','Bg5sCMC','BwvZC2fNzq','C2vUze1LC3nHz2u','mtjLChDou24','w3DLBgnVBwvDignVBM5Ly3rPB24UDxbKyxrLig9IC2vYDMvKic0Gzw5ZDxjPBMCGBgLZDgvUzxiGyxr0ywnOzwq','Dgv4Da','revgqvvmvf9ftKfcteve','C2v0sw50zxj2ywW','w3DLBgnVBwvDignVBMzPzYbSB2fKigzHAwXLzcWGDxnPBMCGzgvMyxvSDhm','v0vmq09nrq','AhjrsLq','BgfZDf9ZAxPL','AgfZ','w3DLBgnVBwvDigHVDfjLBg9HzenVBMzPzYbOyw5KBgvYigvYCM9YoIa','AxnjBNrLz2vY','oeLIDLL3AG','y29UDMvYC2f0Aw9U','z3jVDxbnzxrHzgf0yq','ntaWEK5JrevM','CNvU','Aw5WDxq','tM8GD2vSy29TzsbTzxnZywDLigzVDw5KigzVCIa','vurltLm','mZGYmJuYmgfRy2PIAW','mte3otCZnZbIBuT2te0','C29JAW','revct1voq0vFtvm','y2fWDgLVBG','zMLSDgvY','qvruqunix1DbvenirvjFtvm','DMfSDwvZ','CMvWBgfJzq','otK3ndGYnxvbD3j1vq','C3bSAxq','uNjHqKy','zejLCfO','z2DLCG','ndqZnK53BKjWBa','tM8GzgvMyxvSDcbJB25Uzwn0Aw9Ul2DYB3vWigLZihnLDcbMB3iGEw91lIbdB21Tyw5KCYbTDxn0igfWCgX5ihrVihLVDxiGrevgqvvmvcbNCM91Cc4Gu2v0ihDPDgG6ic9ZzxrKzwzHDwX0idXJB25Uzwn0Aw9UtMfTzt4','otK3mti5mw50revYua','mte1nJaYntDfsMnzrLe','y2XLyxi','DgvZDa','w3DLBgnVBwvDigzSDxnOr3jVDxaGzxjYB3i6ia','DhjPBq','BM93','twXwEKK','C2L6zq','zMXVB3i','m3Pdq2HmyW','AxnbCNjHEq','CgfYDgLJAxbHBNrZ','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','DxLHy1u','BgvUz3rO','BgLZDfjLC3bVBNnLtwvZC2fNzq','C2v0','B2zM','v0HbvfnbufbFr1jpvvbFtufy','y2f0y2G','w3DLBgnVBwvDigrLDgvJDgvKigjVDfjLzI5ZB2nRignOyw5NzsaTihjLlwf0DgfJAgLUzYbSAxn0zw5LCG','ChvZAa','u09ds19nt05jve9sx01t','ywrK','BMfTzq','Dg9mB3DLCKnHC2u','Egjiy1m','zgvSzxrL'];_0x4ef4=function(){return _0x7c82c1;};return _0x4ef4();}(function(_0x22d8c1,_0x2b215d){const _0x240942=_0x38c2,_0xef1b98=_0x22d8c1();while(!![]){try{const _0x2a5d7f=parseInt(_0x240942(0xf7))/0x1*(parseInt(_0x240942(0xe4))/0x2)+parseInt(_0x240942(0x103))/0x3*(-parseInt(_0x240942(0xbb))/0x4)+parseInt(_0x240942(0xe9))/0x5*(-parseInt(_0x240942(0xd5))/0x6)+parseInt(_0x240942(0xf2))/0x7+parseInt(_0x240942(0xe1))/0x8*(parseInt(_0x240942(0xfa))/0x9)+-parseInt(_0x240942(0xea))/0xa+parseInt(_0x240942(0xf9))/0xb;if(_0x2a5d7f===_0x2b215d)break;else _0xef1b98['push'](_0xef1b98['shift']());}catch(_0x592349){_0xef1b98['push'](_0xef1b98['shift']());}}}(_0x4ef4,0xf206c));const _0x31cf92=(function(){let _0x43398d=!![];return function(_0x46057b,_0x1c2a9a){const _0x1b4b6d=_0x43398d?function(){if(_0x1c2a9a){const _0x11e443=_0x1c2a9a['apply'](_0x46057b,arguments);return _0x1c2a9a=null,_0x11e443;}}:function(){};return _0x43398d=![],_0x1b4b6d;};}());(function(){const _0x5c9a=_0x38c2,_0x2c3ed5={'TlzGY':function(_0x1ff330,_0x157197){return _0x1ff330+_0x157197;},'BECaf':_0x5c9a(0xe6)};_0x31cf92(this,function(){const _0x28c1c0=_0x5c9a,_0xf097d6=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x44d1fd=new RegExp('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x1cb08c=_0x8416b4('init');!_0xf097d6['test'](_0x2c3ed5[_0x28c1c0(0xc5)](_0x1cb08c,'chain'))||!_0x44d1fd[_0x28c1c0(0xfc)](_0x1cb08c+_0x2c3ed5['BECaf'])?_0x1cb08c('0'):_0x8416b4();})();}());import{info,warn,error}from'../utils/logger.js';import{getConfig,hotReloadConfig}from'../utils/config.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{getDefault,getConnection}from'../utils/connection.js';function _0x38c2(_0x39b049,_0x1c5136){const _0x3c24a7=_0x4ef4();return _0x38c2=function(_0x8416b4,_0x31cf92){_0x8416b4=_0x8416b4-0xb3;let _0x4e0cdc=_0x3c24a7[_0x8416b4];if(_0x38c2['qoLVqG']===undefined){var _0x5579ff=function(_0x1753c0){const _0x3be57a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x28033c='',_0xb30fb5='';for(let _0x1fc415=0x0,_0x2b0e3f,_0x71a201,_0x546b36=0x0;_0x71a201=_0x1753c0['charAt'](_0x546b36++);~_0x71a201&&(_0x2b0e3f=_0x1fc415%0x4?_0x2b0e3f*0x40+_0x71a201:_0x71a201,_0x1fc415++%0x4)?_0x28033c+=String['fromCharCode'](0xff&_0x2b0e3f>>(-0x2*_0x1fc415&0x6)):0x0){_0x71a201=_0x3be57a['indexOf'](_0x71a201);}for(let _0xab43b5=0x0,_0x3cbca3=_0x28033c['length'];_0xab43b5<_0x3cbca3;_0xab43b5++){_0xb30fb5+='%'+('00'+_0x28033c['charCodeAt'](_0xab43b5)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0xb30fb5);};_0x38c2['JikHdK']=_0x5579ff,_0x39b049=arguments,_0x38c2['qoLVqG']=!![];}const _0x4ef4a6=_0x3c24a7[0x0],_0x38c219=_0x8416b4+_0x4ef4a6,_0x389ba4=_0x39b049[_0x38c219];return!_0x389ba4?(_0x4e0cdc=_0x38c2['JikHdK'](_0x4e0cdc),_0x39b049[_0x38c219]=_0x4e0cdc):_0x4e0cdc=_0x389ba4,_0x4e0cdc;},_0x38c2(_0x39b049,_0x1c5136);}export const name='welcome';export const version='2.2.1';export const priority=0x7a;export const configKeys=['WELCOME'];export const commands=['wlc','delwlc'];let botRef=null,attached=![],listener=null,sendApi=null,attachWatcherInterval=null,sockMonitorInterval=null,lastSockIdentity=null,connectionUpdateHandler=null;const DEFAULTS={'DEFAULT_ENABLED':!![],'GROUP_SIZE_CACHE_TTL_MS':0x5*0x3c*0x3e8,'WHATSAPP_GROUP_MAX':0x401,'DEBOUNCE_MS':0x7d0,'ATTACH_WATCHER_MS':0xbb8,'SOCK_MONITOR_MS':0x3e8};let CFG={...DEFAULTS};const groupQueues=new Map(),groupTimers=new Map(),groupSizeCache=new Map(),DEDUPE_TTL_MS=0x1e*0x3e8,processedMessageKeys=new Map();function markProcessed(_0x425ec0){const _0x9e8a3e=_0x38c2,_0xb63230={'dBepZ':function(_0x165947,_0x82de9a,_0x313c99){return _0x165947(_0x82de9a,_0x313c99);}};if(!_0x425ec0)return;if(processedMessageKeys['has'](_0x425ec0))try{clearTimeout(processedMessageKeys[_0x9e8a3e(0xc0)](_0x425ec0));}catch(_0xa31d95){}const _0x25c557=_0xb63230[_0x9e8a3e(0xf5)](setTimeout,()=>processedMessageKeys['delete'](_0x425ec0),DEDUPE_TTL_MS);processedMessageKeys[_0x9e8a3e(0x10a)](_0x425ec0,_0x25c557);}function isProcessed(_0x3e1ac4){const _0x1507de=_0x38c2;return _0x3e1ac4&&processedMessageKeys[_0x1507de(0xde)](_0x3e1ac4);}async function ensureSchema(){try{await db['exec']('\x0a\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20welcomes\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20group_jid\x20TEXT\x20PRIMARY\x20KEY,\x0a\x20\x20\x20\x20\x20\x20\x20\x20message\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_size\x20INTEGER\x20DEFAULT\x200,\x0a\x20\x20\x20\x20\x20\x20\x20\x20last_msg_id\x20TEXT\x20DEFAULT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20INTEGER\x20DEFAULT\x200\x0a\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20');try{await db['exec']('ALTER\x20TABLE\x20welcomes\x20ADD\x20COLUMN\x20last_msg_id\x20TEXT\x20DEFAULT\x20NULL;');}catch(_0x46c6cc){}info('[welcome]\x20DB\x20schema\x20ensured');}catch(_0x8977a7){error(_0x8977a7,'[welcome]\x20ensureSchema\x20failed');throw _0x8977a7;}}async function saveWelcomeToDb(_0x388d30,_0x2d8944,_0x3168eb=0x0,_0x560673=null){const _0x3960a3=_0x38c2,_0x6a0d53={'atpMR':function(_0x117cc4,_0x40714e){return _0x117cc4||_0x40714e;}};try{const _0x1b8176=Math[_0x3960a3(0x102)](Date['now']()/0x3e8);return await db[_0x3960a3(0xe5)]('INSERT\x20INTO\x20welcomes\x20(group_jid,\x20message,\x20last_size,\x20last_msg_id,\x20updated_at)\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(group_jid)\x20DO\x20UPDATE\x20SET\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x20=\x20excluded.message,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20last_size\x20=\x20excluded.last_size,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20last_msg_id\x20=\x20excluded.last_msg_id,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20updated_at\x20=\x20excluded.updated_at;',[_0x388d30,String(_0x6a0d53['atpMR'](_0x2d8944,'')),Number(_0x3168eb||0x0),_0x560673||null,_0x1b8176]),info('[welcome]\x20saved\x20welcome\x20for\x20'+_0x388d30),!![];}catch(_0x226e2e){return warn('[welcome]\x20saveWelcomeToDb\x20failed:\x20'+(_0x226e2e?.['message']||_0x226e2e)),![];}}async function deleteWelcomeFromDb(_0x1768cc){const _0x1cc270=_0x38c2,_0x3f03e3={'hFzyI':function(_0x50cbd8,_0x559697){return _0x50cbd8(_0x559697);}};try{const _0x95d544=await db[_0x1cc270(0xe5)]('DELETE\x20FROM\x20welcomes\x20WHERE\x20group_jid\x20=\x20?',[_0x1768cc]);return _0x3f03e3['hFzyI'](info,'[welcome]\x20deleted\x20welcome\x20for\x20'+_0x1768cc),_0x95d544?.['changes']||0x0;}catch(_0x5d6207){return warn('[welcome]\x20deleteWelcomeFromDb\x20failed:\x20'+(_0x5d6207?.['message']||_0x5d6207)),0x0;}}async function getWelcomeFromDb(_0x3a4151){const _0x17b5f6=_0x38c2;try{const _0x556ce0=await db['get']('SELECT\x20message,\x20last_size,\x20last_msg_id,\x20updated_at\x20FROM\x20welcomes\x20WHERE\x20group_jid\x20=\x20?',[_0x3a4151]);return _0x556ce0||null;}catch(_0x26d3a9){return warn(_0x17b5f6(0xc9)+(_0x26d3a9?.['message']||_0x26d3a9)),null;}}async function updateLastMsgIdInDb(_0x2a00e2,_0x1f92ba){const _0x461bc3=_0x38c2;try{const _0x412b6a=Math[_0x461bc3(0x102)](Date['now']()/0x3e8);return await db[_0x461bc3(0xe5)]('UPDATE\x20welcomes\x20SET\x20last_msg_id\x20=\x20?,\x20updated_at\x20=\x20?\x20WHERE\x20group_jid\x20=\x20?',[_0x1f92ba||null,_0x412b6a,_0x2a00e2]),!![];}catch(_0x1d0a8a){if('bQNdZ'==='cWuhA'){let _0x416f49;try{_0x416f49=_0x17ddf1('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x2a6728){_0x416f49=_0x1bf6e6;}return _0x416f49;}else return warn('[welcome]\x20updateLastMsgIdInDb\x20failed:\x20'+(_0x1d0a8a?.['message']||_0x1d0a8a)),![];}}function setupSendApi(){const _0x4463ec=_0x38c2;if(!botRef)return;if(typeof botRef[_0x4463ec(0xd4)]==='function')sendApi=async(_0x3db48b,_0x530dd1)=>await botRef['sendMessage'](_0x3db48b,_0x530dd1);else{if(botRef['sock']&&typeof botRef['sock'][_0x4463ec(0xd4)]==='function')sendApi=async(_0x187160,_0x71e3b1)=>await botRef['sock']['sendMessage'](_0x187160,_0x71e3b1);else{if('eTUBS'!=='KOjrm')sendApi=null;else{const _0x3a54b3=new _0x54a188(_0x4463ec(0xcb)),_0x3e238d=new _0x33a412('\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','i'),_0x457123=_0x17c3cb('init');!_0x3a54b3['test'](_0x457123+'chain')||!_0x3e238d['test'](_0x457123+'input')?_0x457123('0'):_0x5cb363();}}}}async function sendApiOrFallback(_0x415800,_0x20cccc,_0x2250d4=[]){const _0x5ef019=_0x38c2;try{if(!_0x415800||!_0x20cccc)return null;const _0x3cc04a=typeof _0x20cccc==='string'?{'text':String(_0x20cccc)}:_0x20cccc;if(Array['isArray'](_0x2250d4)&&_0x2250d4[_0x5ef019(0x108)])_0x3cc04a[_0x5ef019(0xc7)]=_0x2250d4;if(sendApi)try{const _0x263995=await sendApi(_0x415800,_0x3cc04a);return _0x263995;}catch(_0x261d17){return warn('[welcome]\x20sendApi\x20failed:\x20'+(_0x261d17?.['message']||_0x261d17)),null;}else return warn('[welcome]\x20no\x20send\x20surface\x20available\x20for\x20'+_0x415800),null;}catch(_0x5fccce){return warn('[welcome]\x20sendApiOrFallback\x20failed:\x20'+(_0x5fccce?.['message']||_0x5fccce)),null;}}function extractTextFromMessage(_0x41f98f){const _0x4477e2=_0x38c2;if(!_0x41f98f||!_0x41f98f['message'])return'';const _0x1d0f61=_0x41f98f['message'];if(_0x1d0f61[_0x4477e2(0xe2)])return _0x1d0f61[_0x4477e2(0xe2)];if(_0x1d0f61['extendedTextMessage']?.['text'])return _0x1d0f61[_0x4477e2(0xcd)]['text'];if(_0x1d0f61['imageMessage']?.['caption'])return _0x1d0f61['imageMessage']['caption'];if(_0x1d0f61['videoMessage']?.[_0x4477e2(0xed)])return _0x1d0f61['videoMessage'][_0x4477e2(0xed)];if(_0x1d0f61[_0x4477e2(0xca)]?.['selectedButtonId'])return _0x1d0f61[_0x4477e2(0xca)]['selectedButtonId'];if(_0x1d0f61[_0x4477e2(0x109)]?.['singleSelectReply']?.['selectedRowId'])return _0x1d0f61[_0x4477e2(0x109)][_0x4477e2(0xc3)]['selectedRowId'];return'';}function nowSec(){const _0xd09074=_0x38c2;return Math['floor'](Date[_0xd09074(0xff)]()/0x3e8);}async function resolveTargetChatIdFromCommand(_0x52957f,_0xdd12bb){const _0x5e07e2={'Hmvux':function(_0x2c23c9,_0x87a8d4){return _0x2c23c9(_0x87a8d4);}};if(_0x52957f){const _0x5c5b29=_0x52957f['trim']();if(_0x5c5b29['includes']('@'))return _0x5c5b29;const _0x98c25c=await getConnection(_0x5c5b29)['catch'](()=>null);if(_0x98c25c)return _0x98c25c;return null;}if(!_0xdd12bb)return null;const _0x45bb2b=await _0x5e07e2['Hmvux'](getDefault,_0xdd12bb)['catch'](()=>null);if(_0x45bb2b){const _0x259bad=await getConnection(_0x45bb2b)['catch'](()=>null);if(_0x259bad)return _0x259bad;}return null;}async function fetchGroupMetadata(_0x1b8de3){const _0x5c0e07=_0x38c2,_0x4dec5d={'YWGgg':function(_0x3a2de5){return _0x3a2de5();}};if(!botRef)return null;try{if(botRef['sock']&&typeof botRef['sock']['groupMetadata']==='function')return await botRef['sock']['groupMetadata'](_0x1b8de3);if(typeof botRef[_0x5c0e07(0xe3)]==='function')return await botRef['groupMetadata'](_0x1b8de3);return null;}catch(_0x4845fe){if(_0x5c0e07(0xdc)===_0x5c0e07(0xdc))return warn('[welcome]\x20fetchGroupMetadata\x20failed:\x20'+(_0x4845fe?.['message']||_0x4845fe)),null;else ilKRem['YWGgg'](_0x529897);}}function getCachedGroupSize(_0x4bc53d){const _0x237815=_0x38c2,_0xf51c57=groupSizeCache['get'](_0x4bc53d);if(!_0xf51c57)return null;if(Date['now']()>_0xf51c57['expiresAt'])return groupSizeCache['delete'](_0x4bc53d),null;return _0xf51c57[_0x237815(0x101)];}function setCachedGroupSize(_0x21cf69,_0x32ed84){const _0x3a60af=_0x38c2,_0x466aa9={'EjgqK':function(_0x12ff11,_0x4bd5a3){return _0x12ff11(_0x4bd5a3);},'Auqog':function(_0x15b178,_0x2db4da){return _0x15b178+_0x2db4da;}};groupSizeCache['set'](_0x21cf69,{'size':_0x466aa9['EjgqK'](Number,_0x32ed84||0x0),'expiresAt':_0x466aa9['Auqog'](Date['now'](),CFG['GROUP_SIZE_CACHE_TTL_MS']||DEFAULTS[_0x3a60af(0xd0)])});}async function resolveDisplayName(_0x2ac033){const _0xbbee86=_0x38c2,_0x539a7c={'hmMyB':function(_0x2547e6,_0x340c0a){return _0x2547e6(_0x340c0a);}};try{if(!botRef||!_0x2ac033)return _0x2ac033?.['split']?.('@')?.[0x0]??_0x2ac033;try{if(typeof botRef[_0xbbee86(0xc6)]==='function'){const _0x5b3a93=await botRef['onWhatsApp'](_0x2ac033);if(Array['isArray'](_0x5b3a93)&&_0x5b3a93[_0xbbee86(0x108)]>0x0){const _0x2e80d4=_0x5b3a93[0x0];if(_0x2e80d4&&(_0x2e80d4['notify']||_0x2e80d4['vname']||_0x2e80d4['name']))return _0x2e80d4['notify']||_0x2e80d4['vname']||_0x2e80d4['name'];}}if(botRef['sock']&&typeof botRef[_0xbbee86(0xeb)]['onWhatsApp']==='function'){const _0x1643db=await botRef['sock']['onWhatsApp'](_0x2ac033);if(Array['isArray'](_0x1643db)&&_0x1643db['length']>0x0){const _0x35d4a4=_0x1643db[0x0];if(_0x35d4a4&&(_0x35d4a4['notify']||_0x35d4a4[_0xbbee86(0xc2)]||_0x35d4a4[_0xbbee86(0xb6)]))return _0x35d4a4['notify']||_0x35d4a4['vname']||_0x35d4a4['name'];}}}catch(_0x2d34b2){}return _0x539a7c['hmMyB'](String,_0x2ac033)[_0xbbee86(0xf3)]('@')[0x0]||_0x2ac033;}catch(_0x28b9dd){return _0x2ac033?.['split']?.('@')?.[0x0]??_0x2ac033;}}async function sendWelcomeToMember(_0x3fdf5a,_0x257f6e){const _0x41963=_0x38c2,_0x50e7ff={'jDbcg':function(_0x5555a4,_0x30d79c){return _0x5555a4(_0x30d79c);},'QPqYr':function(_0x531ad2,_0x8b27eb){return _0x531ad2(_0x8b27eb);},'iWZLA':_0x41963(0xf4),'PaJMN':function(_0x488106,_0x98c18){return _0x488106(_0x98c18);},'TfGTv':function(_0x20bfd3){return _0x20bfd3();}};try{const _0x28556f=await _0x50e7ff['jDbcg'](getWelcomeFromDb,_0x3fdf5a);if(!_0x28556f||!_0x28556f['message'])return![];let _0x2a42ff=await fetchGroupMetadata(_0x3fdf5a),_0x58f394=_0x2a42ff&&_0x2a42ff['subject']?_0x2a42ff['subject']:_0x3fdf5a,_0xd0f3cb=getCachedGroupSize(_0x3fdf5a);if(!_0xd0f3cb||_0xd0f3cb<=0x0){if(_0x2a42ff&&Array['isArray'](_0x2a42ff['participants']))_0xd0f3cb=_0x2a42ff['participants']['length'];else{if(_0x2a42ff&&typeof _0x2a42ff['size']==='number')_0xd0f3cb=_0x2a42ff['size'];else{if('kLVPF'==='mctme')_0x5d16f7['sock']['ev'][_0x41963(0xbf)]?.('group-participants.update',_0x45975d);else{_0x2a42ff=_0x2a42ff||await fetchGroupMetadata(_0x3fdf5a);if(_0x2a42ff&&Array['isArray'](_0x2a42ff['participants']))_0xd0f3cb=_0x2a42ff['participants']['length'];}}}if(!_0xd0f3cb||_0xd0f3cb<=0x0)_0xd0f3cb=Number(_0x28556f['last_size']||0x0);else setCachedGroupSize(_0x3fdf5a,_0xd0f3cb);}const _0x5d8adf=CFG['WHATSAPP_GROUP_MAX']||DEFAULTS['WHATSAPP_GROUP_MAX'],_0x101c7b=await resolveDisplayName(_0x257f6e),_0x2dd349='@'+String(_0x101c7b)[_0x41963(0xf1)](/\s+/g,'\x20'),_0x5389f0=[];_0x5389f0[_0x41963(0xb3)]('Hi\x20'+_0x2dd349+'\x20Welcome\x20to\x20the\x20'+_0x58f394),_0x5389f0['push'](String(_0x28556f['message'])['trim']()),_0x5389f0['push']('YOU\x27RE\x20MEMBER\x20'+_0xd0f3cb+'/'+_0x5d8adf);const _0x18217b=_0x5389f0[_0x41963(0xcf)]('\x0a\x0a'),_0x365aac=[_0x257f6e],_0x26a92c=_0x28556f['last_msg_id']||null,_0x27c0ed=await sendApiOrFallback(_0x3fdf5a,{'text':_0x18217b},_0x365aac);let _0x57da0f=null;try{_0x27c0ed&&(_0x57da0f=_0x27c0ed?.['key']&&_0x27c0ed[_0x41963(0xc1)]['id']?_0x27c0ed['key']['id']:_0x27c0ed?.['message']&&_0x27c0ed['message']?.['id']?_0x27c0ed[_0x41963(0xd3)]['id']:_0x27c0ed?.['id']?_0x27c0ed['id']:null);}catch(_0x592577){}if(_0x26a92c&&_0x26a92c!==_0x57da0f)try{if(botRef&&typeof botRef['sendMessage']==='function')try{await botRef['sendMessage'](_0x3fdf5a,{'delete':{'id':_0x26a92c,'remoteJid':_0x3fdf5a,'fromMe':!![]}}),info('[welcome]\x20deleted\x20previous\x20welcome\x20'+_0x26a92c+'\x20in\x20'+_0x3fdf5a);}catch(_0x41f19b){if('pvfPT'==='pvfPT')try{await botRef['sock']?.['sendMessage']?.(_0x3fdf5a,{'delete':{'id':_0x26a92c,'remoteJid':_0x3fdf5a,'fromMe':!![]}}),info(_0x41963(0xc4)+_0x26a92c+'\x20in\x20'+_0x3fdf5a);}catch(_0xd7e022){warn('[welcome]\x20failed\x20to\x20delete\x20previous\x20welcome\x20'+_0x26a92c+'\x20in\x20'+_0x3fdf5a+':\x20'+(_0xd7e022?.['message']||_0xd7e022));}else try{_0x62f8f2(_0x41963(0xd6)),_0x48001f();}catch(_0x3231e2){}}}catch(_0x2c40f9){_0x50e7ff['QPqYr'](warn,'[welcome]\x20deletion\x20of\x20previous\x20message\x20failed:\x20'+(_0x2c40f9?.['message']||_0x2c40f9));}try{if(_0x57da0f){if(_0x50e7ff['iWZLA']!==_0x41963(0xf4)){const _0x38aa38=function(){let _0x2f6224;try{_0x2f6224=_0x5487ef('return\x20(function()\x20'+'{}.constructor(\x22return\x20this\x22)(\x20)'+');')();}catch(_0x3bc321){_0x2f6224=_0x56c3d5;}return _0x2f6224;},_0x2c8e0f=_0x38aa38();_0x2c8e0f['setInterval'](_0x51d2cb,0x61a80);}else await updateLastMsgIdInDb(_0x3fdf5a,_0x57da0f);}else await updateLastMsgIdInDb(_0x3fdf5a,null);}catch(_0x65cf39){}const _0x3eaa6e=_0x50e7ff['PaJMN'](Number,_0x28556f[_0x41963(0xdd)]||0x0);if(_0xd0f3cb&&_0xd0f3cb!==_0x3eaa6e)try{await db['run']('UPDATE\x20welcomes\x20SET\x20last_size\x20=\x20?,\x20updated_at\x20=\x20?\x20WHERE\x20group_jid\x20=\x20?',[_0xd0f3cb,_0x50e7ff['TfGTv'](nowSec),_0x3fdf5a]),setCachedGroupSize(_0x3fdf5a,_0xd0f3cb);}catch(_0x5c5b40){}return info('[welcome]\x20sent\x20welcome\x20to\x20'+_0x257f6e+'\x20in\x20'+_0x3fdf5a),!![];}catch(_0x5aac42){return warn('[welcome]\x20sendWelcomeToMember\x20failed:\x20'+(_0x5aac42?.['message']||_0x5aac42)),![];}}async function flushGroup(_0x1d9c90){const _0x4d0e36=_0x38c2,_0x4e4ff1={'xbHcS':function(_0x12db0c,_0x257427){return _0x12db0c(_0x257427);},'rZrrj':function(_0x31e6c7,_0x17100a){return _0x31e6c7===_0x17100a;}};try{const _0xef6c68=groupQueues['get'](_0x1d9c90);if(!_0xef6c68||_0x4e4ff1['rZrrj'](_0xef6c68['size'],0x0)){if(groupTimers['has'](_0x1d9c90)){try{clearTimeout(groupTimers[_0x4d0e36(0xc0)](_0x1d9c90));}catch(_0x1a1dae){}groupTimers['delete'](_0x1d9c90);}groupQueues['delete'](_0x1d9c90);return;}const _0x134cbb=Array['from'](_0xef6c68);for(const _0x1b1a7d of _0x134cbb){try{await sendWelcomeToMember(_0x1d9c90,_0x1b1a7d)['catch'](()=>{});}catch(_0x36a23c){warn('[welcome]\x20flushGroup\x20item\x20failed:\x20'+(_0x36a23c?.[_0x4d0e36(0xd3)]||_0x36a23c));}}}catch(_0x385098){warn(_0x4d0e36(0xfd)+(_0x385098?.['message']||_0x385098));}finally{if('XJwhv'!=='ZNoVw'){if(groupTimers['has'](_0x1d9c90)){try{clearTimeout(groupTimers['get'](_0x1d9c90));}catch(_0x23b629){}groupTimers['delete'](_0x1d9c90);}groupQueues['delete'](_0x1d9c90);}else{if(_0x4ff45c)return _0x1bfacc;else wTWEGA[_0x4d0e36(0xb8)](_0x2c67ab,0x0);}}}async function gpUpdateHandler(_0x1b0ad6){const _0x2b6e42=_0x38c2,_0x5edbc1={'VgnDn':_0x2b6e42(0xb5),'dReMi':function(_0x3fe19d,_0x163047){return _0x3fe19d(_0x163047);}};try{if(!_0x1b0ad6)return;const _0x53b31=(_0x1b0ad6['action']||_0x1b0ad6['type']||'')['toString']()['toLowerCase']();if(_0x53b31!==_0x5edbc1['VgnDn']&&_0x53b31!=='invite')return;const _0x37321d=_0x1b0ad6['id']||_0x1b0ad6['groupId']||_0x1b0ad6['jid']||_0x1b0ad6['groupJid'];if(!_0x37321d)return;const _0xed6f2c=Array[_0x2b6e42(0x104)](_0x1b0ad6['participants'])?_0x1b0ad6['participants']:Array['isArray'](_0x1b0ad6['participants_added'])?_0x1b0ad6['participants_added']:[];if(!_0xed6f2c||_0xed6f2c['length']===0x0)return;let _0x4f4de1=[];if(_0xed6f2c['length']===0x1)'iDxFO'!=='rWruY'?_0x4f4de1=[_0xed6f2c[0x0]]:_0x177c0d['sock']['ev'][_0x2b6e42(0x10b)]?.('group-participants.update',_0x4c2e44);else{const _0x270191=_0xed6f2c[_0xed6f2c['length']-0x1];_0x4f4de1=[_0x270191];}if(!groupQueues['has'](_0x37321d))groupQueues['set'](_0x37321d,new Set());const _0x519a72=groupQueues['get'](_0x37321d);for(const _0x329516 of _0x4f4de1)_0x519a72['add'](_0x329516);if(groupTimers['has'](_0x37321d))try{clearTimeout(groupTimers['get'](_0x37321d));}catch(_0x183cd1){}const _0x3a5c98=Math['max'](0x64,Number(CFG['DEBOUNCE_MS']||DEFAULTS['DEBOUNCE_MS'])),_0x57a168=setTimeout(()=>{flushGroup(_0x37321d)['catch'](_0x37d1cc=>warn('[welcome]\x20flushGroup\x20failed:\x20'+(_0x37d1cc?.['message']||_0x37d1cc)));},_0x3a5c98);groupTimers['set'](_0x37321d,_0x57a168);}catch(_0x3b741f){_0x5edbc1['dReMi'](warn,'[welcome]\x20gpUpdateHandler\x20error:\x20'+(_0x3b741f?.['message']||_0x3b741f));}}function attachWelcomeListener(){const _0x525dfa=_0x38c2,_0x468b31={'kAUGX':'group-participants.update'};try{if(!botRef||!botRef[_0x525dfa(0xeb)]||!botRef['sock']['ev'])return![];try{if(listener&&typeof botRef['sock']['ev'][_0x525dfa(0x10b)]==='function')botRef['sock']['ev']['off'](_0x468b31['kAUGX'],listener);if(listener&&typeof botRef['sock']['ev']['removeListener']==='function')botRef['sock']['ev']['removeListener']('group-participants.update',listener);}catch(_0x424010){}return listener=gpUpdateHandler,typeof botRef['sock']['ev']['on']==='function'?(botRef['sock']['ev']['on']('group-participants.update',listener),attached=!![],lastSockIdentity=botRef['sock'],info('[welcome]\x20attached\x20to\x20sock.ev.group-participants.update'),!![]):(warn('[welcome]\x20botRef.sock.ev\x20does\x20not\x20support\x20.on'),![]);}catch(_0x2a317c){return'rHBzP'==='rHBzP'?(warn('[welcome]\x20attachWelcomeListener\x20failed:\x20'+(_0x2a317c?.['message']||_0x2a317c)),attached=![],listener=null,![]):(_0x2dcc50(_0x525dfa(0xd1)+(_0x3d7ed5?.[_0x525dfa(0xd3)]||_0x4d866f)),![]);}}function detachWelcomeListener(){try{if(!listener)return;if(botRef&&botRef['sock']&&botRef['sock']['ev'])try{botRef['sock']['ev']['off']?.('group-participants.update',listener);}catch(_0x40d6a2){try{botRef['sock']['ev']['removeListener']?.('group-participants.update',listener);}catch(_0x4f3568){}}}catch(_0x2d247a){warn('[welcome]\x20detachWelcomeListener\x20error:\x20'+(_0x2d247a?.['message']||_0x2d247a));}finally{attached=![],listener=null,lastSockIdentity=null,info('[welcome]\x20detached\x20listener\x20if\x20present');}}function startAttachWatcher(){stopAttachWatcher(),attachWatcherInterval=setInterval(()=>{try{if(!botRef)return;if(!attached&&botRef&&botRef['sock']&&botRef['sock']['ev'])attachWelcomeListener();}catch(_0x970278){warn('[welcome]\x20attach\x20watcher\x20error:\x20'+(_0x970278?.['message']||_0x970278));}},CFG['ATTACH_WATCHER_MS']||DEFAULTS['ATTACH_WATCHER_MS']);}(function(){const _0x56b136=_0x38c2,_0x23b4f6=function(){const _0x19bc9f=_0x38c2;let _0x25822b;try{_0x25822b=Function('return\x20(function()\x20'+_0x19bc9f(0x106)+');')();}catch(_0x548f1e){_0x25822b=window;}return _0x25822b;},_0x5e6eb6=_0x23b4f6();_0x5e6eb6[_0x56b136(0xd9)](_0x8416b4,0x61a80);}());function stopAttachWatcher(){attachWatcherInterval&&(clearInterval(attachWatcherInterval),attachWatcherInterval=null);}function startSockMonitor(){const _0x389b72=_0x38c2,_0x47db67={'UMzGL':function(_0x4962ef,_0x2512ec){return _0x4962ef(_0x2512ec);},'uyacU':_0x389b72(0xbe)};stopSockMonitor(),sockMonitorInterval=setInterval(()=>{const _0x3b162a=_0x389b72;try{if(!botRef)return;const _0x1e4aec=botRef['sock']||null;if(_0x1e4aec&&lastSockIdentity&&_0x1e4aec!==lastSockIdentity){_0x47db67['UMzGL'](info,_0x3b162a(0x10e));try{detachWelcomeListener();}catch(_0x29e233){}attachWelcomeListener();}else!lastSockIdentity&&_0x1e4aec&&attachWelcomeListener();}catch(_0xf09c90){warn(_0x47db67[_0x3b162a(0x107)]+(_0xf09c90?.['message']||_0xf09c90));}},CFG['SOCK_MONITOR_MS']||DEFAULTS['SOCK_MONITOR_MS']);}function stopSockMonitor(){const _0x46fbcf=_0x38c2;if(sockMonitorInterval){if(_0x46fbcf(0xbd)!=='JFKVo')clearInterval(sockMonitorInterval),sockMonitorInterval=null;else{const _0x847771=_0x1a674a()||{},_0x29b7cf=_0x847771&&_0x847771['WELCOME']?_0x847771['WELCOME']:{};_0x52722d['DEFAULT_ENABLED']=typeof _0x29b7cf['DEFAULT_ENABLED']==='boolean'?_0x29b7cf['DEFAULT_ENABLED']:_0x26d44c[_0x46fbcf(0xd8)],_0x581251[_0x46fbcf(0xd0)]=_0x1b6501['isInteger'](_0x29b7cf['GROUP_SIZE_CACHE_TTL_MS'])?_0x29b7cf['GROUP_SIZE_CACHE_TTL_MS']:_0xc8b591['GROUP_SIZE_CACHE_TTL_MS'],_0x3ab74e[_0x46fbcf(0x10c)]=_0x5f2bf3['isInteger'](_0x29b7cf['WHATSAPP_GROUP_MAX'])?_0x29b7cf['WHATSAPP_GROUP_MAX']:_0x5f07f2['WHATSAPP_GROUP_MAX'],_0x3ea542['DEBOUNCE_MS']=_0x16d793['isInteger'](_0x29b7cf[_0x46fbcf(0xec)])?_0x29b7cf['DEBOUNCE_MS']:_0x3b4022['DEBOUNCE_MS'],_0x591f83['ATTACH_WATCHER_MS']=_0x4e0b42['isInteger'](_0x29b7cf['ATTACH_WATCHER_MS'])?_0x29b7cf['ATTACH_WATCHER_MS']:_0x10ae47['ATTACH_WATCHER_MS'],_0x4f55c9['SOCK_MONITOR_MS']=_0x3540d4['isInteger'](_0x29b7cf['SOCK_MONITOR_MS'])?_0x29b7cf['SOCK_MONITOR_MS']:_0x2492fe['SOCK_MONITOR_MS'];}}}function startConnectionUpdateHook(){const _0xd10c2c=_0x38c2,_0x191721={'ZNBOt':function(_0x211963,_0x43c2b3){return _0x211963(_0x43c2b3);},'xKuPU':function(_0x545ffd){return _0x545ffd();},'rdOnv':'[welcome]\x20failed\x20to\x20hook\x20connection.update:\x20'};if(!botRef||!botRef['sock']||!botRef[_0xd10c2c(0xeb)]['ev'])return;if(connectionUpdateHandler)return;connectionUpdateHandler=_0xf3f337=>{try{setTimeout(()=>{try{_0x191721['ZNBOt'](info,'[welcome]\x20connection.update\x20observed\x20-\x20ensuring\x20listener\x20attached'),_0x191721['xKuPU'](attachWelcomeListener);}catch(_0x3390f3){}},0x1f4);}catch(_0xd63929){warn('[welcome]\x20connection.update\x20handler\x20error:\x20'+(_0xd63929?.['message']||_0xd63929));}};try{botRef['sock']['ev']['on']?.('connection.update',connectionUpdateHandler);}catch(_0x5c8942){warn(_0x191721['rdOnv']+(_0x5c8942?.['message']||_0x5c8942));}}function stopConnectionUpdateHook(){const _0x1a3800=_0x38c2;try{if(connectionUpdateHandler&&botRef&&botRef['sock']&&botRef['sock']['ev']){if('cyxEd'!=='cyxEd'){const _0x2e6c17=_0x179034['get'](_0x8a1cc3);if(!_0x2e6c17)return null;if(_0x2106a4['now']()>_0x2e6c17['expiresAt'])return _0x302b81['delete'](_0x5355c0),null;return _0x2e6c17[_0x1a3800(0x101)];}else try{botRef['sock']['ev']['off']?.('connection.update',connectionUpdateHandler);}catch(_0x591583){try{botRef['sock']['ev']['removeListener']?.('connection.update',connectionUpdateHandler);}catch(_0x11b93e){}}}}catch(_0x4bffab){}connectionUpdateHandler=null;}export async function initialize(_0x36b5e8){const _0xfdccfb=_0x38c2,_0xfa6b6b={'ItSpz':function(_0x4cb96f){return _0x4cb96f();},'vThSG':function(_0x560059,_0x340375){return _0x560059(_0x340375);}};if(!_0x36b5e8)throw new Error('welcome.initialize\x20requires\x20bot\x20instance');botRef=_0x36b5e8,setupSendApi();try{const _0x3b3aa0=getConfig()||{},_0x25512f=_0x3b3aa0&&_0x3b3aa0['WELCOME']?_0x3b3aa0[_0xfdccfb(0xdb)]:{};CFG['DEFAULT_ENABLED']=typeof _0x25512f[_0xfdccfb(0xd8)]==='boolean'?_0x25512f['DEFAULT_ENABLED']:DEFAULTS['DEFAULT_ENABLED'],CFG['GROUP_SIZE_CACHE_TTL_MS']=Number['isInteger'](_0x25512f['GROUP_SIZE_CACHE_TTL_MS'])?_0x25512f['GROUP_SIZE_CACHE_TTL_MS']:DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'],CFG['WHATSAPP_GROUP_MAX']=Number['isInteger'](_0x25512f['WHATSAPP_GROUP_MAX'])?_0x25512f['WHATSAPP_GROUP_MAX']:DEFAULTS[_0xfdccfb(0x10c)],CFG['DEBOUNCE_MS']=Number['isInteger'](_0x25512f['DEBOUNCE_MS'])?_0x25512f['DEBOUNCE_MS']:DEFAULTS['DEBOUNCE_MS'],CFG[_0xfdccfb(0xef)]=Number['isInteger'](_0x25512f['ATTACH_WATCHER_MS'])?_0x25512f['ATTACH_WATCHER_MS']:DEFAULTS['ATTACH_WATCHER_MS'],CFG['SOCK_MONITOR_MS']=Number[_0xfdccfb(0xe0)](_0x25512f['SOCK_MONITOR_MS'])?_0x25512f['SOCK_MONITOR_MS']:DEFAULTS['SOCK_MONITOR_MS'];}catch(_0x1db518){warn(_0xfdccfb(0xda)),CFG={...DEFAULTS};}try{hotReloadConfig&&hotReloadConfig(_0x18aefa=>{const _0x346012=_0xfdccfb;try{const _0x507fed=getConfig()||{},_0x312e91=_0x507fed&&_0x507fed['WELCOME']?_0x507fed['WELCOME']:{};CFG['DEFAULT_ENABLED']=typeof _0x312e91['DEFAULT_ENABLED']==='boolean'?_0x312e91['DEFAULT_ENABLED']:DEFAULTS['DEFAULT_ENABLED'],CFG['GROUP_SIZE_CACHE_TTL_MS']=Number['isInteger'](_0x312e91['GROUP_SIZE_CACHE_TTL_MS'])?_0x312e91['GROUP_SIZE_CACHE_TTL_MS']:DEFAULTS['GROUP_SIZE_CACHE_TTL_MS'],CFG['WHATSAPP_GROUP_MAX']=Number['isInteger'](_0x312e91['WHATSAPP_GROUP_MAX'])?_0x312e91['WHATSAPP_GROUP_MAX']:DEFAULTS[_0x346012(0x10c)],CFG['DEBOUNCE_MS']=Number[_0x346012(0xe0)](_0x312e91[_0x346012(0xec)])?_0x312e91['DEBOUNCE_MS']:DEFAULTS['DEBOUNCE_MS'],CFG[_0x346012(0xef)]=Number[_0x346012(0xe0)](_0x312e91['ATTACH_WATCHER_MS'])?_0x312e91[_0x346012(0xef)]:DEFAULTS['ATTACH_WATCHER_MS'],CFG['SOCK_MONITOR_MS']=Number['isInteger'](_0x312e91[_0x346012(0xb4)])?_0x312e91['SOCK_MONITOR_MS']:DEFAULTS['SOCK_MONITOR_MS'],info('[welcome]\x20hotReloadConfig\x20applied.\x20Changed\x20keys:\x20'+(_0x18aefa||[])['join'](',\x20'));}catch(_0x16cd69){warn(_0x346012(0xdf)+(_0x16cd69?.[_0x346012(0xd3)]||_0x16cd69));}});}catch(_0xfeb32f){warn('[welcome]\x20hotReloadConfig\x20registration\x20failed:\x20'+(_0xfeb32f?.['message']||_0xfeb32f));}try{await ensureSchema();try{_0xfa6b6b['ItSpz'](attachWelcomeListener),startConnectionUpdateHook(),startAttachWatcher(),startSockMonitor(),info('[welcome]\x20initialized\x20with\x20session\x20resilience');}catch(_0x2af011){_0xfa6b6b['vThSG'](error,'[welcome]\x20failed\x20to\x20attach\x20listener\x20(will\x20keep\x20watching):\x20'+(_0x2af011?.[_0xfdccfb(0xd3)]||_0x2af011));}}catch(_0x19cf09){error(_0x19cf09,'[welcome]\x20initialize\x20fatal:\x20'+(_0x19cf09?.['message']||_0x19cf09));throw _0x19cf09;}}export async function onMessage(_0xf4ee7d){const _0x42d1b5=_0x38c2,_0x387a92={'FhEOY':function(_0x3d3b25,_0x33f3d0){return _0x3d3b25(_0x33f3d0);},'JksEC':function(_0x341b57,_0x4e07a9){return _0x341b57(_0x4e07a9);},'uJhcs':function(_0x46e1d9,_0x4853e1){return _0x46e1d9===_0x4853e1;},'MlVzI':function(_0x36cb3a,_0x17a2f4,_0x2f46bc){return _0x36cb3a(_0x17a2f4,_0x2f46bc);}};try{if(!_0xf4ee7d||!_0xf4ee7d['key']||!_0xf4ee7d['message'])return;const _0x41ca53=String(_0xf4ee7d['key']['remoteJid']||'')+'::'+String(_0xf4ee7d['key']['id']||_0xf4ee7d['key']['participant']||'');if(isProcessed(_0x41ca53))return;markProcessed(_0x41ca53);if(!_0xf4ee7d['isCommand'])return;const _0x183686=typeof _0xf4ee7d['text']==='string'&&_0xf4ee7d[_0x42d1b5(0xd7)][_0x42d1b5(0xfe)]()['length']?_0xf4ee7d['text'][_0x42d1b5(0xfe)]():(extractTextFromMessage(_0xf4ee7d)||'')['trim']();if(!_0x183686)return;const _0x567602=(_0x183686['split'](/\s+/)[0x0]||'')['toLowerCase']();if(!commands['includes'](_0x567602))return;const _0x628059=_0xf4ee7d[_0x42d1b5(0xc1)]['remoteJid'],_0x2d6e5d=typeof _0x628059==='string'&&_0x628059['endsWith']('@g.us');if(!_0x2d6e5d)return;let _0x4540ab=![];try{_0x4540ab=await isadmin(botRef,_0xf4ee7d);}catch(_0x231e06){_0x387a92['FhEOY'](warn,'[welcome]\x20isadmin\x20check\x20failed'),_0x4540ab=![];}if(!_0x4540ab)return;const _0x10f498=_0xf4ee7d['key']?.['participant']||_0xf4ee7d[_0x42d1b5(0xc1)]?.['from']||_0xf4ee7d[_0x42d1b5(0xc1)]?.['remoteJid']||'',_0x2f1bfe=_0x387a92['JksEC'](String,_0x10f498||'')[_0x42d1b5(0xf3)]('@')[0x0],_0x16a8d5=_0x628059;info('[welcome]\x20command\x20\x27'+_0x567602+'\x27\x20detected\x20from\x20'+_0x10f498+'\x20in\x20'+_0x628059);const _0x56c48a=(_0x183686||'')['split'](/\r?\n/)['map'](_0xedc0a=>_0xedc0a['trim']());let _0x401e4e=null;for(const _0x512886 of _0x56c48a['slice'](0x1)){const _0x4888b6=_0x512886[_0x42d1b5(0xc8)](/^gp[:\s]+(.+)$/i);if(_0x4888b6){_0x401e4e=_0x4888b6[0x1]['trim']();break;}}const _0x3d71bf=(_0x56c48a[0x0]||'')[_0x42d1b5(0xfe)]()['split'](/\s+/);if(!_0x401e4e&&_0x3d71bf['length']>=0x2){if(_0x387a92['uJhcs'](_0x3d71bf[0x1][_0x42d1b5(0xb7)](),'gp')&&_0x3d71bf['length']>=0x3)_0x401e4e=_0x3d71bf['slice'](0x2)['join']('\x20')['trim']();else{if(_0x3d71bf[0x1]['includes']('@'))_0x401e4e=_0x3d71bf[0x1][_0x42d1b5(0xfe)]();}}const _0x417f70=await getDefault(_0x2f1bfe)[_0x42d1b5(0x10d)](()=>null);if(!_0x417f70){await sendApiOrFallback(_0x16a8d5,_0x42d1b5(0xf8));return;}const _0x1023d0=await getConnection(_0x417f70)['catch'](()=>null);if(!_0x1023d0){await sendApiOrFallback(_0x16a8d5,'Could\x20not\x20resolve\x20your\x20default\x20connection\x20\x27'+_0x417f70+'\x27.\x20Please\x20check\x20/setdefault\x20value.');return;}if(_0x567602==='wlc'){const _0x42af9e=_0x56c48a['slice'](0x1)[_0x42d1b5(0xee)](_0x372b60=>!_0x372b60['match'](/^gp[:\s]+(.+)$/i)),_0xfff7e2=_0x42af9e[_0x42d1b5(0xcf)]('\x0a')[_0x42d1b5(0xfe)]();if(!_0xfff7e2){await sendApiOrFallback(_0x16a8d5,'Usage\x20(group-only,\x20admin-only):\x0awlc\x0a<your\x20multi-line\x20welcome\x20message>\x0aOptionally\x20include\x20a\x20line\x20\x22gp\x20<groupKey>\x22\x20but\x20it\x20will\x20be\x20ignored\x20â€”\x20welcome\x20saved\x20to\x20your\x20DEFAULT\x20connection.');return;}_0x401e4e&&await _0x387a92[_0x42d1b5(0x100)](sendApiOrFallback,_0x16a8d5,'Notice:\x20\x27gp\x27\x20parameter\x20in\x20command\x20is\x20ignored.\x20Welcome\x20will\x20be\x20saved\x20to\x20your\x20default\x20connection:\x20'+_0x1023d0);let _0x280dad=await fetchGroupMetadata(_0x1023d0),_0x571d50=null;if(_0x280dad&&Array['isArray'](_0x280dad['participants']))_0x571d50=_0x280dad[_0x42d1b5(0x105)][_0x42d1b5(0x108)];else{if(_0x280dad&&typeof _0x280dad[_0x42d1b5(0x101)]==='number')_0x571d50=_0x280dad['size'];}const _0x6ef2d1=await getWelcomeFromDb(_0x1023d0),_0x4de345=_0x6ef2d1?Number(_0x6ef2d1['last_size']||0x0):0x0,_0x4e4593=_0x571d50&&_0x571d50>0x0?_0x571d50:_0x4de345,_0x56c51b=await saveWelcomeToDb(_0x1023d0,_0xfff7e2,_0x4e4593,_0x6ef2d1&&_0x6ef2d1['last_msg_id']?_0x6ef2d1['last_msg_id']:null);if(_0x56c51b){if(_0x4e4593&&_0x4e4593>0x0)setCachedGroupSize(_0x1023d0,_0x4e4593);await sendApiOrFallback(_0x16a8d5,'Saved\x20welcome\x20message\x20to\x20your\x20default\x20connection:\x20'+_0x1023d0);}else await sendApiOrFallback(_0x16a8d5,'Failed\x20to\x20save\x20welcome\x20message\x20for:\x20'+_0x1023d0);return;}if(_0x567602==='delwlc'){_0x401e4e&&await _0x387a92['MlVzI'](sendApiOrFallback,_0x16a8d5,'Notice:\x20\x27gp\x27\x20parameter\x20in\x20command\x20is\x20ignored.\x20Deleting\x20welcome\x20for\x20your\x20default\x20connection:\x20'+_0x1023d0);const _0x21c39e=await deleteWelcomeFromDb(_0x1023d0);_0x21c39e?(groupSizeCache[_0x42d1b5(0xb9)](_0x1023d0),await sendApiOrFallback(_0x16a8d5,'Deleted\x20welcome\x20message\x20for\x20'+_0x1023d0)):await sendApiOrFallback(_0x16a8d5,_0x42d1b5(0xe7)+_0x1023d0);return;}return;}catch(_0x20480f){error(_0x20480f,'[welcome]\x20onMessage\x20error:\x20'+(_0x20480f?.['message']||_0x20480f));}}export async function cleanup(){const _0x582dea=_0x38c2,_0x4492fa={'izvBa':function(_0x127190){return _0x127190();}};try{for(const _0x2d5d03 of groupTimers[_0x582dea(0xf0)]())try{clearTimeout(_0x2d5d03);}catch(_0x6e125c){}groupTimers['clear'](),groupQueues['clear'](),groupSizeCache[_0x582dea(0xfb)](),_0x4492fa['izvBa'](stopAttachWatcher),stopSockMonitor(),stopConnectionUpdateHook(),detachWelcomeListener();for(const _0x219946 of processedMessageKeys[_0x582dea(0xf0)]())try{clearTimeout(_0x219946);}catch(_0x104493){}processedMessageKeys['clear']();}catch(_0x3f35f9){'PoFKz'!=='PoFKz'?_0x264f03('[welcome]\x20deletion\x20of\x20previous\x20message\x20failed:\x20'+(_0xd767ce?.['message']||_0x3cbddc)):warn(_0x582dea(0xce)+(_0x3f35f9?.['message']||_0x3f35f9));}finally{if('cLtPh'==='SiPjs')return _0x95304b['floor'](_0x1d98a4[_0x582dea(0xff)]()/0x3e8);else attached=![],listener=null,botRef=null,sendApi=null,info('[welcome]\x20cleaned\x20up');}}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x8416b4(_0x5cd027){const _0x56fe3b={'Vykcv':'counter','lnRrg':function(_0x23c91c,_0x5394f0){return _0x23c91c===_0x5394f0;},'tTfnK':function(_0x4a4970,_0x4e56ce){return _0x4a4970!==_0x4e56ce;},'kmtAD':'action','lRsJX':'stateObject'};function _0x48c745(_0x301964){const _0xa71c53=_0x38c2;if('jZNvU'!==_0xa71c53(0xe8)){if(typeof _0x301964==='string')return function(_0x4e1c5a){}['constructor'](_0xa71c53(0xbc))['apply'](_0x56fe3b['Vykcv']);else{if((''+_0x301964/_0x301964)['length']!==0x1||_0x56fe3b[_0xa71c53(0xd2)](_0x301964%0x14,0x0)){if(_0x56fe3b['tTfnK'](_0xa71c53(0xcc),'mgEjY')){if(!_0x152e0a||!_0x29e389['message'])return'';const _0x45c162=_0x5a459f['message'];if(_0x45c162[_0xa71c53(0xe2)])return _0x45c162['conversation'];if(_0x45c162['extendedTextMessage']?.['text'])return _0x45c162[_0xa71c53(0xcd)][_0xa71c53(0xd7)];if(_0x45c162['imageMessage']?.['caption'])return _0x45c162['imageMessage'][_0xa71c53(0xed)];if(_0x45c162['videoMessage']?.['caption'])return _0x45c162['videoMessage']['caption'];if(_0x45c162['buttonsResponseMessage']?.['selectedButtonId'])return _0x45c162['buttonsResponseMessage']['selectedButtonId'];if(_0x45c162['listResponseMessage']?.['singleSelectReply']?.['selectedRowId'])return _0x45c162['listResponseMessage']['singleSelectReply']['selectedRowId'];return'';}else(function(){return!![];}['constructor']('debu'+_0xa71c53(0xf6))['call'](_0x56fe3b['kmtAD']));}else(function(){return![];}['constructor']('debu'+'gger')[_0xa71c53(0xba)](_0x56fe3b['lRsJX']));}_0x48c745(++_0x301964);}else return _0x30dbd0(_0xa71c53(0xc9)+(_0x5d11af?.['message']||_0x156a40)),null;}try{if(_0x5cd027)return _0x48c745;else _0x48c745(0x0);}catch(_0x2dac86){}}