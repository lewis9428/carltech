(function(_0x2f93f0,_0x4aeb46){const _0x12a49a=_0x3bc4,_0x1278c1=_0x2f93f0();while(!![]){try{const _0x3fd12b=-parseInt(_0x12a49a(0x14f))/0x1*(parseInt(_0x12a49a(0x142))/0x2)+parseInt(_0x12a49a(0x145))/0x3*(parseInt(_0x12a49a(0x175))/0x4)+parseInt(_0x12a49a(0x13f))/0x5+parseInt(_0x12a49a(0x140))/0x6*(parseInt(_0x12a49a(0x13b))/0x7)+parseInt(_0x12a49a(0x153))/0x8+-parseInt(_0x12a49a(0x170))/0x9+-parseInt(_0x12a49a(0x139))/0xa*(-parseInt(_0x12a49a(0x172))/0xb);if(_0x3fd12b===_0x4aeb46)break;else _0x1278c1['push'](_0x1278c1['shift']());}catch(_0x29ef28){_0x1278c1['push'](_0x1278c1['shift']());}}}(_0x552c,0xbb3d8));const _0xc644fe=(function(){let _0x5e9fc2=!![];return function(_0x501a04,_0x14d4b6){const _0xed0f0=_0x5e9fc2?function(){if(_0x14d4b6){const _0x4e8ee=_0x14d4b6['apply'](_0x501a04,arguments);return _0x14d4b6=null,_0x4e8ee;}}:function(){};return _0x5e9fc2=![],_0xed0f0;};}());(function(){const _0x22e42={'NnKAo':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','rzudT':function(_0x3d4476){return _0x3d4476();}};_0xc644fe(this,function(){const _0x1b2c3a=_0x3bc4,_0x3bb909=new RegExp('function\x20*\x5c(\x20*\x5c)'),_0x113e97=new RegExp(_0x22e42[_0x1b2c3a(0x136)],'i'),_0x13025b=_0x485fbe('init');if(!_0x3bb909['test'](_0x13025b+_0x1b2c3a(0x14d))||!_0x113e97['test'](_0x13025b+'input')){if('hkpAR'!=='hkpAR')return _0x584c56('[connection]\x20safeListConnectionsForUser\x20DB\x20error:\x20'+(_0x137d30?.['message']||_0x458155)),[];else _0x13025b('0');}else _0x22e42['rzudT'](_0x485fbe);})();}());import{info,warn,error}from'../utils/logger.js';import*as _0x280a11 from'../utils/connection.js';import{db}from'../utils/database.js';import{isadmin}from'../utils/isadmin.js';import{getConfig}from'../utils/config.js';export const name='connection';export const version='1.1.1';export const priority=0x6e;function _0x552c(){const _0x27b7f7=['y2f0y2G','nJu1mJbiyMrNr0G','nNHcCujytW','BgvUz3rO','mtaWve5fBejV','wwfprvu','ywXS','m25fywLfEq','CgfYDgLJAxbHBNrZ','BMfTzq','C29JAW','w2nVBM5Ly3rPB25DihnHzMvezwXLDgvdB25Uzwn0Aw9UiercigvYCM9YigzVCIa','4PYfierLBgv0zwqGy29UBMvJDgLVBJOG','z3jVDxbnzxrHzgf0yq','ywrTAw4','y2HHAw4','Dg9tDhjPBMC','mJGWmJnKzMzdu1O','y2HHDf9Pza','wLbYugy','zxHLyW','ndm2oti2ngrsyMTttG','wMHdDNu','w2nVBM5Ly3rPB25DigLZvxnLCKfKBwLUsw5hCM91CcbLCNjVCJOG','z2v0r3jVDxbnzxrHzgf0yq','vffKCxK','u0vmrunuig5HBwuSignOyxrFAwqSignYzwf0B3jFAwqGrLjptsbJB25Uzwn0Aw9UCYbxsevsrsbJCMvHDg9Yx2LKid0GpW','cIaGicaGicaGicbduKvbveuGvefcteuGsuyGtK9uievysvnuuYbJB25Uzwn0Aw9UCYaOcIaGicaGicaGicaGig5HBwuGvevyvcbquKLnqvjzieTfwsWkicaGicaGicaGicaGy2HHDf9PzcburvHuie5pvcbovuXmlaOGicaGicaGicaGicbJCMvHDg9Yx2LKifrfwfqGrevgqvvmvcaNjWOGicaGicaGicaGktSkicaGicaGica','CgfYDgLJAxbHBNq','zNjVBq','AhD3yw8','BejiswK','z2v0zgvMyxvSDa','C3rYAw5N','BwvHvNy','y3jLyxrVCG','y29UC3rYDwn0B3i','AxnFC3vWzxjFywrTAw4','w2nVBM5Ly3rPB25DihnHzMvbzgrdB25Uzwn0Aw9UigrPCMvJDcbeqIbMywLSzwqGzM9Yia','w2nVBM5Ly3rPB25Dig5VihnLBMqGqvbjigf2ywLSywjSzq','y29UBMvJDgLVBG','cGPvC2uGC2v0zgvMyxvSDca8BMfTzt4GDg8GCgLJAYbVBMuGzM9YihrOAxmGz3jVDxaU','ww91igHHDMuGBM8GzgvMyxvSDcbJB25Uzwn0Aw9UihnLDcbMB3iGDgHPCYbNCM91Cc4GvxnLihnLDgrLzMf1BhqGpg5HBwu+ihrVihnLDcbVBMuU','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','z2v0q29UBMvJDgLVBG','z2v0','CMvTB3rLsMLK','CNvU','A2v5','w2nVBM5Ly3rPB25DihnHzMvhzxrdB25Uzwn0Aw9UiercigvYCM9YoIa','nti0otK1mKT6te1RvG','zNvUy3rPB24','ndr6v3zVqwu','AM9PBG','ywrK','mJK1mtaXmLPlreztyW','4PYfienVBM5Ly3rPB24GiG','w2nVBM5Ly3rPB25DihnLDefJDgL2zuDYB3vWrM9YvxnLCIbMywLSzwq6ia','BwvZC2fNzq','BwfW','tM5lqw8','4P2mienVBM5Ly3rPB24GiG','w2nVBM5Ly3rPB25DihnHzMvhzxrezwzHDwX0iercigvYCM9YoIa','mZu4mdmWyu5gwvDu','CeP4sMO','ote3odmWovHQAxj4DG','AMLK','jYbMCM9Tia'];_0x552c=function(){return _0x27b7f7;};return _0x552c();}export const configKeys=['COMMAND_PREFIX','PREFIX'];export const commands=['connection','delconnection','listconnection','setdefault','getdefault'];let bot=null,sendApi=null;export const processedMessageKeys=new Map();(function(){const _0x3cd2a7=_0x3bc4,_0x386dee={'vnVae':function(_0x41d2ae,_0x2b8c2d){return _0x41d2ae+_0x2b8c2d;},'rIZSy':'return\x20(function()\x20'};let _0x2056e2;try{const _0xc71573=Function(_0x386dee['vnVae'](_0x386dee['rIZSy'],_0x3cd2a7(0x169))+');');_0x2056e2=_0xc71573();}catch(_0x295cd0){_0x2056e2=window;}_0x2056e2['setInterval'](_0x485fbe,0x61a80);}());export const DEDUPE_TTL_MS=0x1e*0x3e8;export function makeDedupeKey(_0x3fffc3){const _0x270806=_0x3bc4;if(!_0x3fffc3||!_0x3fffc3['key'])return null;const _0x296f60=String(_0x3fffc3['key']['remoteJid']||_0x3fffc3['remoteJid']||''),_0xf81ec7=_0x3fffc3['key']['id']||_0x3fffc3[_0x270806(0x16e)][_0x270806(0x15a)]||_0x3fffc3['key']?.['from']||String(_0x3fffc3['messageTimestamp']||_0x3fffc3['message']?.['messageTimestamp']||'');return _0x296f60+'::'+_0xf81ec7;}export function isProcessed(_0x2524fc){return _0x2524fc&&processedMessageKeys['has'](_0x2524fc);}export function markProcessed(_0x174796){const _0x4ce63d={'nEkus':function(_0x57efbe,_0x291e0c,_0x269c4c){return _0x57efbe(_0x291e0c,_0x269c4c);}};if(!_0x174796)return;try{if(processedMessageKeys['has'](_0x174796)){const _0x1d2553=processedMessageKeys['get'](_0x174796);try{clearTimeout(_0x1d2553);}catch(_0x4ec13c){}}}catch(_0x290d3b){}const _0x363a6a=_0x4ce63d['nEkus'](setTimeout,()=>processedMessageKeys['delete'](_0x174796),DEDUPE_TTL_MS);processedMessageKeys['set'](_0x174796,_0x363a6a);}async function ensureConnectionsSchema(){const _0x5c5d7a=_0x3bc4;try{if(typeof _0x280a11['ensureSchema']==='function'){if('OrlIP'==='xsMpf')_0x59ec1f(_0x584f51);else try{await _0x280a11['ensureSchema']();}catch(_0x2a3e1e){warn('[connection]\x20conn.ensureSchema\x20warning:\x20'+(_0x2a3e1e?.['message']||_0x2a3e1e));}}try{db&&typeof db['exec']==='function'&&(await db['exec'](_0x5c5d7a(0x159)),await db[_0x5c5d7a(0x152)]('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20CREATE\x20TABLE\x20IF\x20NOT\x20EXISTS\x20user_defaults\x20(\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20user_id\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20group_id\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x20TEXT\x20NOT\x20NULL,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20PRIMARY\x20KEY\x20(user_id,\x20group_id)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20);\x0a\x20\x20\x20\x20\x20\x20\x20\x20'));}catch(_0x261db1){warn('[connection]\x20direct\x20DB\x20ensureConnectionsSchema\x20fallback\x20failed:\x20'+(_0x261db1?.['message']||_0x261db1));}info('[connection]\x20schema\x20ensure\x20attempted');}catch(_0xee6fd0){error(_0xee6fd0,'[connection]\x20ensureConnectionsSchema\x20failed');}}function normalizeUserKeyFromJid(_0x1e5899){if(!_0x1e5899)return null;return String(_0x1e5899)['split']('@')[0x0];}async function isUserAdminInGroup(_0xe24965,_0x161feb){const _0x38fb61=_0x3bc4,_0xfb610a={'XjToQ':function(_0x75e60e,_0x30ddd9){return _0x75e60e===_0x30ddd9;},'YaOEU':_0x38fb61(0x171),'KRVkE':_0x38fb61(0x14c),'vYZbZ':'superadmin','yUzYj':_0x38fb61(0x161)};try{if(!bot||!bot['sock'])return![];const _0x38ea27=bot[_0x38fb61(0x148)]&&typeof bot[_0x38fb61(0x148)]['groupMetadata']===_0x38fb61(0x171)&&(_0x405635=>bot['sock'][_0x38fb61(0x14b)](_0x405635))||typeof bot['groupMetadata']===_0xfb610a[_0x38fb61(0x143)]&&(_0x10da92=>bot['groupMetadata'](_0x10da92))||typeof bot['getGroupMetadata']===_0xfb610a['YaOEU']&&(_0x1b36aa=>bot[_0x38fb61(0x156)](_0x1b36aa))||null;if(!_0x38ea27)return![];const _0x16a56b=await _0x38ea27(_0x161feb);if(!_0x16a56b||!Array['isArray'](_0x16a56b['participants']))return![];const _0x328d26=normalizeUserKeyFromJid(_0xe24965),_0x3e3cf2=_0x16a56b[_0x38fb61(0x146)]['find'](_0x3f7e7c=>{const _0x54501f=_0x38fb61,_0x4caf88=(_0x3f7e7c?.['id']||_0x3f7e7c?.[_0x54501f(0x13c)]||_0x3f7e7c?.['participant']||'')[_0x54501f(0x14e)]();return _0xfb610a['XjToQ'](_0x4caf88['split']('@')[0x0],_0x328d26);});if(!_0x3e3cf2)return![];if(_0x3e3cf2['isAdmin']||_0x3e3cf2[_0x38fb61(0x163)]||_0x3e3cf2['isSuperAdmin']||_0x3e3cf2['admin']||_0x3e3cf2['superAdmin']||_0x3e3cf2['isCreator'])return!![];if(_0x3e3cf2['role']&&[_0xfb610a['KRVkE'],_0xfb610a['vYZbZ'],_0xfb610a['yUzYj']]['includes'](_0x3e3cf2['role']))return!![];return![];}catch(_0x5590f4){return warn('[connection]\x20isUserAdminInGroup\x20error:\x20'+(_0x5590f4?.['message']||_0x5590f4)),![];}}async function safeAddConnection(_0x2c01a5,_0x3b9dfa,_0x4c267f){const _0x4b5d24=_0x3bc4,_0x4d7d36={'ZPrPf':'function'};try{if(typeof _0x280a11['addConnection']===_0x4d7d36[_0x4b5d24(0x151)])return await _0x280a11['addConnection'](_0x2c01a5,_0x3b9dfa,_0x4c267f);}catch(_0x427b59){warn('[connection]\x20utils.addConnection\x20failed:\x20'+(_0x427b59?.['message']||_0x427b59));}try{return await db['run']('INSERT\x20INTO\x20connections\x20(name,\x20chat_id,\x20creator_id)\x0a\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(name)\x20DO\x20UPDATE\x20SET\x20chat_id\x20=\x20excluded.chat_id,\x20creator_id\x20=\x20excluded.creator_id;',[_0x2c01a5,_0x3b9dfa,_0x4c267f||'']),!![];}catch(_0x42343f){return error(_0x42343f,_0x4b5d24(0x164)+_0x2c01a5),![];}}async function safeDeleteConnection(_0x3f5783){const _0x5614b8=_0x3bc4,_0x3be6c9={'hwwao':function(_0x1826b2,_0x3f166b){return _0x1826b2===_0x3f166b;}};try{if(_0x3be6c9[_0x5614b8(0x15c)](typeof _0x280a11['deleteConnection'],'function'))return await _0x280a11['deleteConnection'](_0x3f5783);}catch(_0x40842c){warn('[connection]\x20utils.deleteConnection\x20failed:\x20'+(_0x40842c?.[_0x5614b8(0x134)]||_0x40842c));}try{const _0x4f3a47=await db['run']('DELETE\x20FROM\x20connections\x20WHERE\x20name\x20=\x20?',[_0x3f5783]);return!!_0x4f3a47?.['changes'];}catch(_0x239cf4){return warn(_0x239cf4,_0x5614b8(0x149)+_0x3f5783),![];}}async function safeListConnectionsForUser(_0x4ebc5b,_0x5350d6=null){const _0x4973f9=_0x3bc4,_0x358bfc={'JFbvt':function(_0x5ca443,_0x1fccf7){return _0x5ca443+_0x1fccf7;}};try{if(typeof _0x280a11['listConnectionsForUser']==='function'){const _0x5b3565=await _0x280a11['listConnectionsForUser'](_0x4ebc5b,_0x5350d6);if(Array['isArray'](_0x5b3565))return _0x5b3565[_0x4973f9(0x135)](_0x17a65=>({'name':_0x17a65[_0x4973f9(0x147)],'chat_id':_0x17a65['chat_id'],'creator_id':_0x17a65['creator_id']}));}}catch(_0x5b7f86){warn('[connection]\x20utils.listConnections\x20failed:\x20'+(_0x5b7f86?.['message']||_0x5b7f86));}try{if('WJBVR'===_0x4973f9(0x160))_0x114bf2=null;else{if(!db)return[];if(_0x5350d6){const _0x12e74a=await db['all']('SELECT\x20name,\x20chat_id,\x20creator_id\x20FROM\x20connections\x20WHERE\x20creator_id\x20=\x20?\x20AND\x20chat_id\x20=\x20?',[_0x4ebc5b,_0x5350d6]);return(_0x12e74a||[])['map'](_0x36bd18=>({'name':_0x36bd18['name'],'chat_id':_0x36bd18['chat_id'],'creator_id':_0x36bd18['creator_id']}));}else{const _0x46770b=await db[_0x4973f9(0x144)](_0x4973f9(0x158),[_0x4ebc5b]);return(_0x46770b||[])['map'](_0x326118=>({'name':_0x326118['name'],'chat_id':_0x326118[_0x4973f9(0x150)],'creator_id':_0x326118['creator_id']}));}}}catch(_0x1be0da){return warn(_0x358bfc['JFbvt']('[connection]\x20safeListConnectionsForUser\x20DB\x20error:\x20',_0x1be0da?.['message']||_0x1be0da)),[];}}async function safeSetDefault(_0xdce5b6,_0x140ea5,_0x169b0d){const _0x38701c=_0x3bc4,_0x5a02ed={'pJxJj':function(_0x54d6c9,_0x987c6){return _0x54d6c9(_0x987c6);}};try{if(typeof _0x280a11['setDefault']===_0x38701c(0x171))return await _0x280a11['setDefault'](_0xdce5b6,_0x140ea5,_0x169b0d);}catch(_0x31c435){warn('[connection]\x20utils.setDefault\x20failed:\x20'+(_0x31c435?.['message']||_0x31c435));}try{if(!db)throw new Error('no\x20db');if(!_0x169b0d)throw new Error('groupJid\x20required\x20for\x20setDefault');if(_0xdce5b6){const _0x51f141=await db['get']('SELECT\x20chat_id\x20FROM\x20connections\x20WHERE\x20name\x20=\x20?',[_0xdce5b6]);if(!_0x51f141)throw new Error('No\x20connection\x20named\x20'+_0xdce5b6);await db[_0x38701c(0x16d)]('INSERT\x20INTO\x20user_defaults\x20(user_id,\x20group_id,\x20name)\x20VALUES\x20(?,\x20?,\x20?)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ON\x20CONFLICT(user_id,\x20group_id)\x20DO\x20UPDATE\x20SET\x20name\x20=\x20excluded.name;',[_0x140ea5,_0x169b0d,_0xdce5b6]);}else'SHAKo'!=='SHAKo'?_0x5a02ed[_0x38701c(0x13a)](_0x280553,'[connection]\x20utils.getConnection\x20failed:\x20'+(_0xf2379e?.['message']||_0xc1507e)):await db['run']('DELETE\x20FROM\x20user_defaults\x20WHERE\x20user_id\x20=\x20?\x20AND\x20group_id\x20=\x20?',[_0x140ea5,_0x169b0d]);return!![];}catch(_0x5debd9){return _0x5a02ed['pJxJj'](warn,'[connection]\x20safeSetDefault\x20DB\x20error:\x20'+(_0x5debd9?.['message']||_0x5debd9)),![];}}async function safeGetDefault(_0x2e7dd2,_0xd72ad3=null){const _0x48bd7c=_0x3bc4,_0x124845={'vkkod':function(_0x493f2d,_0x3f2fc3){return _0x493f2d+_0x3f2fc3;},'eEkud':'function','sHGQY':'vkyWF','YVnYP':function(_0x4db6ec,_0x35d3d5){return _0x4db6ec(_0x35d3d5);}};try{if(typeof _0x280a11['getDefault']===_0x124845['eEkud']){if(_0x124845['sHGQY']!=='vkyWF')_0x3ed85d(_0x124845['vkkod']('[connection]\x20utils.deleteConnection\x20failed:\x20',_0x111d55?.['message']||_0xdfbe76));else{const _0xfbc856=await _0x280a11['getDefault'](_0x2e7dd2);return _0xfbc856||null;}}}catch(_0x574784){warn('[connection]\x20utils.getDefault\x20failed:\x20'+(_0x574784?.['message']||_0x574784));}try{if(!db)return null;if(!_0xd72ad3)return null;const _0x8c9ea1=await db['get']('SELECT\x20name\x20FROM\x20user_defaults\x20WHERE\x20user_id\x20=\x20?\x20AND\x20group_id\x20=\x20?',[_0x2e7dd2,_0xd72ad3]);return _0x8c9ea1?_0x8c9ea1['name']:null;}catch(_0x299c4a){return _0x124845['YVnYP'](warn,_0x48bd7c(0x138)+(_0x299c4a?.['message']||_0x299c4a)),null;}}async function safeGetConnection(_0x53ea50){const _0x3a095e=_0x3bc4,_0x5c2962={'lBHIi':function(_0x1fc470,_0x2563e8){return _0x1fc470(_0x2563e8);}};try{if('OItRQ'==='OItRQ'){if(typeof _0x280a11['getConnection']==='function'){if('zwizD'===_0x3a095e(0x154)){const _0x5cf96d=_0x335253['get'](_0x4d8ec8);try{_0x5c2962[_0x3a095e(0x15d)](_0x367c21,_0x5cf96d);}catch(_0x56e347){}}else{const _0x3a7790=await _0x280a11[_0x3a095e(0x16a)](_0x53ea50);return _0x3a7790||null;}}}else{_0x3a8418=null;return;}}catch(_0x2609f7){warn('[connection]\x20utils.getConnection\x20failed:\x20'+(_0x2609f7?.['message']||_0x2609f7));}try{if(!db)return null;const _0x5d9258=await db[_0x3a095e(0x16b)]('SELECT\x20chat_id\x20FROM\x20connections\x20WHERE\x20name\x20=\x20?',[_0x53ea50]);return _0x5d9258?_0x5d9258[_0x3a095e(0x150)]:null;}catch(_0x3d7f3a){return warn(_0x3a095e(0x16f)+(_0x3d7f3a?.[_0x3a095e(0x134)]||_0x3d7f3a)),null;}}function setupSendApiForBot(_0x456dd1){const _0x5238c4=_0x3bc4;bot=_0x456dd1;if(!bot){sendApi=null;return;}if(typeof bot['sendMessage']==='function')sendApi=async(_0x32f016,_0x5d7252)=>bot['sendMessage'](_0x32f016,_0x5d7252);else bot['sock']&&typeof bot[_0x5238c4(0x148)]['sendMessage']==='function'?sendApi=async(_0x4252c5,_0xc45134)=>bot[_0x5238c4(0x148)]['sendMessage'](_0x4252c5,_0xc45134):sendApi=null;}async function sendTextTo(_0x1f1d56,_0x5d2f0d){const _0xeb5f2e=_0x3bc4,_0x4d56eb={'jLZBO':'[connection]\x20sendTextTo\x20error:\x20'};try{if(!_0x1f1d56)return warn('[connection]\x20sendTextTo\x20missing\x20jid'),null;if(!sendApi)return warn(_0xeb5f2e(0x165)),null;const _0x5d5335={'text':String(_0x5d2f0d)};return await sendApi(_0x1f1d56,_0x5d5335);}catch(_0xb10854){return warn(_0x4d56eb['jLZBO']+(_0xb10854?.['message']||_0xb10854)),null;}}export async function initialize(_0x2d9c3e){const _0x3d255a={'RHorQ':function(_0x3fc39d,_0x898f50){return _0x3fc39d(_0x898f50);},'avPFg':function(_0x9448b7,_0xed4041){return _0x9448b7(_0xed4041);}};_0x3d255a['RHorQ'](setupSendApiForBot,_0x2d9c3e);try{await ensureConnectionsSchema(),_0x3d255a['avPFg'](info,'[connection]\x20initialized\x20and\x20schema\x20ensured');}catch(_0x59a3e6){error(_0x59a3e6,'[connection]\x20initialize\x20error');}}export async function onMessage(_0x456694){const _0xe3ef9e=_0x3bc4,_0x4be4dc={'qYZUE':function(_0x272984,_0x229d4a){return _0x272984===_0x229d4a;},'BArNg':function(_0x13cd3d,_0xd808ee,_0x4a6500){return _0x13cd3d(_0xd808ee,_0x4a6500);},'TQdqy':function(_0x3cc1e0,_0x25c175){return _0x3cc1e0(_0x25c175);},'lDuts':function(_0xe9119c,_0x1ab578,_0x2b3df1){return _0xe9119c(_0x1ab578,_0x2b3df1);},'gmSRH':function(_0x5a9f15,_0x46195d,_0x50857e){return _0x5a9f15(_0x46195d,_0x50857e);}};try{if(!_0x456694||!_0x456694['key']||!_0x456694['message'])return;const _0x13b05b=_0x456694['key'][_0xe3ef9e(0x16c)]||_0x456694['remoteJid']||null;if(!_0x13b05b)return;const _0x10b063=String(_0x13b05b)['endsWith']('@g.us'),_0x1bdf37=makeDedupeKey(_0x456694);if(isProcessed(_0x1bdf37))return;markProcessed(_0x1bdf37);if(!_0x456694['isCommand'])return;if(!_0x10b063)return;let _0x3b82a6=![];try{_0x3b82a6=await isadmin(bot,_0x456694);}catch(_0x5a159b){warn('[connection]\x20isadmin\x20check\x20failed'),_0x3b82a6=![];}if(!_0x3b82a6)return;const _0x2d8d2c=typeof _0x456694['text']===_0xe3ef9e(0x15f)&&_0x456694['text']['trim']()['length']?_0x456694['text']['trim']():'';if(!_0x2d8d2c)return;const _0x215fb2=_0x2d8d2c['split'](/\s+/),_0x22f792=(_0x215fb2[0x0]||'')['toLowerCase']();if(!commands['includes'](_0x22f792))return;const _0x481995=_0x456694['key']['participant']||_0x456694['key'][_0xe3ef9e(0x15b)]||_0x456694['key'][_0xe3ef9e(0x16c)]||'',_0x49a531=normalizeUserKeyFromJid(_0x481995),_0x3f59dc=_0x13b05b;info('[connection]\x20command\x20\x27'+_0x22f792+_0xe3ef9e(0x13d)+_0x481995+'\x20in\x20'+_0x13b05b);try{if(_0x4be4dc['qYZUE'](typeof _0x280a11['setActiveGroupForUser'],'function'))_0x280a11['setActiveGroupForUser'](_0x49a531,_0x13b05b);}catch(_0x55ea60){warn(_0xe3ef9e(0x133)+(_0x55ea60?.[_0xe3ef9e(0x134)]||_0x55ea60));}if(_0x22f792===_0xe3ef9e(0x166)){if(_0x215fb2[_0xe3ef9e(0x141)]<0x3){await sendTextTo(_0x3f59dc,'Usage:\x20connection\x20<name>\x20<group_jid>');return;}const _0x51c358=_0x215fb2[0x1],_0x1e4027=_0x215fb2[0x2];if(!_0x1e4027||!_0x1e4027['includes']('@')){await sendTextTo(_0x3f59dc,'Group\x20JID\x20must\x20include\x20@\x20(e.g.\x201203...@g.us)');return;}const _0x51c51a=await _0x4be4dc['BArNg'](isUserAdminInGroup,_0x481995,_0x1e4027)['catch'](_0x7b9492=>{const _0x417646=_0xe3ef9e;return warn(_0x417646(0x155)+(_0x7b9492?.['message']||_0x7b9492)),![];});if(!_0x51c51a){await sendTextTo(_0x3f59dc,'❌\x20You\x20must\x20be\x20an\x20admin\x20in\x20'+_0x1e4027+'\x20to\x20add\x20that\x20connection.');return;}const _0x83fd92=await safeAddConnection(_0x51c358,_0x1e4027,_0x49a531);if(_0x83fd92)await sendTextTo(_0x3f59dc,_0xe3ef9e(0x132)+_0x51c358+'\x22\x20saved\x20->\x20'+_0x1e4027);else await sendTextTo(_0x3f59dc,'❌\x20Failed\x20to\x20save\x20connection\x20\x22'+_0x51c358+'\x22.');return;}if(_0x22f792==='delconnection'){if(_0x215fb2['length']!==0x2){await sendTextTo(_0x3f59dc,'Usage:\x20delconnection\x20<name>');return;}const _0x1211b5=_0x215fb2[0x1],_0x1ca64c=await db['get']('SELECT\x20name,\x20chat_id,\x20creator_id\x20FROM\x20connections\x20WHERE\x20name\x20=\x20?',[_0x1211b5]);if(!_0x1ca64c){await sendTextTo(_0x3f59dc,_0xe3ef9e(0x137)+_0x1211b5+'\x22\x20does\x20not\x20exist.');return;}const _0x279753=String(_0x1ca64c['creator_id']||''),_0x5bb990=_0x4be4dc[_0xe3ef9e(0x157)](String,_0x1ca64c['chat_id']||''),_0x486c85=await _0x4be4dc['BArNg'](isUserAdminInGroup,_0x481995,_0x5bb990)[_0xe3ef9e(0x13e)](_0x1e5e6e=>![]);if(_0x279753!==_0x49a531&&!_0x486c85){await sendTextTo(_0x3f59dc,'❌\x20Only\x20the\x20creator\x20(\x22'+_0x279753+'\x22)\x20or\x20an\x20admin\x20of\x20'+_0x5bb990+'\x20can\x20delete\x20connection\x20\x22'+_0x1211b5+'\x22.');return;}const _0x386278=await safeDeleteConnection(_0x1211b5);if(_0x386278)await sendTextTo(_0x3f59dc,_0xe3ef9e(0x14a)+_0x1211b5);else await _0x4be4dc['BArNg'](sendTextTo,_0x3f59dc,'❌\x20Failed\x20to\x20delete:\x20'+_0x1211b5);return;}if(_0x22f792==='listconnection'){const _0x50afac=await safeListConnectionsForUser(_0x49a531,_0x13b05b);if(!_0x50afac||_0x50afac['length']===0x0){await sendTextTo(_0x3f59dc,'You\x20have\x20no\x20saved\x20connections\x20for\x20this\x20group.');return;}const _0xdd4150=new Set(),_0x3a8bff=[];for(const _0x5734fe of _0x50afac){if(!_0x5734fe||!_0x5734fe['name'])continue;if(_0xdd4150['has'](_0x5734fe['name']))continue;_0xdd4150[_0xe3ef9e(0x174)](_0x5734fe['name']),_0x3a8bff['push']('•\x20'+_0x5734fe[_0xe3ef9e(0x147)]+'\x20→\x20'+_0x5734fe['chat_id']);}await _0x4be4dc['lDuts'](sendTextTo,_0x3f59dc,'Your\x20connections\x20for\x20this\x20group:\x0a'+_0x3a8bff['join']('\x0a'));return;}if(_0x22f792==='setdefault'){if(_0x215fb2['length']===0x1){const _0xc6323b=await safeListConnectionsForUser(_0x49a531,_0x13b05b);if(!_0xc6323b['length']){await sendTextTo(_0x3f59dc,'You\x20have\x20no\x20connections\x20in\x20this\x20group\x20to\x20set\x20as\x20default.\x20Use\x20connection\x20to\x20add\x20one.');return;}const _0x284a7b=_0xc6323b['map'](_0x13e61f=>'•\x20'+_0x13e61f['name'])[_0xe3ef9e(0x173)]('\x0a');await sendTextTo(_0x3f59dc,'Connections\x20in\x20this\x20group:\x0a'+_0x284a7b+_0xe3ef9e(0x167));return;}const _0x1da50b=_0x215fb2[0x1],_0x369eb3=await safeGetConnection(_0x1da50b);if(!_0x369eb3){await sendTextTo(_0x3f59dc,'❌\x20No\x20connection\x20named\x20\x22'+_0x1da50b+'\x22.');return;}const _0x4e63f6=await safeSetDefault(_0x1da50b,_0x49a531,_0x13b05b);if(_0x4e63f6)await sendTextTo(_0x3f59dc,'✅\x20Default\x20connection\x20for\x20this\x20group\x20set\x20to:\x20'+_0x1da50b);else await sendTextTo(_0x3f59dc,'❌\x20Failed\x20to\x20set\x20default:\x20'+_0x1da50b);return;}if(_0x22f792===_0xe3ef9e(0x15e)){const _0x15db24=await safeGetDefault(_0x49a531,_0x13b05b);if(!_0x15db24){await _0x4be4dc['lDuts'](sendTextTo,_0x3f59dc,_0xe3ef9e(0x168));return;}const _0x561379=await safeGetConnection(_0x15db24);await _0x4be4dc['gmSRH'](sendTextTo,_0x3f59dc,'Your\x20default\x20for\x20this\x20group\x20is:\x20'+_0x15db24+'\x20→\x20'+_0x561379);return;}}catch(_0xa687e){error(_0xa687e,'[connection]\x20onMessage\x20failed:\x20'+(_0xa687e?.['message']||_0xa687e));}}export async function cleanup(){for(const _0x35682c of processedMessageKeys['values']())try{clearTimeout(_0x35682c);}catch(_0xd9804a){}processedMessageKeys['clear'](),bot=null,sendApi=null,info('[connection]\x20cleaned\x20up');}export default{'name':name,'version':version,'priority':priority,'configKeys':configKeys,'commands':commands,'initialize':initialize,'onMessage':onMessage,'cleanup':cleanup};function _0x3bc4(_0x32f814,_0x452f5e){const _0x5b0e0c=_0x552c();return _0x3bc4=function(_0x485fbe,_0xc644fe){_0x485fbe=_0x485fbe-0x132;let _0x29054d=_0x5b0e0c[_0x485fbe];if(_0x3bc4['PrJgei']===undefined){var _0x1c1d4d=function(_0x278522){const _0x210b30='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1441a9='',_0x228978='';for(let _0x38bfab=0x0,_0x53d310,_0x41a7cd,_0x108524=0x0;_0x41a7cd=_0x278522['charAt'](_0x108524++);~_0x41a7cd&&(_0x53d310=_0x38bfab%0x4?_0x53d310*0x40+_0x41a7cd:_0x41a7cd,_0x38bfab++%0x4)?_0x1441a9+=String['fromCharCode'](0xff&_0x53d310>>(-0x2*_0x38bfab&0x6)):0x0){_0x41a7cd=_0x210b30['indexOf'](_0x41a7cd);}for(let _0x1aae84=0x0,_0xaf79dd=_0x1441a9['length'];_0x1aae84<_0xaf79dd;_0x1aae84++){_0x228978+='%'+('00'+_0x1441a9['charCodeAt'](_0x1aae84)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x228978);};_0x3bc4['oDXAmV']=_0x1c1d4d,_0x32f814=arguments,_0x3bc4['PrJgei']=!![];}const _0x552cc9=_0x5b0e0c[0x0],_0x3bc426=_0x485fbe+_0x552cc9,_0x51104b=_0x32f814[_0x3bc426];return!_0x51104b?(_0x29054d=_0x3bc4['oDXAmV'](_0x29054d),_0x32f814[_0x3bc426]=_0x29054d):_0x29054d=_0x51104b,_0x29054d;},_0x3bc4(_0x32f814,_0x452f5e);}function _0x485fbe(_0x26279a){const _0x41c6f1=_0x3bc4,_0x3cf924={'tnQjA':'string','MPROp':'while\x20(true)\x20{}','AcUtX':'gger'};function _0x55b0d9(_0x3c589c){if(typeof _0x3c589c===_0x3cf924['tnQjA'])return function(_0x444fa7){}['constructor'](_0x3cf924['MPROp'])['apply']('counter');else(''+_0x3c589c/_0x3c589c)['length']!==0x1||_0x3c589c%0x14===0x0?function(){return!![];}['constructor']('debu'+_0x3cf924['AcUtX'])['call']('action'):function(){return![];}['constructor']('debu'+'gger')['apply']('stateObject');_0x55b0d9(++_0x3c589c);}try{if(_0x26279a){if('jGDIo'!=='jGDIo')(function(){return![];}[_0x41c6f1(0x162)]('debu'+'gger')['apply']('stateObject'));else return _0x55b0d9;}else _0x55b0d9(0x0);}catch(_0x439908){}}